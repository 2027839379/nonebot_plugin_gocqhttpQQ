"use strict";(globalThis["webpackChunkfrontend"]=globalThis["webpackChunkfrontend"]||[]).push([[116],{31456:(e,i,t)=>{t.d(i,{CH:()=>l,CR:()=>d,D4:()=>a,u7:()=>s,xh:()=>o,yu:()=>r});class n{constructor(e,i){this._restrictedRenderingContextBrand=void 0,this._viewLayout=e,this.viewportData=i,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const t=this._viewLayout.getCurrentViewport();this.scrollTop=t.top,this.scrollLeft=t.left,this.viewportWidth=t.width,this.viewportHeight=t.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,i){return this._viewLayout.getVerticalOffsetForLineNumber(e,i)}getVerticalOffsetAfterLineNumber(e,i){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,i)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class o extends n{constructor(e,i,t){super(e,i),this._renderingContextBrand=void 0,this._viewLines=t}linesVisibleRangesForRange(e,i){return this._viewLines.linesVisibleRangesForRange(e,i)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}}class s{constructor(e,i,t,n){this.outsideRenderedLine=e,this.lineNumber=i,this.ranges=t,this.continuesOnNextLine=n}}class r{static from(e){const i=new Array(e.length);for(let t=0,n=e.length;t<n;t++){const n=e[t];i[t]=new r(n.left,n.width)}return i}constructor(e,i){this._horizontalRangeBrand=void 0,this.left=Math.round(e),this.width=Math.round(i)}toString(){return`[${this.left},${this.width}]`}}class d{constructor(e,i){this._floatHorizontalRangeBrand=void 0,this.left=e,this.width=i}toString(){return`[${this.left},${this.width}]`}static compare(e,i){return e.left-i.left}}class a{constructor(e,i){this.outsideRenderedLine=e,this.originalLeft=i,this.left=Math.round(this.originalLeft)}}class l{constructor(e,i){this.outsideRenderedLine=e,this.ranges=i}}},33716:(e,i,t)=>{t.d(i,{N:()=>r});var n=t(41560),o=t(8655),s=t(26145);class r{constructor(e,i,t,n){this.configuration=e,this.viewModel=i,this.userInputEvents=t,this.commandDelegate=n}paste(e,i,t,n){this.commandDelegate.paste(e,i,t,n)}type(e){this.commandDelegate.type(e)}compositionType(e,i,t,n){this.commandDelegate.compositionType(e,i,t,n)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){n.Ox.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){const i=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<i?new o.L(e.lineNumber,i):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(76)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(76)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){const i=this.configuration.options,t=s.IJ&&i.get(105),n=i.get(21);e.middleButton&&!t?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():3===e.mouseDownCount?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):2===e.mouseDownCount?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey||n?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,i){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:i}}moveTo(e,i){n.Ox.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_moveToSelect(e,i){n.Ox.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_columnSelect(e,i,t){e=this._validateViewColumn(e),n.Ox.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:i,doColumnSelect:t})}_createCursor(e,i){e=this._validateViewColumn(e),n.Ox.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:i})}_lastCursorMoveToSelect(e,i){n.Ox.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_wordSelect(e,i){n.Ox.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_wordSelectDrag(e,i){n.Ox.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_lastCursorWordSelect(e,i){n.Ox.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_lineSelect(e,i){n.Ox.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_lineSelectDrag(e,i){n.Ox.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_lastCursorLineSelect(e,i){n.Ox.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_lastCursorLineSelectDrag(e,i){n.Ox.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,i))}_selectAll(){n.Ox.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}}},87553:(e,i,t)=>{t.d(i,{F:()=>d,G:()=>a});var n=t(25503),o=t(36323),s=t(746),r=t(44651);class d{constructor(e){this._createLine=e,this._set(1,[])}flush(){this._set(1,[])}_set(e,i){this._lines=i,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){const i=e-this._rendLineNumberStart;if(i<0||i>=this._lines.length)throw new s.he("Illegal value for lineNumber");return this._lines[i]}onLinesDeleted(e,i){if(0===this.getCount())return null;const t=this.getStartLineNumber(),n=this.getEndLineNumber();if(i<t){const t=i-e+1;return this._rendLineNumberStart-=t,null}if(e>n)return null;let o=0,s=0;for(let d=t;d<=n;d++){const t=d-this._rendLineNumberStart;e<=d&&d<=i&&(0===s?(o=t,s=1):s++)}if(e<t){let n=0;n=i<t?i-e+1:t-e,this._rendLineNumberStart-=n}const r=this._lines.splice(o,s);return r}onLinesChanged(e,i){const t=e+i-1;if(0===this.getCount())return!1;const n=this.getStartLineNumber(),o=this.getEndLineNumber();let s=!1;for(let r=e;r<=t;r++)r>=n&&r<=o&&(this._lines[r-this._rendLineNumberStart].onContentChanged(),s=!0);return s}onLinesInserted(e,i){if(0===this.getCount())return null;const t=i-e+1,n=this.getStartLineNumber(),o=this.getEndLineNumber();if(e<=n)return this._rendLineNumberStart+=t,null;if(e>o)return null;if(t+e>o){const i=this._lines.splice(e-this._rendLineNumberStart,o-e+1);return i}const s=[];for(let h=0;h<t;h++)s[h]=this._createLine();const r=e-this._rendLineNumberStart,d=this._lines.slice(0,r),a=this._lines.slice(r,this._lines.length-t),l=this._lines.slice(this._lines.length-t,this._lines.length);return this._lines=d.concat(s).concat(a),l}onTokensChanged(e){if(0===this.getCount())return!1;const i=this.getStartLineNumber(),t=this.getEndLineNumber();let n=!1;for(let o=0,s=e.length;o<s;o++){const s=e[o];if(s.toLineNumber<i||s.fromLineNumber>t)continue;const r=Math.max(i,s.fromLineNumber),d=Math.min(t,s.toLineNumber);for(let e=r;e<=d;e++){const i=e-this._rendLineNumberStart;this._lines[i].onTokensChanged(),n=!0}}return n}}class a{constructor(e){this._host=e,this.domNode=this._createDomNode(),this._linesCollection=new d((()=>this._host.createVisibleLine()))}_createDomNode(){const e=(0,n.X)(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(142)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){const i=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(i)for(let t=0,n=i.length;t<n;t++){const e=i[t].getDomNode();e&&this.domNode.domNode.removeChild(e)}return!0}onLinesInserted(e){const i=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(i)for(let t=0,n=i.length;t<n;t++){const e=i[t].getDomNode();e&&this.domNode.domNode.removeChild(e)}return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){const i=this._linesCollection._get(),t=new l(this.domNode.domNode,this._host,e),n={rendLineNumberStart:i.rendLineNumberStart,lines:i.lines,linesLength:i.lines.length},o=t.render(n,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(o.rendLineNumberStart,o.lines)}}class l{constructor(e,i,t){this.domNode=e,this.host=i,this.viewportData=t}render(e,i,t,n){const o={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(o.rendLineNumberStart+o.linesLength-1<i||t<o.rendLineNumberStart){o.rendLineNumberStart=i,o.linesLength=t-i+1,o.lines=[];for(let e=i;e<=t;e++)o.lines[e-i]=this.host.createVisibleLine();return this._finishRendering(o,!0,n),o}if(this._renderUntouchedLines(o,Math.max(i-o.rendLineNumberStart,0),Math.min(t-o.rendLineNumberStart,o.linesLength-1),n,i),o.rendLineNumberStart>i){const e=i,s=Math.min(t,o.rendLineNumberStart-1);e<=s&&(this._insertLinesBefore(o,e,s,n,i),o.linesLength+=s-e+1)}else if(o.rendLineNumberStart<i){const e=Math.min(o.linesLength,i-o.rendLineNumberStart);e>0&&(this._removeLinesBefore(o,e),o.linesLength-=e)}if(o.rendLineNumberStart=i,o.rendLineNumberStart+o.linesLength-1<t){const e=o.rendLineNumberStart+o.linesLength,s=t;e<=s&&(this._insertLinesAfter(o,e,s,n,i),o.linesLength+=s-e+1)}else if(o.rendLineNumberStart+o.linesLength-1>t){const e=Math.max(0,t-o.rendLineNumberStart+1),i=o.linesLength-1,n=i-e+1;n>0&&(this._removeLinesAfter(o,n),o.linesLength-=n)}return this._finishRendering(o,!1,n),o}_renderUntouchedLines(e,i,t,n,o){const s=e.rendLineNumberStart,r=e.lines;for(let d=i;d<=t;d++){const e=s+d;r[d].layoutLine(e,n[e-o])}}_insertLinesBefore(e,i,t,n,o){const s=[];let r=0;for(let d=i;d<=t;d++)s[r++]=this.host.createVisibleLine();e.lines=s.concat(e.lines)}_removeLinesBefore(e,i){for(let t=0;t<i;t++){const i=e.lines[t].getDomNode();i&&this.domNode.removeChild(i)}e.lines.splice(0,i)}_insertLinesAfter(e,i,t,n,o){const s=[];let r=0;for(let d=i;d<=t;d++)s[r++]=this.host.createVisibleLine();e.lines=e.lines.concat(s)}_removeLinesAfter(e,i){const t=e.linesLength-i;for(let n=0;n<i;n++){const i=e.lines[t+n].getDomNode();i&&this.domNode.removeChild(i)}e.lines.splice(t,i)}_finishRenderingNewLines(e,i,t,n){l._ttPolicy&&(t=l._ttPolicy.createHTML(t));const o=this.domNode.lastChild;i||!o?this.domNode.innerHTML=t:o.insertAdjacentHTML("afterend",t);let s=this.domNode.lastChild;for(let r=e.linesLength-1;r>=0;r--){const i=e.lines[r];n[r]&&(i.setDomNode(s),s=s.previousSibling)}}_finishRenderingInvalidLines(e,i,t){const n=document.createElement("div");l._ttPolicy&&(i=l._ttPolicy.createHTML(i)),n.innerHTML=i;for(let o=0;o<e.linesLength;o++){const i=e.lines[o];if(t[o]){const e=n.firstChild,t=i.getDomNode();t.parentNode.replaceChild(e,t),i.setDomNode(e)}}}_finishRendering(e,i,t){const n=l._sb,o=e.linesLength,s=e.lines,r=e.rendLineNumberStart,d=[];{n.reset();let a=!1;for(let e=0;e<o;e++){const i=s[e];d[e]=!1;const o=i.getDomNode();if(o)continue;const l=i.renderLine(e+r,t[e],this.viewportData,n);l&&(d[e]=!0,a=!0)}a&&this._finishRenderingNewLines(e,i,n.build(),d)}{n.reset();let i=!1;const a=[];for(let e=0;e<o;e++){const o=s[e];if(a[e]=!1,d[e])continue;const l=o.renderLine(e+r,t[e],this.viewportData,n);l&&(a[e]=!0,i=!0)}i&&this._finishRenderingInvalidLines(e,n.build(),a)}}}l._ttPolicy=(0,o.Z)("editorViewLayer",{createHTML:e=>e}),l._sb=new r.HT(1e5)},24277:(e,i,t)=>{t.d(i,{Ib:()=>h,Ip:()=>l});var n=t(25503),o=t(36330),s=t(87553),r=t(68628);class d extends r.E{constructor(e){super(e),this._visibleLines=new s.G(this),this.domNode=this._visibleLines.domNode;const i=this._context.configuration.options,t=i.get(49);(0,o.N)(this.domNode,t),this._dynamicOverlays=[],this._isFocused=!1,this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,i=this._dynamicOverlays.length;e<i;e++){const i=this._dynamicOverlays[e];if(i.shouldRender())return!0}return!1}dispose(){super.dispose();for(let e=0,i=this._dynamicOverlays.length;e<i;e++){const i=this._dynamicOverlays[e];i.dispose()}this._dynamicOverlays=[]}getDomNode(){return this.domNode}createVisibleLine(){return new a(this._context.configuration,this._dynamicOverlays)}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);const i=this._visibleLines.getStartLineNumber(),t=this._visibleLines.getEndLineNumber();for(let o=i;o<=t;o++){const i=this._visibleLines.getVisibleLine(o);i.onConfigurationChanged(e)}const n=this._context.configuration.options,s=n.get(49);return(0,o.N)(this.domNode,s),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){const i=this._dynamicOverlays.filter((e=>e.shouldRender()));for(let t=0,n=i.length;t<n;t++){const n=i[t];n.prepareRender(e),n.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}}class a{constructor(e,i){this._configuration=e,this._lineHeight=this._configuration.options.get(65),this._dynamicOverlays=i,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=(0,n.X)(e)}onContentChanged(){}onTokensChanged(){}onConfigurationChanged(e){this._lineHeight=this._configuration.options.get(65)}renderLine(e,i,t,n){let o="";for(let s=0,r=this._dynamicOverlays.length;s<r;s++){const i=this._dynamicOverlays[s];o+=i.render(t.startLineNumber,e)}return this._renderedContent!==o&&(this._renderedContent=o,n.appendString('<div style="position:absolute;top:'),n.appendString(String(i)),n.appendString("px;width:100%;height:"),n.appendString(String(this._lineHeight)),n.appendString('px;">'),n.appendString(o),n.appendString("</div>"),!0)}layoutLine(e,i){this._domNode&&(this._domNode.setTop(i),this._domNode.setHeight(this._lineHeight))}}class l extends d{constructor(e){super(e);const i=this._context.configuration.options,t=i.get(142);this._contentWidth=t.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){const i=this._context.configuration.options,t=i.get(142);return this._contentWidth=t.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}}class h extends d{constructor(e){super(e);const i=this._context.configuration.options,t=i.get(142);this._contentLeft=t.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),(0,o.N)(this.domNode,i.get(49))}onConfigurationChanged(e){const i=this._context.configuration.options;(0,o.N)(this.domNode,i.get(49));const t=i.get(142);return this._contentLeft=t.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);const i=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(i),this.domNode.setWidth(this._contentLeft)}}},68628:(e,i,t)=>{t.d(i,{E:()=>o,K:()=>s});var n=t(51359);class o extends n.O{constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class s{static write(e,i){e.setAttribute("data-mprt",String(i))}static read(e){const i=e.getAttribute("data-mprt");return null===i?0:parseInt(i,10)}static collect(e,i){const t=[];let n=0;while(e&&e!==document.body){if(e===i)break;e.nodeType===e.ELEMENT_NODE&&(t[n++]=this.read(e)),e=e.parentElement}const o=new Uint8Array(n);for(let s=0;s<n;s++)o[s]=t[n-s-1];return o}}},25556:(e,i,t)=>{t.d(i,{q:()=>o});var n=t(8655);class o{constructor(e){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=e}emitKeyDown(e){var i;null===(i=this.onKeyDown)||void 0===i||i.call(this,e)}emitKeyUp(e){var i;null===(i=this.onKeyUp)||void 0===i||i.call(this,e)}emitContextMenu(e){var i;null===(i=this.onContextMenu)||void 0===i||i.call(this,this._convertViewToModelMouseEvent(e))}emitMouseMove(e){var i;null===(i=this.onMouseMove)||void 0===i||i.call(this,this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){var i;null===(i=this.onMouseLeave)||void 0===i||i.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDown(e){var i;null===(i=this.onMouseDown)||void 0===i||i.call(this,this._convertViewToModelMouseEvent(e))}emitMouseUp(e){var i;null===(i=this.onMouseUp)||void 0===i||i.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){var i;null===(i=this.onMouseDrag)||void 0===i||i.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){var i;null===(i=this.onMouseDrop)||void 0===i||i.call(this,this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){var e;null===(e=this.onMouseDropCanceled)||void 0===e||e.call(this)}emitMouseWheel(e){var i;null===(i=this.onMouseWheel)||void 0===i||i.call(this,e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return o.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,i){const t=Object.assign({},e);return t.position&&(t.position=i.convertViewPositionToModelPosition(t.position)),t.range&&(t.range=i.convertViewRangeToModelRange(t.range)),5!==t.type&&8!==t.type||(t.detail=this.convertViewToModelViewZoneData(t.detail,i)),t}static convertViewToModelViewZoneData(e,i){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?i.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?i.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:i.convertViewPositionToModelPosition(e.position),afterLineNumber:i.convertViewPositionToModelPosition(new n.L(e.afterLineNumber,1)).lineNumber}}}},58548:(e,i,t)=>{t.d(i,{Gm:()=>ee});t(29134);var n=t(76601),o=t(76526),s=t(746),r=t(21813),d=t(52644),a=t(80906),l=t(21301),h=t(67641),c=t(22035),g=t(3e4),u=t(25556),m=t(29065),f=t(10824),_=t(8655),p=t(81524),v=t(49948),b=t(40129),w=t(90290),C=t(90694),D=t(71593),L=t(16021),E=t(40118),S=t(62172),N=t(37943),y=t(25065),R=t(61156),M=t(82915),I=t(96592),T=t(74821),x=t(9547),O=t(39812),V=t(82593),P=t(58652),W=t(55017),A=t(28010),F=t(36330),H=t(47892),k=t(57171),z=t(46106);const B={value:(0,n.NC)("accessibleDiffViewer","Accessible Diff Viewer"),original:"Accessible Diff Viewer"};class U extends z.Ke{constructor(){super({id:U.id,title:{value:(0,n.NC)("editor.action.accessibleDiffViewer.next","Go to Next Difference"),original:"Go to Next Difference"},category:B,precondition:y.Ao.has("isInDiffEditor"),keybinding:{primary:65,weight:100},f1:!0})}run(e){const i=K(e);null===i||void 0===i||i.accessibleDiffViewerNext()}}U.id="editor.action.accessibleDiffViewer.next",z.BH.appendMenuItem(z.eH.EditorTitle,{command:{id:U.id,title:(0,n.NC)("Open Accessible Diff Viewer","Open Accessible Diff Viewer")},order:10,group:"2_diff",when:y.Ao.and(C.u.accessibleDiffViewerVisible.negate(),y.Ao.has("isInDiffEditor"))});class Z extends z.Ke{constructor(){super({id:Z.id,title:{value:(0,n.NC)("editor.action.accessibleDiffViewer.prev","Go to Previous Difference"),original:"Go to Previous Difference"},category:B,precondition:y.Ao.has("isInDiffEditor"),keybinding:{primary:1089,weight:100},f1:!0})}run(e){const i=K(e);null===i||void 0===i||i.accessibleDiffViewerPrev()}}function K(e){var i;const t=e.get(c.$),n=t.listDiffEditors(),o=null!==(i=t.getFocusedCodeEditor())&&void 0!==i?i:t.getActiveCodeEditor();if(!o)return null;for(let s=0,r=n.length;s<r;s++){const e=n[s];if(e.getModifiedEditor().getId()===o.getId()||e.getOriginalEditor().getId()===o.getId())return e}if(document.activeElement)for(const s of n){const e=s.getContainerDomNode();if(j(e,document.activeElement))return s}return null}function j(e,i){let t=i;while(t){if(t===e)return!0;t=t.parentElement}return!1}Z.id="editor.action.accessibleDiffViewer.prev",N.P.registerCommandAlias("editor.action.diffReview.next",U.id),(0,z.r1)(U),N.P.registerCommandAlias("editor.action.diffReview.prev",Z.id),(0,z.r1)(Z);class q extends d.JT{constructor(){super(),this._editor=null,this._instantiationService=null,this._instances=this._register(new d.b2),this._pending=new Map,this._finishedInstantiation=[],this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,i,t){this._editor=e,this._instantiationService=t;for(const n of i)this._pending.has(n.id)?(0,s.dL)(new Error(`Cannot have two contributions with the same id ${n.id}`)):this._pending.set(n.id,n);this._instantiateSome(0),this._register((0,k.To)((()=>{this._instantiateSome(1)}))),this._register((0,k.To)((()=>{this._instantiateSome(2)}))),this._register((0,k.To)((()=>{this._instantiateSome(3)}),5e3))}saveViewState(){const e={};for(const[i,t]of this._instances)"function"===typeof t.saveViewState&&(e[i]=t.saveViewState());return e}restoreViewState(e){for(const[i,t]of this._instances)"function"===typeof t.restoreViewState&&t.restoreViewState(e[i])}get(e){return this._instantiateById(e),this._instances.get(e)||null}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){this._register((0,k.To)((()=>{this._instantiateSome(1)}),50))}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;const i=this._findPendingContributionsByInstantiation(e);for(const t of i)this._instantiateById(t.id)}_findPendingContributionsByInstantiation(e){const i=[];for(const[,t]of this._pending)t.instantiation===e&&i.push(t);return i}_instantiateById(e){const i=this._pending.get(e);if(i){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{const e=this._instantiationService.createInstance(i.ctor,this._editor);this._instances.set(i.id,e),"function"===typeof e.restoreViewState&&0!==i.instantiation&&console.warn(`Editor contribution '${i.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(t){(0,s.dL)(t)}}}}var Q=t(91809),$=function(e,i,t,n){var o,s=arguments.length,r=s<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(i,t,r):o(i,t))||r);return s>3&&r&&Object.defineProperty(i,t,r),r},G=function(e,i){return function(t,n){i(t,n,e)}},J=function(e,i,t,n){function o(e){return e instanceof t?e:new t((function(i){i(e)}))}return new(t||(t=Promise))((function(t,s){function r(e){try{a(n.next(e))}catch(i){s(i)}}function d(e){try{a(n["throw"](e))}catch(i){s(i)}}function a(e){e.done?t(e.value):o(e.value).then(r,d)}a((n=n.apply(e,i||[])).next())}))};let X=0;class Y{constructor(e,i,t,n,o,s){this.model=e,this.viewModel=i,this.view=t,this.hasRealView=n,this.listenersToRemove=o,this.attachedView=s}dispose(){(0,d.B9)(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}}let ee=class e extends d.JT{get isSimpleWidget(){return this._configuration.isSimpleWidget}constructor(e,i,t,n,d,a,l,c,g,u,m,f){super(),this.languageConfigurationService=m,this._deliveryQueue=(0,r.Sp)(),this._contributions=this._register(new q),this._onDidDispose=this._register(new r.Q5),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeModelTokens=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelTokens=this._onDidChangeModelTokens.event,this._onDidChangeConfiguration=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onDidChangeModel=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new te(this._contributions,this._deliveryQueue)),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new ie({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new ie({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new te(this._contributions,this._deliveryQueue)),this.onWillType=this._onWillType.event,this._onDidType=this._register(new te(this._contributions,this._deliveryQueue)),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new te(this._contributions,this._deliveryQueue)),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new te(this._contributions,this._deliveryQueue)),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new te(this._contributions,this._deliveryQueue)),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new te(this._contributions,this._deliveryQueue)),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new te(this._contributions,this._deliveryQueue)),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new te(this._contributions,this._deliveryQueue)),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new te(this._contributions,this._deliveryQueue)),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new te(this._contributions,this._deliveryQueue)),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onDropIntoEditor=this._register(new te(this._contributions,this._deliveryQueue)),this.onDropIntoEditor=this._onDropIntoEditor.event,this._onContextMenu=this._register(new te(this._contributions,this._deliveryQueue)),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new te(this._contributions,this._deliveryQueue)),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new te(this._contributions,this._deliveryQueue)),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new te(this._contributions,this._deliveryQueue)),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new te(this._contributions,this._deliveryQueue)),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new te(this._contributions,this._deliveryQueue)),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new r.Q5({deliveryQueue:this._deliveryQueue})),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._actions=new Map,this._bannerDomNode=null,this._dropIntoEditorDecorations=this.createDecorationsCollection(),d.willCreateCodeEditor();const _=Object.assign({},i);let p;this._domElement=e,this._overflowWidgetsDomNode=_.overflowWidgetsDomNode,delete _.overflowWidgetsDomNode,this._id=++X,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=t.telemetryData,this._configuration=this._register(this._createConfiguration(t.isSimpleWidget||!1,_,u)),this._register(this._configuration.onDidChange((e=>{this._onDidChangeConfiguration.fire(e);const i=this._configuration.options;if(e.hasChanged(142)){const e=i.get(142);this._onDidLayoutChange.fire(e)}}))),this._contextKeyService=this._register(l.createScoped(this._domElement)),this._notificationService=g,this._codeEditorService=d,this._commandService=a,this._themeService=c,this._register(new ne(this,this._contextKeyService)),this._register(new oe(this,this._contextKeyService,f)),this._instantiationService=n.createChild(new M.y([y.i6,this._contextKeyService])),this._modelData=null,this._focusTracker=new se(e),this._register(this._focusTracker.onChange((()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())}))),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={},p=Array.isArray(t.contributions)?t.contributions:h.Uc.getEditorContributions(),this._contributions.initialize(this,p,this._instantiationService);for(const o of h.Uc.getEditorActions()){if(this._actions.has(o.id)){(0,s.dL)(new Error(`Cannot have two actions with the same id ${o.id}`));continue}const e=new b.p(o.id,o.label,o.alias,(0,O.f6)(o.precondition),(()=>this._instantiationService.invokeFunction((e=>Promise.resolve(o.runEditorCommand(e,this,null))))),this._contextKeyService);this._actions.set(e.id,e)}const v=()=>!this._configuration.options.get(89)&&this._configuration.options.get(35).enabled;this._register(new o.eg(this._domElement,{onDragEnter:()=>{},onDragOver:e=>{if(!v())return;const i=this.getTargetAtClientPoint(e.clientX,e.clientY);(null===i||void 0===i?void 0:i.position)&&this.showDropIndicatorAt(i.position)},onDrop:e=>J(this,void 0,void 0,(function*(){if(!v())return;if(this.removeDropIndicator(),!e.dataTransfer)return;const i=this.getTargetAtClientPoint(e.clientX,e.clientY);(null===i||void 0===i?void 0:i.position)&&this._onDropIntoEditor.fire({position:i.position,event:e})})),onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}writeScreenReaderContent(e){var i;null===(i=this._modelData)||void 0===i||i.view.writeScreenReaderContent(e)}_createConfiguration(e,i,t){return new l.z(e,i,this._domElement,t)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return w.g.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e||{})}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?W.w.getWordAtPosition(this._modelData.model,this._configuration.options.get(128),e):null}getValue(e=null){if(!this._modelData)return"";const i=!(!e||!e.preserveBOM);let t=0;return e&&e.lineEnding&&"\n"===e.lineEnding?t=1:e&&e.lineEnding&&"\r\n"===e.lineEnding&&(t=2),this._modelData.model.getValue(t,i)}setValue(e){this._modelData&&this._modelData.model.setValue(e)}getModel(){return this._modelData?this._modelData.model:null}setModel(e=null){const i=e;if(null===this._modelData&&null===i)return;if(this._modelData&&this._modelData.model===i)return;const t=this.hasTextFocus(),n=this._detachModel();this._attachModel(i),t&&this.hasModel()&&this.focus();const o={oldModelUrl:n?n.uri:null,newModelUrl:i?i.uri:null};this._removeDecorationTypes(),this._onDidChangeModel.fire(o),this._postDetachModelCleanup(n),this._contributions.onAfterModelAttached()}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(const e in this._decorationTypeSubtypes){const i=this._decorationTypeSubtypes[e];for(const t in i)this._removeDecorationType(e+"-"+t)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(e,i,t,n){const o=e.model.validatePosition({lineNumber:i,column:t}),s=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(o);return e.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(s.lineNumber,n)}getTopForLineNumber(i,t=!1){return this._modelData?e._getVerticalOffsetForPosition(this._modelData,i,1,t):-1}getTopForPosition(i,t){return this._modelData?e._getVerticalOffsetForPosition(this._modelData,i,t,!1):-1}static _getVerticalOffsetForPosition(e,i,t,n=!1){const o=e.model.validatePosition({lineNumber:i,column:t}),s=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(o);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(s.lineNumber,n)}getBottomForLineNumber(i,t=!1){return this._modelData?e._getVerticalOffsetAfterPosition(this._modelData,i,1,t):-1}setHiddenAreas(e,i){var t;null===(t=this._modelData)||void 0===t||t.viewModel.setHiddenAreas(e.map((e=>p.e.lift(e))),i)}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;const i=this._modelData.model.validatePosition(e),t=this._modelData.model.getOptions().tabSize;return f.i.visibleColumnFromColumn(this._modelData.model.getLineContent(i.lineNumber),i.column,t)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e,i="api"){if(this._modelData){if(!_.L.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(i,[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,i,t,n){if(!this._modelData)return;if(!p.e.isIRange(e))throw new Error("Invalid arguments");const o=this._modelData.model.validateRange(e),s=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(o);this._modelData.viewModel.revealRange("api",t,s,i,n)}revealLine(e,i=0){this._revealLine(e,0,i)}revealLineInCenter(e,i=0){this._revealLine(e,1,i)}revealLineInCenterIfOutsideViewport(e,i=0){this._revealLine(e,2,i)}revealLineNearTop(e,i=0){this._revealLine(e,5,i)}_revealLine(e,i,t){if("number"!==typeof e)throw new Error("Invalid arguments");this._sendRevealRange(new p.e(e,1,e,1),i,!1,t)}revealPosition(e,i=0){this._revealPosition(e,0,!0,i)}revealPositionInCenter(e,i=0){this._revealPosition(e,1,!0,i)}revealPositionInCenterIfOutsideViewport(e,i=0){this._revealPosition(e,2,!0,i)}revealPositionNearTop(e,i=0){this._revealPosition(e,5,!0,i)}_revealPosition(e,i,t,n){if(!_.L.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new p.e(e.lineNumber,e.column,e.lineNumber,e.column),i,t,n)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e,i="api"){const t=v.Y.isISelection(e),n=p.e.isIRange(e);if(!t&&!n)throw new Error("Invalid arguments");if(t)this._setSelectionImpl(e,i);else if(n){const t={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(t,i)}}_setSelectionImpl(e,i){if(!this._modelData)return;const t=new v.Y(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections(i,[t])}revealLines(e,i,t=0){this._revealLines(e,i,0,t)}revealLinesInCenter(e,i,t=0){this._revealLines(e,i,1,t)}revealLinesInCenterIfOutsideViewport(e,i,t=0){this._revealLines(e,i,2,t)}revealLinesNearTop(e,i,t=0){this._revealLines(e,i,5,t)}_revealLines(e,i,t,n){if("number"!==typeof e||"number"!==typeof i)throw new Error("Invalid arguments");this._sendRevealRange(new p.e(e,1,i,1),t,!1,n)}revealRange(e,i=0,t=!1,n=!0){this._revealRange(e,t?1:0,n,i)}revealRangeInCenter(e,i=0){this._revealRange(e,1,!0,i)}revealRangeInCenterIfOutsideViewport(e,i=0){this._revealRange(e,2,!0,i)}revealRangeNearTop(e,i=0){this._revealRange(e,5,!0,i)}revealRangeNearTopIfOutsideViewport(e,i=0){this._revealRange(e,6,!0,i)}revealRangeAtTop(e,i=0){this._revealRange(e,3,!0,i)}_revealRange(e,i,t,n){if(!p.e.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(p.e.lift(e),i,t,n)}setSelections(e,i="api",t=0){if(this._modelData){if(!e||0===e.length)throw new Error("Invalid arguments");for(let i=0,t=e.length;i<t;i++)if(!v.Y.isISelection(e[i]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(i,e,t)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e,i=1){if(this._modelData){if("number"!==typeof e)throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:e},i)}}setScrollTop(e,i=1){if(this._modelData){if("number"!==typeof e)throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:e},i)}}setScrollPosition(e,i=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(e,i)}hasPendingScrollAnimation(){return!!this._modelData&&this._modelData.viewModel.viewLayout.hasPendingScrollAnimation()}saveViewState(){if(!this._modelData)return null;const e=this._contributions.saveViewState(),i=this._modelData.viewModel.saveCursorState(),t=this._modelData.viewModel.saveState();return{cursorState:i,viewState:t,contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;const i=e;if(i&&i.cursorState&&i.viewState){const e=i.cursorState;Array.isArray(e)?e.length>0&&this._modelData.viewModel.restoreCursorState(e):this._modelData.viewModel.restoreCursorState([e]),this._contributions.restoreViewState(i.contributionsState||{});const t=this._modelData.viewModel.reduceRestoreState(i.viewState);this._modelData.view.restoreState(t)}}handleInitialized(){var e;null===(e=this._getViewModel())||void 0===e||e.visibleLinesStabilized()}getContribution(e){return this._contributions.get(e)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let e=this.getActions();return e=e.filter((e=>e.isSupported())),e}getAction(e){return this._actions.get(e)||null}trigger(e,i,t){switch(t=t||{},i){case"compositionStart":return void this._startComposition();case"compositionEnd":return void this._endComposition(e);case"type":{const i=t;return void this._type(e,i.text||"")}case"replacePreviousChar":{const i=t;return void this._compositionType(e,i.text||"",i.replaceCharCnt||0,0,0)}case"compositionType":{const i=t;return void this._compositionType(e,i.text||"",i.replacePrevCharCnt||0,i.replaceNextCharCnt||0,i.positionDelta||0)}case"paste":{const i=t;return void this._paste(e,i.text||"",i.pasteOnNewLine||!1,i.multicursorText||null,i.mode||null)}case"cut":return void this._cut(e)}const n=this.getAction(i);n?Promise.resolve(n.run(t)).then(void 0,s.dL):this._modelData&&(this._triggerEditorCommand(e,i,t)||this._triggerCommand(i,t))}_triggerCommand(e,i){this._commandService.executeCommand(e,i)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,i){this._modelData&&0!==i.length&&("keyboard"===e&&this._onWillType.fire(i),this._modelData.viewModel.type(i,e),"keyboard"===e&&this._onDidType.fire(i))}_compositionType(e,i,t,n,o){this._modelData&&this._modelData.viewModel.compositionType(i,t,n,o,e)}_paste(e,i,t,n,o){if(!this._modelData||0===i.length)return;const s=this._modelData.viewModel,r=s.getSelection().getStartPosition();s.paste(i,t,n,e);const d=s.getSelection().getStartPosition();"keyboard"===e&&this._onDidPaste.fire({range:new p.e(r.lineNumber,r.column,d.lineNumber,d.column),languageId:o})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,i,t){const n=h.Uc.getEditorCommand(i);return!!n&&(t=t||{},t.source=e,this._instantiationService.invokeFunction((e=>{Promise.resolve(n.runEditorCommand(e,this,t)).then(void 0,s.dL)})),!0)}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!!this._modelData&&(!this._configuration.options.get(89)&&(this._modelData.model.pushStackElement(),!0))}popUndoStop(){return!!this._modelData&&(!this._configuration.options.get(89)&&(this._modelData.model.popStackElement(),!0))}executeEdits(e,i,t){if(!this._modelData)return!1;if(this._configuration.options.get(89))return!1;let n;return n=t?Array.isArray(t)?()=>t:t:()=>null,this._modelData.viewModel.executeEdits(e,i,n),!0}executeCommand(e,i){this._modelData&&this._modelData.viewModel.executeCommand(i,e)}executeCommands(e,i){this._modelData&&this._modelData.viewModel.executeCommands(i,e)}createDecorationsCollection(e){return new re(this,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){return this._modelData?this._modelData.model.getLineDecorations(e,this._id,(0,m.$J)(this._configuration.options)):null}getDecorationsInRange(e){return this._modelData?this._modelData.model.getDecorationsInRange(e,this._id,(0,m.$J)(this._configuration.options)):null}deltaDecorations(e,i){return this._modelData?0===e.length&&0===i.length?e:this._modelData.model.deltaDecorations(e,i,this._id):[]}removeDecorations(e){this._modelData&&0!==e.length&&this._modelData.model.changeDecorations((i=>{i.deltaDecorations(e,[])}))}removeDecorationsByType(e){const i=this._decorationTypeKeysToIds[e];i&&this.deltaDecorations(i,[]),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){const e=this._configuration.options,i=e.get(142);return i}createOverviewRuler(e){return this._modelData&&this._modelData.hasRealView?this._modelData.view.createOverviewRuler(e):null}getContainerDomNode(){return this._domElement}getDomNode(){return this._modelData&&this._modelData.hasRealView?this._modelData.view.domNode.domNode:null}delegateVerticalScrollbarPointerDown(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.delegateScrollFromMouseWheelEvent(e)}layout(e){this._configuration.observeContainer(e),this.render()}focus(){this._modelData&&this._modelData.hasRealView&&this._modelData.view.focus()}hasTextFocus(){return!(!this._modelData||!this._modelData.hasRealView)&&this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(e){const i={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id."),this._contentWidgets[e.getId()]=i,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(i)}layoutContentWidget(e){const i=e.getId();if(this._contentWidgets.hasOwnProperty(i)){const t=this._contentWidgets[i];t.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(t)}}removeContentWidget(e){const i=e.getId();if(this._contentWidgets.hasOwnProperty(i)){const e=this._contentWidgets[i];delete this._contentWidgets[i],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(e)}}addOverlayWidget(e){const i={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[e.getId()]=i,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(i)}layoutOverlayWidget(e){const i=e.getId();if(this._overlayWidgets.hasOwnProperty(i)){const t=this._overlayWidgets[i];t.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(t)}}removeOverlayWidget(e){const i=e.getId();if(this._overlayWidgets.hasOwnProperty(i)){const e=this._overlayWidgets[i];delete this._overlayWidgets[i],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(e)}}addGlyphMarginWidget(e){const i={widget:e,position:e.getPosition()};this._glyphMarginWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[e.getId()]=i,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(i)}layoutGlyphMarginWidget(e){const i=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(i)){const t=this._glyphMarginWidgets[i];t.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(t)}}removeGlyphMarginWidget(e){const i=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(i)){const e=this._glyphMarginWidgets[i];delete this._glyphMarginWidgets[i],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(e)}}changeViewZones(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.change(e)}getTargetAtClientPoint(e,i){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getTargetAtClientPoint(e,i):null}getScrolledVisiblePosition(i){if(!this._modelData||!this._modelData.hasRealView)return null;const t=this._modelData.model.validatePosition(i),n=this._configuration.options,o=n.get(142),s=e._getVerticalOffsetForPosition(this._modelData,t.lineNumber,t.column)-this.getScrollTop(),r=this._modelData.view.getOffsetForColumn(t.lineNumber,t.column)+o.glyphMarginWidth+o.lineNumbersWidth+o.decorationsWidth-this.getScrollLeft();return{top:s,left:r,height:n.get(65)}}getOffsetForColumn(e,i){return this._modelData&&this._modelData.hasRealView?this._modelData.view.getOffsetForColumn(e,i):-1}render(e=!1){this._modelData&&this._modelData.hasRealView&&this._modelData.view.render(!0,e)}setAriaOptions(e){this._modelData&&this._modelData.hasRealView&&this._modelData.view.setAriaOptions(e)}applyFontInfo(e){(0,F.N)(e,this._configuration.options.get(49))}setBanner(e,i){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),this._bannerDomNode=e,this._configuration.setReservedHeight(e?i:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(e){if(!e)return void(this._modelData=null);const i=[];this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setModelLineCount(e.getLineCount());const t=e.onBeforeAttached(),s=new S.j(this._id,this._configuration,e,P.C.create(),V.p.create(this._configuration.options),(e=>o.jL(e)),this.languageConfigurationService,this._themeService,t);i.push(e.onWillDispose((()=>this.setModel(null)))),i.push(s.onEvent((i=>{switch(i.kind){case 0:this._onDidContentSizeChange.fire(i);break;case 1:this._editorTextFocus.setValue(i.hasFocus);break;case 2:this._onDidScrollChange.fire(i);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(i.reachedMaxCursorCount){const e=this.getOption(78),i=n.NC("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",e);this._notificationService.prompt(I.zb.Warning,i,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:n.NC("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}const e=[];for(let n=0,s=i.selections.length;n<s;n++)e[n]=i.selections[n].getPosition();const t={position:e[0],secondaryPositions:e.slice(1),reason:i.reason,source:i.source};this._onDidChangeCursorPosition.fire(t);const o={selection:i.selections[0],secondarySelections:i.selections.slice(1),modelVersionId:i.modelVersionId,oldSelections:i.oldSelections,oldModelVersionId:i.oldModelVersionId,source:i.source,reason:i.reason};this._onDidChangeCursorSelection.fire(o);break}case 7:this._onDidChangeModelDecorations.fire(i.event);break;case 8:this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._onDidChangeModelLanguage.fire(i.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(i.event);break;case 10:this._onDidChangeModelContent.fire(i.event);break;case 11:this._onDidChangeModelOptions.fire(i.event);break;case 12:this._onDidChangeModelTokens.fire(i.event);break}})));const[r,d]=this._createView(s);if(d){this._domElement.appendChild(r.domNode.domNode);let i=Object.keys(this._contentWidgets);for(let e=0,t=i.length;e<t;e++){const t=i[e];r.addContentWidget(this._contentWidgets[t])}i=Object.keys(this._overlayWidgets);for(let e=0,t=i.length;e<t;e++){const t=i[e];r.addOverlayWidget(this._overlayWidgets[t])}i=Object.keys(this._glyphMarginWidgets);for(let e=0,t=i.length;e<t;e++){const t=i[e];r.addGlyphMarginWidget(this._glyphMarginWidgets[t])}r.render(!1,!0),r.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new Y(e,s,r,d,i,t)}_createView(e){let i;i=this.isSimpleWidget?{paste:(e,i,t,n)=>{this._paste("keyboard",e,i,t,n)},type:e=>{this._type("keyboard",e)},compositionType:(e,i,t,n)=>{this._compositionType("keyboard",e,i,t,n)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:{paste:(e,i,t,n)=>{const o={text:e,pasteOnNewLine:i,multicursorText:t,mode:n};this._commandService.executeCommand("paste",o)},type:e=>{const i={text:e};this._commandService.executeCommand("type",i)},compositionType:(e,i,t,n)=>{if(t||n){const o={text:e,replacePrevCharCnt:i,replaceNextCharCnt:t,positionDelta:n};this._commandService.executeCommand("compositionType",o)}else{const t={text:e,replaceCharCnt:i};this._commandService.executeCommand("replacePreviousChar",t)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const t=new u.q(e.coordinatesConverter);t.onKeyDown=e=>this._onKeyDown.fire(e),t.onKeyUp=e=>this._onKeyUp.fire(e),t.onContextMenu=e=>this._onContextMenu.fire(e),t.onMouseMove=e=>this._onMouseMove.fire(e),t.onMouseLeave=e=>this._onMouseLeave.fire(e),t.onMouseDown=e=>this._onMouseDown.fire(e),t.onMouseUp=e=>this._onMouseUp.fire(e),t.onMouseDrag=e=>this._onMouseDrag.fire(e),t.onMouseDrop=e=>this._onMouseDrop.fire(e),t.onMouseDropCanceled=e=>this._onMouseDropCanceled.fire(e),t.onMouseWheel=e=>this._onMouseWheel.fire(e);const n=new g.G(i,this._configuration,this._themeService.getColorTheme(),e,t,this._overflowWidgetsDomNode,this._instantiationService);return[n,!0]}_postDetachModelCleanup(e){null===e||void 0===e||e.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(!this._modelData)return null;const e=this._modelData.model,i=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),i&&this._domElement.contains(i)&&this._domElement.removeChild(i),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._domElement.removeChild(this._bannerDomNode),e}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}hasModel(){return null!==this._modelData}showDropIndicatorAt(i){const t=[{range:new p.e(i.lineNumber,i.column,i.lineNumber,i.column),options:e.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(t),this.revealPosition(i,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(e,i){this._contextKeyService.createKey(e,i)}};ee.dropIntoEditorDecorationOptions=D.qx.register({description:"workbench-dnd-target",className:"dnd-target"}),ee=$([G(3,R.TG),G(4,c.$),G(5,N.H),G(6,y.i6),G(7,T.XE),G(8,I.lT),G(9,x.F),G(10,A.c_),G(11,H.p)],ee);class ie extends d.JT{constructor(e){super(),this._emitterOptions=e,this._onDidChangeToTrue=this._register(new r.Q5(this._emitterOptions)),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new r.Q5(this._emitterOptions)),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(e){const i=e?2:1;this._value!==i&&(this._value=i,2===this._value?this._onDidChangeToTrue.fire():1===this._value&&this._onDidChangeToFalse.fire())}}class te extends r.Q5{constructor(e,i){super({deliveryQueue:i}),this._contributions=e}fire(e){this._contributions.onBeforeInteractionEvent(),super.fire(e)}}class ne extends d.JT{constructor(e,i){super(),this._editor=e,i.createKey("editorId",e.getId()),this._editorSimpleInput=C.u.editorSimpleInput.bindTo(i),this._editorFocus=C.u.focus.bindTo(i),this._textInputFocus=C.u.textInputFocus.bindTo(i),this._editorTextFocus=C.u.editorTextFocus.bindTo(i),this._editorTabMovesFocus=C.u.tabMovesFocus.bindTo(i),this._editorReadonly=C.u.readOnly.bindTo(i),this._inDiffEditor=C.u.inDiffEditor.bindTo(i),this._editorColumnSelection=C.u.columnSelection.bindTo(i),this._hasMultipleSelections=C.u.hasMultipleSelections.bindTo(i),this._hasNonEmptySelection=C.u.hasNonEmptySelection.bindTo(i),this._canUndo=C.u.canUndo.bindTo(i),this._canRedo=C.u.canRedo.bindTo(i),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromConfig()))),this._register(this._editor.onDidChangeCursorSelection((()=>this._updateFromSelection()))),this._register(this._editor.onDidFocusEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorWidget((()=>this._updateFromFocus()))),this._register(this._editor.onDidFocusEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidBlurEditorText((()=>this._updateFromFocus()))),this._register(this._editor.onDidChangeModel((()=>this._updateFromModel()))),this._register(this._editor.onDidChangeConfiguration((()=>this._updateFromModel()))),this._register(Q.n.onDidChangeTabFocus((()=>this._editorTabMovesFocus.set(Q.n.getTabFocusMode("editorFocus"))))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const e=this._editor.getOptions();this._editorTabMovesFocus.set(Q.n.getTabFocusMode("editorFocus")),this._editorReadonly.set(e.get(89)),this._inDiffEditor.set(e.get(60)),this._editorColumnSelection.set(e.get(21))}_updateFromSelection(){const e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some((e=>!e.isEmpty())))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const e=this._editor.getModel();this._canUndo.set(Boolean(e&&e.canUndo())),this._canRedo.set(Boolean(e&&e.canRedo()))}}class oe extends d.JT{constructor(e,i,t){super(),this._editor=e,this._contextKeyService=i,this._languageFeaturesService=t,this._langId=C.u.languageId.bindTo(i),this._hasCompletionItemProvider=C.u.hasCompletionItemProvider.bindTo(i),this._hasCodeActionsProvider=C.u.hasCodeActionsProvider.bindTo(i),this._hasCodeLensProvider=C.u.hasCodeLensProvider.bindTo(i),this._hasDefinitionProvider=C.u.hasDefinitionProvider.bindTo(i),this._hasDeclarationProvider=C.u.hasDeclarationProvider.bindTo(i),this._hasImplementationProvider=C.u.hasImplementationProvider.bindTo(i),this._hasTypeDefinitionProvider=C.u.hasTypeDefinitionProvider.bindTo(i),this._hasHoverProvider=C.u.hasHoverProvider.bindTo(i),this._hasDocumentHighlightProvider=C.u.hasDocumentHighlightProvider.bindTo(i),this._hasDocumentSymbolProvider=C.u.hasDocumentSymbolProvider.bindTo(i),this._hasReferenceProvider=C.u.hasReferenceProvider.bindTo(i),this._hasRenameProvider=C.u.hasRenameProvider.bindTo(i),this._hasSignatureHelpProvider=C.u.hasSignatureHelpProvider.bindTo(i),this._hasInlayHintsProvider=C.u.hasInlayHintsProvider.bindTo(i),this._hasDocumentFormattingProvider=C.u.hasDocumentFormattingProvider.bindTo(i),this._hasDocumentSelectionFormattingProvider=C.u.hasDocumentSelectionFormattingProvider.bindTo(i),this._hasMultipleDocumentFormattingProvider=C.u.hasMultipleDocumentFormattingProvider.bindTo(i),this._hasMultipleDocumentSelectionFormattingProvider=C.u.hasMultipleDocumentSelectionFormattingProvider.bindTo(i),this._isInWalkThrough=C.u.isInWalkThroughSnippet.bindTo(i);const n=()=>this._update();this._register(e.onDidChangeModel(n)),this._register(e.onDidChangeModelLanguage(n)),this._register(t.completionProvider.onDidChange(n)),this._register(t.codeActionProvider.onDidChange(n)),this._register(t.codeLensProvider.onDidChange(n)),this._register(t.definitionProvider.onDidChange(n)),this._register(t.declarationProvider.onDidChange(n)),this._register(t.implementationProvider.onDidChange(n)),this._register(t.typeDefinitionProvider.onDidChange(n)),this._register(t.hoverProvider.onDidChange(n)),this._register(t.documentHighlightProvider.onDidChange(n)),this._register(t.documentSymbolProvider.onDidChange(n)),this._register(t.referenceProvider.onDidChange(n)),this._register(t.renameProvider.onDidChange(n)),this._register(t.documentFormattingEditProvider.onDidChange(n)),this._register(t.documentRangeFormattingEditProvider.onDidChange(n)),this._register(t.signatureHelpProvider.onDidChange(n)),this._register(t.inlayHintsProvider.onDidChange(n)),n()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents((()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInWalkThrough.reset()}))}_update(){const e=this._editor.getModel();e?this._contextKeyService.bufferChangeEvents((()=>{this._langId.set(e.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(e)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(e)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(e)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(e)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(e)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(e)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(e)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(e)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(e)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(e)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(e)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(e)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(e)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(e)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(e)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(e).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._isInWalkThrough.set(e.uri.scheme===a.lg.walkThroughSnippet)})):this.reset()}}class se extends d.JT{constructor(e){super(),this._onChange=this._register(new r.Q5),this.onChange=this._onChange.event,this._hasFocus=!1,this._domFocusTracker=this._register(o.go(e)),this._register(this._domFocusTracker.onDidFocus((()=>{this._hasFocus=!0,this._onChange.fire(void 0)}))),this._register(this._domFocusTracker.onDidBlur((()=>{this._hasFocus=!1,this._onChange.fire(void 0)})))}hasFocus(){return this._hasFocus}}class re{get length(){return this._decorationIds.length}constructor(e,i){this._editor=e,this._decorationIds=[],this._isChangingDecorations=!1,Array.isArray(i)&&i.length>0&&this.set(i)}onDidChange(e,i,t){return this._editor.onDidChangeModelDecorations((t=>{this._isChangingDecorations||e.call(i,t)}),t)}getRange(e){return this._editor.hasModel()?e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e]):null}getRanges(){if(!this._editor.hasModel())return[];const e=this._editor.getModel(),i=[];for(const t of this._decorationIds){const n=e.getDecorationRange(t);n&&i.push(n)}return i}has(e){return this._decorationIds.includes(e.id)}clear(){0!==this._decorationIds.length&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations((i=>{this._decorationIds=i.deltaDecorations(this._decorationIds,e)}))}finally{this._isChangingDecorations=!1}return this._decorationIds}}const de=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),ae=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function le(e){return de+encodeURIComponent(e.toString())+ae}const he=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),ce=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function ge(e){return he+encodeURIComponent(e.toString())+ce}(0,T.Ic)(((e,i)=>{const t=e.getColor(E.lXJ);t&&i.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${le(t)}") repeat-x bottom left; }`);const n=e.getColor(E.uoC);n&&i.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${le(n)}") repeat-x bottom left; }`);const o=e.getColor(E.c63);o&&i.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${le(o)}") repeat-x bottom left; }`);const s=e.getColor(E.Dut);s&&i.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${ge(s)}") no-repeat bottom left; }`);const r=e.getColor(L.zu);r&&i.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${r.rgba.a}; }`)}))},2510:(e,i,t)=>{t.d(i,{p:()=>re,N:()=>oe});var n=t(76526),o=t(25503),s=t(36323),r=t(25873),d=t(39981),a=t(19427),l=t(57171),h=t(11164),c=t(746),g=t(21813),u=t(62407),m=t(52644),f=t(35285),_=t(36330),p=t(54775),v=t(67641),b=t(22035),w=t(38423),C=t(58548),D=t(28183),L=t(79827),E=t(76601),S=t(31434),N=t(81524),y=t(26145),R=function(e,i,t,n){function o(e){return e instanceof t?e:new t((function(i){i(e)}))}return new(t||(t=Promise))((function(t,s){function r(e){try{a(n.next(e))}catch(i){s(i)}}function d(e){try{a(n["throw"](e))}catch(i){s(i)}}function a(e){e.done?t(e.value):o(e.value).then(r,d)}a((n=n.apply(e,i||[])).next())}))};class M extends m.JT{get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}constructor(e,i,t,o,s,r){super(),this._viewZoneId=e,this._marginDomNode=i,this.editor=t,this.diff=o,this._contextMenuService=s,this._clipboardService=r,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=f.k.asClassName(h.l.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const d=t.getOption(65),a=t.getModel().getEOL();this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${d}px`,this._diffActions.style.lineHeight=`${d}px`,this._marginDomNode.appendChild(this._diffActions);const l=[],c=0===o.modifiedEndLineNumber;l.push(new S.aU("diff.clipboard.copyDeletedContent",c?o.originalEndLineNumber>o.modifiedStartLineNumber?E.NC("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):E.NC("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):o.originalEndLineNumber>o.modifiedStartLineNumber?E.NC("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):E.NC("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,(()=>R(this,void 0,void 0,(function*(){const e=new N.e(o.originalStartLineNumber,1,o.originalEndLineNumber+1,1),i=o.originalModel.getValueInRange(e);yield this._clipboardService.writeText(i)})))));let g,u=0;o.originalEndLineNumber>o.modifiedStartLineNumber&&(g=new S.aU("diff.clipboard.copyDeletedLineContent",c?E.NC("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",o.originalStartLineNumber):E.NC("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",o.originalStartLineNumber),void 0,!0,(()=>R(this,void 0,void 0,(function*(){const e=o.originalModel.getLineContent(o.originalStartLineNumber+u);if(""===e){const e=o.originalModel.getEndOfLineSequence();yield this._clipboardService.writeText(0===e?"\n":"\r\n")}else yield this._clipboardService.writeText(e)})))),l.push(g));const m=t.getOption(89);m||l.push(new S.aU("diff.inline.revertChange",E.NC("diff.inline.revertChange.label","Revert this change"),void 0,!0,(()=>R(this,void 0,void 0,(function*(){const e=new N.e(o.originalStartLineNumber,1,o.originalEndLineNumber,o.originalModel.getLineMaxColumn(o.originalEndLineNumber)),i=o.originalModel.getValueInRange(e);if(0===o.modifiedEndLineNumber){const e=t.getModel().getLineMaxColumn(o.modifiedStartLineNumber);t.executeEdits("diffEditor",[{range:new N.e(o.modifiedStartLineNumber,e,o.modifiedStartLineNumber,e),text:a+i}])}else{const e=t.getModel().getLineMaxColumn(o.modifiedEndLineNumber);t.executeEdits("diffEditor",[{range:new N.e(o.modifiedStartLineNumber,1,o.modifiedEndLineNumber,e),text:i}])}})))));const _=t.getOption(125)&&!y.gn,p=(e,i)=>{var n;this._contextMenuService.showContextMenu({domForShadowRoot:_&&null!==(n=t.getDomNode())&&void 0!==n?n:void 0,getAnchor:()=>({x:e,y:i}),getActions:()=>(g&&(g.label=c?E.NC("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",o.originalStartLineNumber+u):E.NC("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",o.originalStartLineNumber+u)),l),autoSelectFirstItem:!0})};this._register(n.mu(this._diffActions,"mousedown",(e=>{const{top:i,height:t}=n.i(this._diffActions),o=Math.floor(d/3);e.preventDefault(),p(e.posx,i+t+o)}))),this._register(t.onMouseMove((e=>{if(8===e.target.type||5===e.target.type){const i=e.target.detail.viewZoneId;i===this._viewZoneId?(this.visibility=!0,u=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,d)):this.visibility=!1}else this.visibility=!1}))),this._register(t.onMouseDown((e=>{if(e.event.rightButton&&(8===e.target.type||5===e.target.type)){const i=e.target.detail.viewZoneId;i===this._viewZoneId&&(e.event.preventDefault(),u=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,d),p(e.event.posx,e.event.posy+d))}})))}_updateLightBulbPosition(e,i,t){const{top:o}=n.i(e),s=i-o,r=Math.floor(s/t),d=r*t;if(this._diffActions.style.top=`${d}px`,this.diff.viewLineCounts){let e=0;for(let i=0;i<this.diff.viewLineCounts.length;i++)if(e+=this.diff.viewLineCounts[i],r<e)return i}return r}}var I=t(58707),T=t(29065),x=t(8655),O=t(44651),V=t(90290),P=t(90694),W=t(71593),A=t(62629),F=t(65298),H=t(37563),k=t(25099),z=t(73738),B=t(25065),U=t(46096),Z=t(61156),K=t(82915),j=t(96592),q=t(28506),Q=t(40118),$=t(8443),G=t(74821),J=function(e,i,t,n){var o,s=arguments.length,r=s<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(i,t,r):o(i,t))||r);return s>3&&r&&Object.defineProperty(i,t,r),r},X=function(e,i){return function(t,n){i(t,n,e)}},Y=function(e,i,t,n){function o(e){return e instanceof t?e:new t((function(i){i(e)}))}return new(t||(t=Promise))((function(t,s){function r(e){try{a(n.next(e))}catch(i){s(i)}}function d(e){try{a(n["throw"](e))}catch(i){s(i)}}function a(e){e.done?t(e.value):o(e.value).then(r,d)}a((n=n.apply(e,i||[])).next())}))};class ee{constructor(e,i){this._contextMenuService=e,this._clipboardService=i,this._zones=[],this._inlineDiffMargins=[],this._zonesMap={},this._decorations=[]}getForeignViewZones(e){return e.filter((e=>!this._zonesMap[String(e.id)]))}clean(e){this._zones.length>0&&e.changeViewZones((e=>{for(const i of this._zones)e.removeZone(i)})),this._zones=[],this._zonesMap={},e.changeDecorations((e=>{this._decorations=e.deltaDecorations(this._decorations,[])}))}apply(e,i,t,n){const o=n?w.Z.capture(e):null;e.changeViewZones((i=>{var n;for(const e of this._zones)i.removeZone(e);for(const e of this._inlineDiffMargins)e.dispose();this._zones=[],this._zonesMap={},this._inlineDiffMargins=[];for(let o=0,s=t.zones.length;o<s;o++){const s=t.zones[o];s.suppressMouseDown=!0,s.showInHiddenAreas=!0;const r=i.addZone(s);this._zones.push(r),this._zonesMap[String(r)]=!0,t.zones[o].diff&&s.marginDomNode&&(s.suppressMouseDown=!1,0!==(null===(n=t.zones[o].diff)||void 0===n?void 0:n.originalModel.getValueLength())&&this._inlineDiffMargins.push(new M(r,s.marginDomNode,e,t.zones[o].diff,this._contextMenuService,this._clipboardService)))}})),null===o||void 0===o||o.restore(e),e.changeDecorations((e=>{this._decorations=e.deltaDecorations(this._decorations,t.decorations)})),null===i||void 0===i||i.setZones(t.overviewZones)}}let ie=0;const te=(0,$.q5)("diff-insert",h.l.add,E.NC("diffInsertIcon","Line decoration for inserts in the diff editor.")),ne=(0,$.q5)("diff-remove",h.l.remove,E.NC("diffRemoveIcon","Line decoration for removals in the diff editor.")),oe=(0,s.Z)("diffEditorWidget",{createHTML:e=>e}),se=E.NC("diff-aria-navigation-tip"," use Shift + F7 to navigate changes");let re=class e extends m.JT{constructor(i,t,s,r,d,a,h,u,m,f,_){super(),this._editorProgressService=_,this._onDidDispose=this._register(new g.Q5),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModel=this._register(new g.Q5),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidUpdateDiff=this._register(new g.Q5),this.onDidUpdateDiff=this._onDidUpdateDiff.event,this._onDidContentSizeChange=this._register(new g.Q5),this._lastOriginalWarning=null,this._lastModifiedWarning=null,h.willCreateDiffEditor(),this._documentDiffProvider=this._register(a.createInstance(I.Q,t)),this._register(this._documentDiffProvider.onDidChange((e=>this._beginUpdateDecorationsSoon()))),this._codeEditorService=h,this._contextKeyService=this._register(d.createScoped(i)),this._instantiationService=a.createChild(new K.y([B.i6,this._contextKeyService])),this._contextKeyService.createKey("isInDiffEditor",!0),this._themeService=u,this._notificationService=m,this._id=++ie,this._state=0,this._updatingDiffProgress=null,this._domElement=i,t=t||{},this._options=Ee(t,{enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{collapseUnchangedRegions:!1},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1}),this.isEmbeddedDiffEditorKey=P.u.isEmbeddedDiffEditor.bindTo(this._contextKeyService),this.isEmbeddedDiffEditorKey.set("undefined"!==typeof t.isInEmbeddedEditor&&t.isInEmbeddedEditor),this._updateDecorationsRunner=this._register(new l.pY((()=>this._updateDecorations()),0)),this._containerDomElement=document.createElement("div"),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide),this._containerDomElement.style.position="relative",this._containerDomElement.style.height="100%",this._domElement.appendChild(this._containerDomElement),this._overviewViewportDomElement=(0,o.X)(document.createElement("div")),this._overviewViewportDomElement.setClassName("diffViewport"),this._overviewViewportDomElement.setPosition("absolute"),this._overviewDomElement=document.createElement("div"),this._overviewDomElement.className="diffOverview",this._overviewDomElement.style.position="absolute",this._overviewDomElement.appendChild(this._overviewViewportDomElement.domNode),this._register(n.mu(this._overviewDomElement,n.tw.POINTER_DOWN,(e=>{this._modifiedEditor.delegateVerticalScrollbarPointerDown(e)}))),this._register(n.nm(this._overviewDomElement,n.tw.MOUSE_WHEEL,(e=>{this._modifiedEditor.delegateScrollFromMouseWheelEvent(e)}),{passive:!1})),this._options.renderOverviewRuler&&this._containerDomElement.appendChild(this._overviewDomElement),this._originalDomNode=document.createElement("div"),this._originalDomNode.className="editor original",this._originalDomNode.style.position="absolute",this._originalDomNode.style.height="100%",this._containerDomElement.appendChild(this._originalDomNode),this._modifiedDomNode=document.createElement("div"),this._modifiedDomNode.className="editor modified",this._modifiedDomNode.style.position="absolute",this._modifiedDomNode.style.height="100%",this._containerDomElement.appendChild(this._modifiedDomNode),this._beginUpdateDecorationsTimeout=-1,this._currentlyChangingViewZones=!1,this._diffComputationToken=0,this._originalEditorState=new ee(f,r),this._modifiedEditorState=new ee(f,r),this._isVisible=!0,this._isHandlingScrollEvent=!1,this._elementSizeObserver=this._register(new p.I(this._containerDomElement,t.dimension)),this._register(this._elementSizeObserver.onDidChange((()=>this._onDidContainerSizeChanged()))),t.automaticLayout&&this._elementSizeObserver.startObserving(),this._diffComputationResult=null,this._originalEditor=this._createLeftHandSideEditor(t,s.originalEditor||{}),this._modifiedEditor=this._createRightHandSideEditor(t,s.modifiedEditor||{}),this._originalOverviewRuler=null,this._modifiedOverviewRuler=null,this._reviewPane=a.createInstance(L.j,this),this._containerDomElement.appendChild(this._reviewPane.domNode.domNode),this._containerDomElement.appendChild(this._reviewPane.shadow.domNode),this._containerDomElement.appendChild(this._reviewPane.actionBarContainer.domNode),this._options.renderSideBySide?this._setStrategy(new ge(this._createDataSource(),this._options.enableSplitViewResizing,this._options.splitViewDefaultRatio)):this._setStrategy(new me(this._createDataSource(),this._options.enableSplitViewResizing)),this._register(u.onDidColorThemeChange((i=>{this._strategy&&this._strategy.applyColors(i)&&this._updateDecorationsRunner.schedule(),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide)})));const b=v.Uc.getDiffEditorContributions();for(const e of b)try{this._register(a.createInstance(e.ctor,this))}catch(w){(0,c.dL)(w)}this._codeEditorService.addDiffEditor(this)}_setState(e){this._state!==e&&(this._state=e,this._updatingDiffProgress&&(this._updatingDiffProgress.done(),this._updatingDiffProgress=null),1===this._state&&(this._updatingDiffProgress=this._editorProgressService.show(!0,1e3)))}accessibleDiffViewerNext(){this._reviewPane.next()}accessibleDiffViewerPrev(){this._reviewPane.prev()}static _getClassName(e,i){let t="monaco-diff-editor monaco-editor-background ";return i&&(t+="side-by-side "),t+=(0,G.m6)(e.type),t}_disposeOverviewRulers(){this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose(),this._originalOverviewRuler=null),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose(),this._modifiedOverviewRuler=null)}_createOverviewRulers(){this._options.renderOverviewRuler&&(a.ok(!this._originalOverviewRuler&&!this._modifiedOverviewRuler),this._originalEditor.hasModel()&&(this._originalOverviewRuler=this._originalEditor.createOverviewRuler("original diffOverviewRuler"),this._overviewDomElement.appendChild(this._originalOverviewRuler.getDomNode())),this._modifiedEditor.hasModel()&&(this._modifiedOverviewRuler=this._modifiedEditor.createOverviewRuler("modified diffOverviewRuler"),this._overviewDomElement.appendChild(this._modifiedOverviewRuler.getDomNode())),this._layoutOverviewRulers())}_createLeftHandSideEditor(i,t){const n=this._createInnerEditor(this._instantiationService,this._originalDomNode,this._adjustOptionsForLeftHandSide(i),t);this._register(n.onDidScrollChange((e=>{this._isHandlingScrollEvent||(e.scrollTopChanged||e.scrollLeftChanged||e.scrollHeightChanged)&&(this._isHandlingScrollEvent=!0,this._modifiedEditor.setScrollPosition({scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())}))),this._register(n.onDidChangeViewZones((()=>{this._onViewZonesChanged()}))),this._register(n.onDidChangeConfiguration((e=>{n.getModel()&&(e.hasChanged(49)&&this._updateDecorationsRunner.schedule(),e.hasChanged(143)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))}))),this._register(n.onDidChangeHiddenAreas((()=>{this._updateDecorationsRunner.cancel(),this._updateDecorations()}))),this._register(n.onDidChangeModelContent((()=>{this._isVisible&&this._beginUpdateDecorationsSoon()})));const o=this._contextKeyService.createKey("isInDiffLeftEditor",n.hasWidgetFocus());return this._register(n.onDidFocusEditorWidget((()=>o.set(!0)))),this._register(n.onDidBlurEditorWidget((()=>o.set(!1)))),this._register(n.onDidContentSizeChange((i=>{const t=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+e.ONE_OVERVIEW_WIDTH,n=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:n,contentWidth:t,contentHeightChanged:i.contentHeightChanged,contentWidthChanged:i.contentWidthChanged})}))),n}_createRightHandSideEditor(i,t){const n=this._createInnerEditor(this._instantiationService,this._modifiedDomNode,this._adjustOptionsForRightHandSide(i),t);this._register(n.onDidScrollChange((e=>{this._isHandlingScrollEvent||(e.scrollTopChanged||e.scrollLeftChanged||e.scrollHeightChanged)&&(this._isHandlingScrollEvent=!0,this._originalEditor.setScrollPosition({scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}),this._isHandlingScrollEvent=!1,this._layoutOverviewViewport())}))),this._register(n.onDidChangeViewZones((()=>{this._onViewZonesChanged()}))),this._register(n.onDidChangeConfiguration((e=>{n.getModel()&&(e.hasChanged(49)&&this._updateDecorationsRunner.schedule(),e.hasChanged(143)&&(this._updateDecorationsRunner.cancel(),this._updateDecorations()))}))),this._register(n.onDidChangeHiddenAreas((()=>{this._updateDecorationsRunner.cancel(),this._updateDecorations()}))),this._register(n.onDidChangeModelContent((()=>{this._isVisible&&this._beginUpdateDecorationsSoon()}))),this._register(n.onDidChangeModelOptions((e=>{e.tabSize&&this._updateDecorationsRunner.schedule()})));const o=this._contextKeyService.createKey("isInDiffRightEditor",n.hasWidgetFocus());return this._register(n.onDidFocusEditorWidget((()=>o.set(!0)))),this._register(n.onDidBlurEditorWidget((()=>o.set(!1)))),this._register(n.onDidContentSizeChange((i=>{const t=this._originalEditor.getContentWidth()+this._modifiedEditor.getContentWidth()+e.ONE_OVERVIEW_WIDTH,n=Math.max(this._modifiedEditor.getContentHeight(),this._originalEditor.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:n,contentWidth:t,contentHeightChanged:i.contentHeightChanged,contentWidthChanged:i.contentWidthChanged})}))),this._register(n.onMouseDown((e=>{var i,t;if(!e.event.rightButton&&e.target.position&&(null===(i=e.target.element)||void 0===i?void 0:i.className.includes("arrow-revert-change"))){const i=e.target.position.lineNumber,n=e.target,o=null===(t=this._diffComputationResult)||void 0===t?void 0:t.changes.find((e=>(null===n||void 0===n?void 0:n.detail.afterLineNumber)===e.modifiedStartLineNumber||e.modifiedEndLineNumber>0&&e.modifiedStartLineNumber===i));return o&&this.revertChange(o),e.event.stopPropagation(),void this._updateDecorations()}}))),n}revertChange(e){const i=this._modifiedEditor,t=this._originalEditor.getModel(),n=this._modifiedEditor.getModel();if(!t||!n||!i)return;const o=e.originalEndLineNumber>0?new N.e(e.originalStartLineNumber,1,e.originalEndLineNumber,t.getLineMaxColumn(e.originalEndLineNumber)):null,s=o?t.getValueInRange(o):null,r=e.modifiedEndLineNumber>0?new N.e(e.modifiedStartLineNumber,1,e.modifiedEndLineNumber,n.getLineMaxColumn(e.modifiedEndLineNumber)):null,d=n.getEOL();if(0===e.originalEndLineNumber&&r){let t=r;e.modifiedStartLineNumber>1?t=r.setStartPosition(e.modifiedStartLineNumber-1,n.getLineMaxColumn(e.modifiedStartLineNumber-1)):e.modifiedEndLineNumber<n.getLineCount()&&(t=r.setEndPosition(e.modifiedEndLineNumber+1,1)),i.executeEdits("diffEditor",[{range:t,text:""}])}else if(0===e.modifiedEndLineNumber&&null!==s){const t=e.modifiedStartLineNumber<n.getLineCount()?new x.L(e.modifiedStartLineNumber+1,1):new x.L(e.modifiedStartLineNumber,n.getLineMaxColumn(e.modifiedStartLineNumber));i.executeEdits("diffEditor",[{range:N.e.fromPositions(t,t),text:e.modifiedStartLineNumber<n.getLineCount()?s+d:d+s}])}else r&&null!==s&&i.executeEdits("diffEditor",[{range:r,text:s}])}_createInnerEditor(e,i,t,n){return e.createInstance(C.Gm,i,t,n)}dispose(){this._codeEditorService.removeDiffEditor(this),-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._cleanViewZonesAndDecorations(),this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose()),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose()),this._overviewDomElement.removeChild(this._overviewViewportDomElement.domNode),this._options.renderOverviewRuler&&this._containerDomElement.removeChild(this._overviewDomElement),this._containerDomElement.removeChild(this._originalDomNode),this._originalEditor.dispose(),this._containerDomElement.removeChild(this._modifiedDomNode),this._modifiedEditor.dispose(),this._strategy.dispose(),this._containerDomElement.removeChild(this._reviewPane.domNode.domNode),this._containerDomElement.removeChild(this._reviewPane.shadow.domNode),this._containerDomElement.removeChild(this._reviewPane.actionBarContainer.domNode),this._reviewPane.dispose(),this._domElement.removeChild(this._containerDomElement),this._onDidDispose.fire(),super.dispose()}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return V.g.IDiffEditor}getLineChanges(){return this._diffComputationResult?this._diffComputationResult.changes:null}getOriginalEditor(){return this._originalEditor}getModifiedEditor(){return this._modifiedEditor}updateOptions(i){const t=Ee(i,this._options),n=Se(this._options,t);this._options=t,this.isEmbeddedDiffEditorKey.set("undefined"!==typeof i.isInEmbeddedEditor&&i.isInEmbeddedEditor);const o=n.ignoreTrimWhitespace||n.renderIndicators||n.renderMarginRevertIcon,s=this._isVisible&&(n.maxComputationTime||n.maxFileSize);this._documentDiffProvider.setOptions(t),o?this._beginUpdateDecorations():s&&this._beginUpdateDecorationsSoon(),this._modifiedEditor.updateOptions(this._adjustOptionsForRightHandSide(i)),this._originalEditor.updateOptions(this._adjustOptionsForLeftHandSide(i)),this._strategy.setEnableSplitViewResizing(this._options.enableSplitViewResizing,this._options.splitViewDefaultRatio),n.renderSideBySide&&(this._options.renderSideBySide?this._setStrategy(new ge(this._createDataSource(),this._options.enableSplitViewResizing,this._options.splitViewDefaultRatio)):this._setStrategy(new me(this._createDataSource(),this._options.enableSplitViewResizing)),this._containerDomElement.className=e._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide)),n.renderOverviewRuler&&(this._options.renderOverviewRuler?this._containerDomElement.appendChild(this._overviewDomElement):this._containerDomElement.removeChild(this._overviewDomElement))}getModel(){return{original:this._originalEditor.getModel(),modified:this._modifiedEditor.getModel()}}createViewModel(e){return{model:e,waitForDiff(){return Y(this,void 0,void 0,(function*(){}))}}}setModel(e){if(e&&"model"in e&&(e=e.model),e&&(!e.original||!e.modified))throw new Error(e.original?"DiffEditorWidget.setModel: Modified model is null":"DiffEditorWidget.setModel: Original model is null");this._cleanViewZonesAndDecorations(),this._disposeOverviewRulers(),this._originalEditor.setModel(e?e.original:null),this._modifiedEditor.setModel(e?e.modified:null),this._updateDecorationsRunner.cancel(),e&&(this._originalEditor.setScrollTop(0),this._modifiedEditor.setScrollTop(0)),this._diffComputationResult=null,this._diffComputationToken++,this._setState(0),e&&(this._createOverviewRulers(),this._beginUpdateDecorations()),this._layoutOverviewViewport(),this._onDidChangeModel.fire(),this._diffNavigator=this._register(this._instantiationService.createInstance(D.F,this,{alwaysRevealFirst:!1,findResultLoop:this.getModifiedEditor().getOption(40).loop}))}getContainerDomNode(){return this._domElement}getVisibleColumnFromPosition(e){return this._modifiedEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._modifiedEditor.getPosition()}setPosition(e,i="api"){this._modifiedEditor.setPosition(e,i)}revealLine(e,i=0){this._modifiedEditor.revealLine(e,i)}revealLineInCenter(e,i=0){this._modifiedEditor.revealLineInCenter(e,i)}revealLineInCenterIfOutsideViewport(e,i=0){this._modifiedEditor.revealLineInCenterIfOutsideViewport(e,i)}revealLineNearTop(e,i=0){this._modifiedEditor.revealLineNearTop(e,i)}revealPosition(e,i=0){this._modifiedEditor.revealPosition(e,i)}revealPositionInCenter(e,i=0){this._modifiedEditor.revealPositionInCenter(e,i)}revealPositionInCenterIfOutsideViewport(e,i=0){this._modifiedEditor.revealPositionInCenterIfOutsideViewport(e,i)}revealPositionNearTop(e,i=0){this._modifiedEditor.revealPositionNearTop(e,i)}getSelection(){return this._modifiedEditor.getSelection()}getSelections(){return this._modifiedEditor.getSelections()}setSelection(e,i="api"){this._modifiedEditor.setSelection(e,i)}setSelections(e,i="api"){this._modifiedEditor.setSelections(e,i)}revealLines(e,i,t=0){this._modifiedEditor.revealLines(e,i,t)}revealLinesInCenter(e,i,t=0){this._modifiedEditor.revealLinesInCenter(e,i,t)}revealLinesInCenterIfOutsideViewport(e,i,t=0){this._modifiedEditor.revealLinesInCenterIfOutsideViewport(e,i,t)}revealLinesNearTop(e,i,t=0){this._modifiedEditor.revealLinesNearTop(e,i,t)}revealRange(e,i=0,t=!1,n=!0){this._modifiedEditor.revealRange(e,i,t,n)}revealRangeInCenter(e,i=0){this._modifiedEditor.revealRangeInCenter(e,i)}revealRangeInCenterIfOutsideViewport(e,i=0){this._modifiedEditor.revealRangeInCenterIfOutsideViewport(e,i)}revealRangeNearTop(e,i=0){this._modifiedEditor.revealRangeNearTop(e,i)}revealRangeNearTopIfOutsideViewport(e,i=0){this._modifiedEditor.revealRangeNearTopIfOutsideViewport(e,i)}revealRangeAtTop(e,i=0){this._modifiedEditor.revealRangeAtTop(e,i)}getSupportedActions(){return this._modifiedEditor.getSupportedActions()}focus(){this._modifiedEditor.focus()}trigger(e,i,t){this._modifiedEditor.trigger(e,i,t)}createDecorationsCollection(e){return this._modifiedEditor.createDecorationsCollection(e)}changeDecorations(e){return this._modifiedEditor.changeDecorations(e)}saveViewState(){const e=this._originalEditor.saveViewState(),i=this._modifiedEditor.saveViewState();return{original:e,modified:i}}restoreViewState(e){if(e&&e.original&&e.modified){const i=e;this._originalEditor.restoreViewState(i.original),this._modifiedEditor.restoreViewState(i.modified)}}layout(e){this._elementSizeObserver.observe(e)}hasTextFocus(){return this._originalEditor.hasTextFocus()||this._modifiedEditor.hasTextFocus()}_onDidContainerSizeChanged(){this._doLayout()}_getReviewHeight(){return this._reviewPane.isVisible()?this._elementSizeObserver.getHeight():0}_layoutOverviewRulers(){if(!this._options.renderOverviewRuler)return;if(!this._originalOverviewRuler||!this._modifiedOverviewRuler)return;const i=this._elementSizeObserver.getHeight(),t=this._getReviewHeight(),n=e.ENTIRE_DIFF_OVERVIEW_WIDTH-2*e.ONE_OVERVIEW_WIDTH,o=this._modifiedEditor.getLayoutInfo();o&&(this._originalOverviewRuler.setLayout({top:0,width:e.ONE_OVERVIEW_WIDTH,right:n+e.ONE_OVERVIEW_WIDTH,height:i-t}),this._modifiedOverviewRuler.setLayout({top:0,right:0,width:e.ONE_OVERVIEW_WIDTH,height:i-t}))}_onViewZonesChanged(){this._currentlyChangingViewZones||this._updateDecorationsRunner.schedule()}_beginUpdateDecorationsSoon(){-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._beginUpdateDecorationsTimeout=window.setTimeout((()=>this._beginUpdateDecorations()),e.UPDATE_DIFF_DECORATIONS_DELAY)}static _equals(e,i){return!e&&!i||!(!e||!i)&&e.toString()===i.toString()}_beginUpdateDecorations(){-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1);const i=this._originalEditor.getModel(),t=this._modifiedEditor.getModel();if(!i||!t)return;this._diffComputationToken++;const n=this._diffComputationToken,o=1024*this._options.maxFileSize*1024,s=e=>{const i=e.getValueLength();return 0===o||i<=o};s(i)&&s(t)?(this._setState(1),this._documentDiffProvider.computeDiff(i,t,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace,maxComputationTimeMs:this._options.maxComputationTime,computeMoves:!1}).then((e=>{n===this._diffComputationToken&&i===this._originalEditor.getModel()&&t===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult={identical:e.identical,quitEarly:e.quitEarly,changes2:e.changes,changes:e.changes.map((e=>{let i,t,n,o,s=e.innerChanges;return e.originalRange.isEmpty?(i=e.originalRange.startLineNumber-1,t=0,s=void 0):(i=e.originalRange.startLineNumber,t=e.originalRange.endLineNumberExclusive-1),e.modifiedRange.isEmpty?(n=e.modifiedRange.startLineNumber-1,o=0,s=void 0):(n=e.modifiedRange.startLineNumber,o=e.modifiedRange.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:t,modifiedStartLineNumber:n,modifiedEndLineNumber:o,charChanges:null===s||void 0===s?void 0:s.map((e=>({originalStartLineNumber:e.originalRange.startLineNumber,originalStartColumn:e.originalRange.startColumn,originalEndLineNumber:e.originalRange.endLineNumber,originalEndColumn:e.originalRange.endColumn,modifiedStartLineNumber:e.modifiedRange.startLineNumber,modifiedStartColumn:e.modifiedRange.startColumn,modifiedEndLineNumber:e.modifiedRange.endLineNumber,modifiedEndColumn:e.modifiedRange.endColumn})))}}))},this._updateDecorationsRunner.schedule(),this._onDidUpdateDiff.fire())}),(e=>{n===this._diffComputationToken&&i===this._originalEditor.getModel()&&t===this._modifiedEditor.getModel()&&(this._setState(2),this._diffComputationResult=null,this._updateDecorationsRunner.schedule())}))):e._equals(i.uri,this._lastOriginalWarning)&&e._equals(t.uri,this._lastModifiedWarning)||(this._lastOriginalWarning=i.uri,this._lastModifiedWarning=t.uri,this._notificationService.warn(E.NC("diff.tooLarge","Cannot compare files because one file is too large.")))}_cleanViewZonesAndDecorations(){this._originalEditorState.clean(this._originalEditor),this._modifiedEditorState.clean(this._modifiedEditor)}_updateDecorations(){if(!this._originalEditor.getModel()||!this._modifiedEditor.getModel())return;const e=this._diffComputationResult?this._diffComputationResult.changes:[],i=this._originalEditorState.getForeignViewZones(this._originalEditor.getWhitespaces()),t=this._modifiedEditorState.getForeignViewZones(this._modifiedEditor.getWhitespaces()),n=this._options.renderMarginRevertIcon&&!this._modifiedEditor.getOption(89),o=this._strategy.getEditorsDiffDecorations(e,this._options.ignoreTrimWhitespace,this._options.renderIndicators,n,i,t);try{this._currentlyChangingViewZones=!0,this._originalEditorState.apply(this._originalEditor,this._originalOverviewRuler,o.original,!1),this._modifiedEditorState.apply(this._modifiedEditor,this._modifiedOverviewRuler,o.modified,!0)}finally{this._currentlyChangingViewZones=!1}}_adjustOptionsForSubEditor(e){const i=Object.assign({},e);return i.inDiffEditor=!0,i.automaticLayout=!1,i.scrollbar=Object.assign({},i.scrollbar||{}),i.scrollbar.vertical="visible",i.folding=!1,i.codeLens=this._options.diffCodeLens,i.fixedOverflowWidgets=!0,i.minimap=Object.assign({},i.minimap||{}),i.minimap.enabled=!1,i}_adjustOptionsForLeftHandSide(e){const i=this._adjustOptionsForSubEditor(e);return this._options.renderSideBySide?i.wordWrapOverride1=this._options.diffWordWrap:(i.wordWrapOverride1="off",i.wordWrapOverride2="off",i.stickyScroll={enabled:!1}),e.originalAriaLabel&&(i.ariaLabel=e.originalAriaLabel),this._updateAriaLabel(i),i.readOnly=!this._options.originalEditable,i.dropIntoEditor={enabled:!i.readOnly},i.extraEditorClassName="original-in-monaco-diff-editor",Object.assign(Object.assign({},i),{dimension:{height:0,width:0}})}_updateAriaLabel(e){var i;let t=null!==(i=e.ariaLabel)&&void 0!==i?i:"";this._options.accessibilityVerbose?t+=se:t&&(t=t.replaceAll(se,"")),e.ariaLabel=t}_adjustOptionsForRightHandSide(i){const t=this._adjustOptionsForSubEditor(i);return i.modifiedAriaLabel&&(t.ariaLabel=i.modifiedAriaLabel),this._updateAriaLabel(t),t.wordWrapOverride1=this._options.diffWordWrap,t.revealHorizontalRightPadding=T.BH.revealHorizontalRightPadding.defaultValue+e.ENTIRE_DIFF_OVERVIEW_WIDTH,t.scrollbar.verticalHasArrows=!1,t.extraEditorClassName="modified-in-monaco-diff-editor",Object.assign(Object.assign({},t),{dimension:{height:0,width:0}})}doLayout(){this._elementSizeObserver.observe(),this._doLayout()}_doLayout(){const i=this._elementSizeObserver.getWidth(),t=this._elementSizeObserver.getHeight(),n=this._getReviewHeight(),o=this._strategy.layout();this._originalDomNode.style.width=o+"px",this._originalDomNode.style.left="0px",this._modifiedDomNode.style.width=i-o-e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._modifiedDomNode.style.left=o+"px",this._overviewDomElement.style.top="0px",this._overviewDomElement.style.height=t-n+"px",this._overviewDomElement.style.width=e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewDomElement.style.left=i-e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewViewportDomElement.setWidth(e.ENTIRE_DIFF_OVERVIEW_WIDTH),this._overviewViewportDomElement.setHeight(30),this._originalEditor.layout({width:o,height:t-n}),this._modifiedEditor.layout({width:i-o-(this._options.renderOverviewRuler?e.ENTIRE_DIFF_OVERVIEW_WIDTH:0),height:t-n}),(this._originalOverviewRuler||this._modifiedOverviewRuler)&&this._layoutOverviewRulers(),this._reviewPane.layout(t-n,i,n),this._layoutOverviewViewport()}_layoutOverviewViewport(){const e=this._computeOverviewViewport();e?(this._overviewViewportDomElement.setTop(e.top),this._overviewViewportDomElement.setHeight(e.height)):(this._overviewViewportDomElement.setTop(0),this._overviewViewportDomElement.setHeight(0))}_computeOverviewViewport(){const e=this._modifiedEditor.getLayoutInfo();if(!e)return null;const i=this._modifiedEditor.getScrollTop(),t=this._modifiedEditor.getScrollHeight(),n=Math.max(0,e.height),o=Math.max(0,n-0),s=t>0?o/t:0,r=Math.max(0,Math.floor(e.height*s)),d=Math.floor(i*s);return{height:r,top:d}}_createDataSource(){return{getWidth:()=>this._elementSizeObserver.getWidth(),getHeight:()=>this._elementSizeObserver.getHeight()-this._getReviewHeight(),getOptions:()=>({renderOverviewRuler:this._options.renderOverviewRuler}),getContainerDomNode:()=>this._containerDomElement,relayoutEditors:()=>{this._doLayout()},getOriginalEditor:()=>this._originalEditor,getModifiedEditor:()=>this._modifiedEditor}}_setStrategy(e){var i;null===(i=this._strategy)||void 0===i||i.dispose(),this._strategy=e,this._boundarySashes&&e.setBoundarySashes(this._boundarySashes),e.applyColors(this._themeService.getColorTheme()),this._diffComputationResult&&this._updateDecorations(),this._doLayout()}};re.ONE_OVERVIEW_WIDTH=15,re.ENTIRE_DIFF_OVERVIEW_WIDTH=30,re.UPDATE_DIFF_DECORATIONS_DELAY=200,re=J([X(3,z.p),X(4,B.i6),X(5,Z.TG),X(6,b.$),X(7,G.XE),X(8,j.lT),X(9,U.i),X(10,q.ek)],re);class de extends m.JT{constructor(e){super(),this._dataSource=e,this._insertColor=null,this._removeColor=null}applyColors(e){const i=e.getColor(Q.P6Y)||(e.getColor(Q.ypS)||Q.CzK).transparent(2),t=e.getColor(Q.F9q)||(e.getColor(Q.P4M)||Q.keg).transparent(2),n=!i.equals(this._insertColor)||!t.equals(this._removeColor);return this._insertColor=i,this._removeColor=t,n}getEditorsDiffDecorations(e,i,t,n,o,s){s=s.sort(((e,i)=>e.afterLineNumber-i.afterLineNumber)),o=o.sort(((e,i)=>e.afterLineNumber-i.afterLineNumber));const r=this._getViewZones(e,o,s,t),d=this._getOriginalEditorDecorations(r,e,i,t),a=this._getModifiedEditorDecorations(r,e,i,t,n);return{original:{decorations:d.decorations,overviewZones:d.overviewZones,zones:r.original},modified:{decorations:a.decorations,overviewZones:a.overviewZones,zones:r.modified}}}setBoundarySashes(e){}}class ae{constructor(e){this._source=e,this._index=-1,this.current=null,this.advance()}advance(){this._index++,this._index<this._source.length?this.current=this._source[this._index]:this.current=null}}class le{constructor(e,i,t,n,o){this._lineChanges=e,this._originalForeignVZ=i,this._modifiedForeignVZ=t,this._originalEditor=n,this._modifiedEditor=o}static _getViewLineCount(e,i,t){const n=e.getModel(),o=e._getViewModel();if(n&&o){const e=Le(n,o,i,t);return e.endLineNumber-e.startLineNumber+1}return t-i+1}getViewZones(){const e=this._originalEditor.getOption(65),i=this._modifiedEditor.getOption(65),t=-1!==this._originalEditor.getOption(143).wrappingColumn,n=-1!==this._modifiedEditor.getOption(143).wrappingColumn,o=t||n,s=this._originalEditor.getModel(),r=this._originalEditor._getViewModel().coordinatesConverter,d=this._modifiedEditor._getViewModel().coordinatesConverter,a={original:[],modified:[]};let l=0,h=0,c=0,g=0,u=0,m=0;const f=(e,i)=>e.afterLineNumber-i.afterLineNumber,_=(e,i)=>{if(null===i.domNode&&e.length>0){const t=e[e.length-1];if(t.afterLineNumber===i.afterLineNumber&&null===t.domNode)return void(t.heightInLines+=i.heightInLines)}e.push(i)},p=new ae(this._modifiedForeignVZ),v=new ae(this._originalForeignVZ);let b=1,w=1;for(let C=0,D=this._lineChanges.length;C<=D;C++){const t=C<D?this._lineChanges[C]:null;null!==t?(c=t.originalStartLineNumber+(t.originalEndLineNumber>0?-1:0),g=t.modifiedStartLineNumber+(t.modifiedEndLineNumber>0?-1:0),h=t.originalEndLineNumber>0?le._getViewLineCount(this._originalEditor,t.originalStartLineNumber,t.originalEndLineNumber):0,l=t.modifiedEndLineNumber>0?le._getViewLineCount(this._modifiedEditor,t.modifiedStartLineNumber,t.modifiedEndLineNumber):0,u=Math.max(t.originalStartLineNumber,t.originalEndLineNumber),m=Math.max(t.modifiedStartLineNumber,t.modifiedEndLineNumber)):(c+=1e7+h,g+=1e7+l,u=c,m=g);let n=[],L=[];if(o){let e;e=t?t.originalEndLineNumber>0?t.originalStartLineNumber-b:t.modifiedStartLineNumber-w:s.getLineCount()-b+1;for(let i=0;i<e;i++){const e=b+i,t=w+i,o=r.getModelLineViewLineCount(e),s=d.getModelLineViewLineCount(t);o<s?n.push({afterLineNumber:e,heightInLines:s-o,domNode:null,marginDomNode:null}):o>s&&L.push({afterLineNumber:t,heightInLines:o-s,domNode:null,marginDomNode:null})}t&&(b=(t.originalEndLineNumber>0?t.originalEndLineNumber:t.originalStartLineNumber)+1,w=(t.modifiedEndLineNumber>0?t.modifiedEndLineNumber:t.modifiedStartLineNumber)+1)}while(p.current&&p.current.afterLineNumber<=m){let e;e=p.current.afterLineNumber<=g?c-g+p.current.afterLineNumber:u;let o=null;t&&t.modifiedStartLineNumber<=p.current.afterLineNumber&&p.current.afterLineNumber<=t.modifiedEndLineNumber&&(o=this._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion()),n.push({afterLineNumber:e,heightInLines:p.current.height/i,domNode:null,marginDomNode:o}),p.advance()}while(v.current&&v.current.afterLineNumber<=u){let i;i=v.current.afterLineNumber<=c?g-c+v.current.afterLineNumber:m,L.push({afterLineNumber:i,heightInLines:v.current.height/e,domNode:null}),v.advance()}if(null!==t&&pe(t)){const e=this._produceOriginalFromDiff(t,h,l);e&&n.push(e)}if(null!==t&&ve(t)){const e=this._produceModifiedFromDiff(t,h,l);e&&L.push(e)}let E=0,S=0;n=n.sort(f),L=L.sort(f);while(E<n.length&&S<L.length){const e=n[E],i=L[S],t=e.afterLineNumber-c,o=i.afterLineNumber-g;t<o?(_(a.original,e),E++):o<t?(_(a.modified,i),S++):e.shouldNotShrink?(_(a.original,e),E++):i.shouldNotShrink?(_(a.modified,i),S++):e.heightInLines>=i.heightInLines?(e.heightInLines-=i.heightInLines,S++):(i.heightInLines-=e.heightInLines,E++)}while(E<n.length)_(a.original,n[E]),E++;while(S<L.length)_(a.modified,L[S]),S++}return{original:le._ensureDomNodes(a.original),modified:le._ensureDomNodes(a.modified)}}static _ensureDomNodes(e){return e.map((e=>(e.domNode||(e.domNode=Ce()),e)))}}function he(e,i,t,n,o){return{range:new N.e(e,i,t,n),options:o}}const ce={arrowRevertChange:W.qx.register({description:"diff-editor-arrow-revert-change",glyphMarginHoverMessage:new u.W5(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(E.NC("revertChangeHoverMessage","Click to revert change")),glyphMarginClassName:"arrow-revert-change "+f.k.asClassName(h.l.arrowRight),zIndex:10001}),charDelete:W.qx.register({description:"diff-editor-char-delete",className:"char-delete"}),charDeleteWholeLine:W.qx.register({description:"diff-editor-char-delete-whole-line",className:"char-delete",isWholeLine:!0}),charInsert:W.qx.register({description:"diff-editor-char-insert",className:"char-insert"}),charInsertWholeLine:W.qx.register({description:"diff-editor-char-insert-whole-line",className:"char-insert",isWholeLine:!0}),lineInsert:W.qx.register({description:"diff-editor-line-insert",className:"line-insert",marginClassName:"gutter-insert",isWholeLine:!0}),lineInsertWithSign:W.qx.register({description:"diff-editor-line-insert-with-sign",className:"line-insert",linesDecorationsClassName:"insert-sign "+f.k.asClassName(te),marginClassName:"gutter-insert",isWholeLine:!0}),lineDelete:W.qx.register({description:"diff-editor-line-delete",className:"line-delete",marginClassName:"gutter-delete",isWholeLine:!0}),lineDeleteWithSign:W.qx.register({description:"diff-editor-line-delete-with-sign",className:"line-delete",linesDecorationsClassName:"delete-sign "+f.k.asClassName(ne),marginClassName:"gutter-delete",isWholeLine:!0}),lineDeleteMargin:W.qx.register({description:"diff-editor-line-delete-margin",marginClassName:"gutter-delete"})};class ge extends de{constructor(e,i,t){super(e),this._disableSash=!1===i,this._defaultRatio=t,this._sashRatio=null,this._sashPosition=null,this._startSashPosition=null,this._sash=this._register(new d.g(this._dataSource.getContainerDomNode(),this,{orientation:0})),this._disableSash&&(this._sash.state=0),this._sash.onDidStart((()=>this._onSashDragStart())),this._sash.onDidChange((e=>this._onSashDrag(e))),this._sash.onDidEnd((()=>this._onSashDragEnd())),this._sash.onDidReset((()=>this._onSashReset()))}setEnableSplitViewResizing(e,i){this._defaultRatio=i;const t=!1===e;this._disableSash!==t&&(this._disableSash=t,this._sash.state=this._disableSash?0:3)}layout(e=this._sashRatio||this._defaultRatio){const i=this._dataSource.getWidth(),t=i-(this._dataSource.getOptions().renderOverviewRuler?re.ENTIRE_DIFF_OVERVIEW_WIDTH:0);let n=Math.floor((e||this._defaultRatio)*t);const o=Math.floor(this._defaultRatio*t);return n=this._disableSash?o:n||o,t>2*ge.MINIMUM_EDITOR_WIDTH?(n<ge.MINIMUM_EDITOR_WIDTH&&(n=ge.MINIMUM_EDITOR_WIDTH),n>t-ge.MINIMUM_EDITOR_WIDTH&&(n=t-ge.MINIMUM_EDITOR_WIDTH)):n=o,this._sashPosition!==n&&(this._sashPosition=n),this._sash.layout(),this._sashPosition}_onSashDragStart(){this._startSashPosition=this._sashPosition}_onSashDrag(e){const i=this._dataSource.getWidth(),t=i-(this._dataSource.getOptions().renderOverviewRuler?re.ENTIRE_DIFF_OVERVIEW_WIDTH:0),n=this.layout((this._startSashPosition+(e.currentX-e.startX))/t);this._sashRatio=n/t,this._dataSource.relayoutEditors()}_onSashDragEnd(){this._sash.layout()}_onSashReset(){this._sashRatio=this._defaultRatio,this._dataSource.relayoutEditors(),this._sash.layout()}getVerticalSashTop(e){return 0}getVerticalSashLeft(e){return this._sashPosition}getVerticalSashHeight(e){return this._dataSource.getHeight()}setBoundarySashes(e){this._sash.orthogonalEndSash=e.bottom}_getViewZones(e,i,t){const n=this._dataSource.getOriginalEditor(),o=this._dataSource.getModifiedEditor(),s=new ue(e,i,t,n,o);return s.getViewZones()}_getOriginalEditorDecorations(e,i,t,n){const o=this._dataSource.getOriginalEditor(),s=String(this._removeColor),r={decorations:[],overviewZones:[]},d=o.getModel(),a=o._getViewModel();for(const l of i)if(ve(l)){r.decorations.push({range:new N.e(l.originalStartLineNumber,1,l.originalEndLineNumber,1073741824),options:n?ce.lineDeleteWithSign:ce.lineDelete}),pe(l)&&l.charChanges||r.decorations.push(he(l.originalStartLineNumber,1,l.originalEndLineNumber,1073741824,ce.charDeleteWholeLine));const e=Le(d,a,l.originalStartLineNumber,l.originalEndLineNumber);if(r.overviewZones.push(new k.EY(e.startLineNumber,e.endLineNumber,0,s)),l.charChanges)for(const i of l.charChanges)if(we(i))if(t)for(let e=i.originalStartLineNumber;e<=i.originalEndLineNumber;e++){let t,n;t=e===i.originalStartLineNumber?i.originalStartColumn:d.getLineFirstNonWhitespaceColumn(e),n=e===i.originalEndLineNumber?i.originalEndColumn:d.getLineLastNonWhitespaceColumn(e),r.decorations.push(he(e,t,e,n,ce.charDelete))}else r.decorations.push(he(i.originalStartLineNumber,i.originalStartColumn,i.originalEndLineNumber,i.originalEndColumn,ce.charDelete))}return r}_getModifiedEditorDecorations(e,i,t,n,o){const s=this._dataSource.getModifiedEditor(),r=String(this._insertColor),d={decorations:[],overviewZones:[]},a=s.getModel(),l=s._getViewModel();for(const h of i){if(o)if(h.modifiedEndLineNumber>0)d.decorations.push({range:new N.e(h.modifiedStartLineNumber,1,h.modifiedStartLineNumber,1),options:ce.arrowRevertChange});else{const i=e.modified.find((e=>e.afterLineNumber===h.modifiedStartLineNumber));i&&(i.marginDomNode=De())}if(pe(h)){d.decorations.push({range:new N.e(h.modifiedStartLineNumber,1,h.modifiedEndLineNumber,1073741824),options:n?ce.lineInsertWithSign:ce.lineInsert}),ve(h)&&h.charChanges||d.decorations.push(he(h.modifiedStartLineNumber,1,h.modifiedEndLineNumber,1073741824,ce.charInsertWholeLine));const e=Le(a,l,h.modifiedStartLineNumber,h.modifiedEndLineNumber);if(d.overviewZones.push(new k.EY(e.startLineNumber,e.endLineNumber,0,r)),h.charChanges)for(const i of h.charChanges)if(be(i))if(t)for(let e=i.modifiedStartLineNumber;e<=i.modifiedEndLineNumber;e++){let t,n;t=e===i.modifiedStartLineNumber?i.modifiedStartColumn:a.getLineFirstNonWhitespaceColumn(e),n=e===i.modifiedEndLineNumber?i.modifiedEndColumn:a.getLineLastNonWhitespaceColumn(e),d.decorations.push(he(e,t,e,n,ce.charInsert))}else d.decorations.push(he(i.modifiedStartLineNumber,i.modifiedStartColumn,i.modifiedEndLineNumber,i.modifiedEndColumn,ce.charInsert))}}return d}}ge.MINIMUM_EDITOR_WIDTH=100;class ue extends le{constructor(e,i,t,n,o){super(e,i,t,n,o)}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){return null}_produceOriginalFromDiff(e,i,t){return t>i?{afterLineNumber:Math.max(e.originalStartLineNumber,e.originalEndLineNumber),heightInLines:t-i,domNode:null}:null}_produceModifiedFromDiff(e,i,t){return i>t?{afterLineNumber:Math.max(e.modifiedStartLineNumber,e.modifiedEndLineNumber),heightInLines:i-t,domNode:null}:null}}class me extends de{constructor(e,i){super(e),this._decorationsLeft=e.getOriginalEditor().getLayoutInfo().decorationsLeft,this._register(e.getOriginalEditor().onDidLayoutChange((i=>{this._decorationsLeft!==i.decorationsLeft&&(this._decorationsLeft=i.decorationsLeft,e.relayoutEditors())})))}setEnableSplitViewResizing(e){}_getViewZones(e,i,t,n){const o=this._dataSource.getOriginalEditor(),s=this._dataSource.getModifiedEditor(),r=new fe(e,i,t,o,s,n);return r.getViewZones()}_getOriginalEditorDecorations(e,i,t,n){const o=String(this._removeColor),s={decorations:[],overviewZones:[]},r=this._dataSource.getOriginalEditor(),d=r.getModel(),a=r._getViewModel();let l=0;for(const h of i)if(ve(h)){s.decorations.push({range:new N.e(h.originalStartLineNumber,1,h.originalEndLineNumber,1073741824),options:ce.lineDeleteMargin});while(l<e.modified.length){const i=e.modified[l];if(i.diff&&i.diff.originalStartLineNumber>=h.originalStartLineNumber)break;l++}let i=0;if(l<e.modified.length){const t=e.modified[l];t.diff&&t.diff.originalStartLineNumber===h.originalStartLineNumber&&t.diff.originalEndLineNumber===h.originalEndLineNumber&&t.diff.modifiedStartLineNumber===h.modifiedStartLineNumber&&t.diff.modifiedEndLineNumber===h.modifiedEndLineNumber&&(i=t.heightInLines)}const t=Le(d,a,h.originalStartLineNumber,h.originalEndLineNumber);s.overviewZones.push(new k.EY(t.startLineNumber,t.endLineNumber,i,o))}return s}_getModifiedEditorDecorations(e,i,t,n,o){const s=this._dataSource.getModifiedEditor(),r=String(this._insertColor),d={decorations:[],overviewZones:[]},a=s.getModel(),l=s._getViewModel();for(const h of i)if(pe(h)){d.decorations.push({range:new N.e(h.modifiedStartLineNumber,1,h.modifiedEndLineNumber,1073741824),options:n?ce.lineInsertWithSign:ce.lineInsert});const e=Le(a,l,h.modifiedStartLineNumber,h.modifiedEndLineNumber);if(d.overviewZones.push(new k.EY(e.startLineNumber,e.endLineNumber,0,r)),h.charChanges){for(const i of h.charChanges)if(be(i))if(t)for(let e=i.modifiedStartLineNumber;e<=i.modifiedEndLineNumber;e++){let t,n;t=e===i.modifiedStartLineNumber?i.modifiedStartColumn:a.getLineFirstNonWhitespaceColumn(e),n=e===i.modifiedEndLineNumber?i.modifiedEndColumn:a.getLineLastNonWhitespaceColumn(e),d.decorations.push(he(e,t,e,n,ce.charInsert))}else d.decorations.push(he(i.modifiedStartLineNumber,i.modifiedStartColumn,i.modifiedEndLineNumber,i.modifiedEndColumn,ce.charInsert))}else d.decorations.push(he(h.modifiedStartLineNumber,1,h.modifiedEndLineNumber,1073741824,ce.charInsertWholeLine))}return d}layout(){return Math.max(5,this._decorationsLeft)}}class fe extends le{constructor(e,i,t,n,o,s){super(e,i,t,n,o),this._originalModel=n.getModel(),this._renderIndicators=s,this._pendingLineChange=[],this._pendingViewZones=[],this._lineBreaksComputer=this._modifiedEditor._getViewModel().createLineBreaksComputer()}getViewZones(){const e=super.getViewZones();return this._finalize(e),e}_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion(){const e=document.createElement("div");return e.className="inline-added-margin-view-zone",e}_produceOriginalFromDiff(e,i,t){const n=document.createElement("div");return n.className="inline-added-margin-view-zone",{afterLineNumber:Math.max(e.originalStartLineNumber,e.originalEndLineNumber),heightInLines:t,domNode:document.createElement("div"),marginDomNode:n}}_produceModifiedFromDiff(e,i,t){const n=document.createElement("div");n.className=`view-lines line-delete ${r.S}`;const o=document.createElement("div");o.className="inline-deleted-margin-view-zone";const s={shouldNotShrink:!0,afterLineNumber:0===e.modifiedEndLineNumber?e.modifiedStartLineNumber:e.modifiedStartLineNumber-1,heightInLines:i,minWidthInPx:0,domNode:n,marginDomNode:o,diff:{originalStartLineNumber:e.originalStartLineNumber,originalEndLineNumber:e.originalEndLineNumber,modifiedStartLineNumber:e.modifiedStartLineNumber,modifiedEndLineNumber:e.modifiedEndLineNumber,originalModel:this._originalModel,viewLineCounts:null}};for(let r=e.originalStartLineNumber;r<=e.originalEndLineNumber;r++)this._lineBreaksComputer.addRequest(this._originalModel.getLineContent(r),null,null);return this._pendingLineChange.push(e),this._pendingViewZones.push(s),s}_finalize(e){const i=this._modifiedEditor.getOptions(),t=this._modifiedEditor.getModel().getOptions().tabSize,n=i.get(49),o=i.get(32),s=n.typicalHalfwidthCharacterWidth,r=i.get(102),d=this._originalModel.mightContainNonBasicASCII(),a=this._originalModel.mightContainRTL(),l=i.get(65),h=i.get(142),c=h.decorationsWidth,g=i.get(115),u=i.get(97),m=i.get(92),f=i.get(50),p=this._lineBreaksComputer.finalize();let v=0;for(let b=0;b<this._pendingLineChange.length;b++){const i=this._pendingLineChange[b],h=this._pendingViewZones[b],w=h.domNode;(0,_.N)(w,n);const C=h.marginDomNode;(0,_.N)(C,n);const D=[];if(i.charChanges)for(const e of i.charChanges)we(e)&&D.push(new H.$t(new N.e(e.originalStartLineNumber,e.originalStartColumn,e.originalEndLineNumber,e.originalEndColumn),"char-delete",0));const L=D.length>0,E=new O.HT(1e4);let S=0,y=0,R=null;for(let s=i.originalStartLineNumber;s<=i.originalEndLineNumber;s++){const r=s-i.originalStartLineNumber,_=this._originalModel.tokenization.getLineTokens(s),b=_.getLineContent(),w=p[v++],N=A.Kp.filter(D,s,1,b.length+1);if(w){let i=0;for(const e of w.breakOffsets){const s=_.sliceAndInflate(i,e,0),r=b.substring(i,e);S=Math.max(S,this._renderOriginalLine(y++,r,s,A.Kp.extractWrapped(N,i,e),L,d,a,n,o,l,c,g,u,m,f,t,E,C)),i=e}R||(R=[]);while(R.length<r)R[R.length]=1;R[r]=w.breakOffsets.length,h.heightInLines+=w.breakOffsets.length-1;const p=document.createElement("div");p.className="gutter-delete",e.original.push({afterLineNumber:s,afterColumn:0,heightInLines:w.breakOffsets.length-1,domNode:Ce(),marginDomNode:p})}else S=Math.max(S,this._renderOriginalLine(y++,b,_,N,L,d,a,n,o,l,c,g,u,m,f,t,E,C))}S+=r;const M=E.build(),I=oe?oe.createHTML(M):M;if(w.innerHTML=I,h.minWidthInPx=S*s,R){const e=i.originalEndLineNumber-i.originalStartLineNumber;while(R.length<=e)R[R.length]=1}h.diff.viewLineCounts=R}e.original.sort(((e,i)=>e.afterLineNumber-i.afterLineNumber))}_renderOriginalLine(e,i,t,n,o,s,r,d,a,l,h,c,g,u,m,_,p,v){p.appendString('<div class="view-line'),o||p.appendString(" char-delete"),p.appendString('" style="top:'),p.appendString(String(e*l)),p.appendString('px;width:1000000px;">');const b=H.wA.isBasicASCII(i,s),w=H.wA.containsRTL(i,b,r),C=(0,F.d1)(new F.IJ(d.isMonospace&&!a,d.canUseHalfwidthRightwardsArrow,i,!1,b,w,0,t,n,_,0,d.spaceWidth,d.middotWidth,d.wsmiddotWidth,c,g,u,m!==T.n0.OFF,null),p);if(p.appendString("</div>"),this._renderIndicators){const i=document.createElement("div");i.className=`delete-sign ${f.k.asClassName(ne)}`,i.setAttribute("style",`position:absolute;top:${e*l}px;width:${h}px;height:${l}px;right:0;`),v.appendChild(i)}return C.characterMapping.getHorizontalOffset(C.characterMapping.length)}}function _e(e,i){return(0,T.NY)(e,i,["off","on","inherit"])}function pe(e){return e.modifiedEndLineNumber>0}function ve(e){return e.originalEndLineNumber>0}function be(e){return e.modifiedStartLineNumber===e.modifiedEndLineNumber?e.modifiedEndColumn-e.modifiedStartColumn>0:e.modifiedEndLineNumber-e.modifiedStartLineNumber>0}function we(e){return e.originalStartLineNumber===e.originalEndLineNumber?e.originalEndColumn-e.originalStartColumn>0:e.originalEndLineNumber-e.originalStartLineNumber>0}function Ce(){const e=document.createElement("div");return e.className="diagonal-fill",e}function De(){const e=document.createElement("div");return e.className="arrow-revert-change "+f.k.asClassName(h.l.arrowRight),n.$("div",{},e)}function Le(e,i,t,n){const o=e.getLineCount();return t=Math.min(o,Math.max(1,t)),n=Math.min(o,Math.max(1,n)),i.coordinatesConverter.convertModelRangeToViewRange(new N.e(t,e.getLineMinColumn(t),n,e.getLineMaxColumn(n)))}function Ee(e,i){return{enableSplitViewResizing:(0,T.O7)(e.enableSplitViewResizing,i.enableSplitViewResizing),splitViewDefaultRatio:(0,T.L_)(e.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:(0,T.O7)(e.renderSideBySide,i.renderSideBySide),renderMarginRevertIcon:(0,T.O7)(e.renderMarginRevertIcon,i.renderMarginRevertIcon),maxComputationTime:(0,T.Zc)(e.maxComputationTime,i.maxComputationTime,0,1073741824),maxFileSize:(0,T.Zc)(e.maxFileSize,i.maxFileSize,0,1073741824),ignoreTrimWhitespace:(0,T.O7)(e.ignoreTrimWhitespace,i.ignoreTrimWhitespace),renderIndicators:(0,T.O7)(e.renderIndicators,i.renderIndicators),originalEditable:(0,T.O7)(e.originalEditable,i.originalEditable),diffCodeLens:(0,T.O7)(e.diffCodeLens,i.diffCodeLens),renderOverviewRuler:(0,T.O7)(e.renderOverviewRuler,i.renderOverviewRuler),diffWordWrap:_e(e.diffWordWrap,i.diffWordWrap),diffAlgorithm:(0,T.NY)(e.diffAlgorithm,i.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:(0,T.O7)(e.accessibilityVerbose,i.accessibilityVerbose),experimental:{collapseUnchangedRegions:!1},isInEmbeddedEditor:(0,T.O7)(e.isInEmbeddedEditor,i.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:!1}}function Se(e,i){return{enableSplitViewResizing:e.enableSplitViewResizing!==i.enableSplitViewResizing,renderSideBySide:e.renderSideBySide!==i.renderSideBySide,renderMarginRevertIcon:e.renderMarginRevertIcon!==i.renderMarginRevertIcon,maxComputationTime:e.maxComputationTime!==i.maxComputationTime,maxFileSize:e.maxFileSize!==i.maxFileSize,ignoreTrimWhitespace:e.ignoreTrimWhitespace!==i.ignoreTrimWhitespace,renderIndicators:e.renderIndicators!==i.renderIndicators,originalEditable:e.originalEditable!==i.originalEditable,diffCodeLens:e.diffCodeLens!==i.diffCodeLens,renderOverviewRuler:e.renderOverviewRuler!==i.renderOverviewRuler,diffWordWrap:e.diffWordWrap!==i.diffWordWrap,diffAlgorithm:e.diffAlgorithm!==i.diffAlgorithm,accessibilityVerbose:e.accessibilityVerbose!==i.accessibilityVerbose}}(0,G.Ic)(((e,i)=>{const t=e.getColor(Q.L_t);i.addRule(`\n\t.monaco-editor .diagonal-fill {\n\t\tbackground-image: linear-gradient(\n\t\t\t-45deg,\n\t\t\t${t} 12.5%,\n\t\t\t#0000 12.5%, #0000 50%,\n\t\t\t${t} 50%, ${t} 62.5%,\n\t\t\t#0000 62.5%, #0000 100%\n\t\t);\n\t\tbackground-size: 8px 8px;\n\t}\n\t`)}))},22767:(e,i,t)=>{t.d(i,{z:()=>ki});var n=t(76526),o=t(746),s=t(21813),r=t(72180),d=t(23527),a=t(31987),l=t(34705),h=t(67641),c=t(22035),g=t(58548),u=t(52644),m=t(39812),f=t(11164),_=t(62407),p=t(35285),v=t(71593),b=t(76601),w=t(8443);const C=(0,w.q5)("diff-insert",f.l.add,(0,b.NC)("diffInsertIcon","Line decoration for inserts in the diff editor.")),D=(0,w.q5)("diff-remove",f.l.remove,(0,b.NC)("diffRemoveIcon","Line decoration for removals in the diff editor.")),L=v.qx.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+p.k.asClassName(C),marginClassName:"gutter-insert"}),E=v.qx.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+p.k.asClassName(D),marginClassName:"gutter-delete"}),S=v.qx.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),N=v.qx.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),y=v.qx.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),R=v.qx.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),M=v.qx.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),I=v.qx.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),T=v.qx.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),x=v.qx.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"}),O=v.qx.register({description:"diff-editor-arrow-revert-change",glyphMarginHoverMessage:new _.W5(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown((0,b.NC)("revertChangeHoverMessage","Click to revert change")),glyphMarginClassName:"arrow-revert-change "+p.k.asClassName(f.l.arrowRight),zIndex:10001});class V extends u.JT{constructor(e,i,t,n,o){super(),this._rootElement=e,this._diffModel=i,this._originalEditorLayoutInfo=t,this._modifiedEditorLayoutInfo=n,this._editors=o;const s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(s),this._register((0,r.EH)("update",(e=>{const i=this._originalEditorLayoutInfo.read(e),t=this._modifiedEditorLayoutInfo.read(e);i&&t&&(s.style.left=i.width-i.verticalScrollbarWidth+"px",s.style.height=`${i.height}px`,s.style.width=i.verticalScrollbarWidth+i.contentLeft-V.movedCodeBlockPadding+"px")})));const d=(0,r.rD)(this._editors.original.onDidScrollChange,(()=>this._editors.original.getScrollTop())),a=(0,r.rD)(this._editors.modified.onDidScrollChange,(()=>this._editors.modified.getScrollTop())),l=(0,r.aq)("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones);this._register((0,r.EH)("update",(e=>{var i,t;s.replaceChildren(),l.read(e);const n=this._originalEditorLayoutInfo.read(e),o=this._modifiedEditorLayoutInfo.read(e);if(!n||!o)return;const r=n.verticalScrollbarWidth+n.contentLeft-V.movedCodeBlockPadding,h=null===(t=null===(i=this._diffModel.read(e))||void 0===i?void 0:i.diff.read(e))||void 0===t?void 0:t.movedTexts;if(!h)return;let c=0;for(const g of h){function u(e,i){const t=i.getTopForLineNumber(e.startLineNumber),n=i.getTopForLineNumber(e.endLineNumberExclusive);return(t+n)/2}const m=u(g.lineRangeMapping.original,this._editors.original),f=d.read(e),_=u(g.lineRangeMapping.modified,this._editors.modified),p=a.read(e),v=m-f,b=_-p,w=r/2-5*h.length+10*c;c++;const C=document.createElementNS("http://www.w3.org/2000/svg","path");C.setAttribute("d",`M 0 ${v} L ${w} ${v} L ${w} ${b} L ${r} ${b}`),C.setAttribute("fill","none"),s.appendChild(C)}})))}}V.movedCodeBlockPadding=4;var P=t(54775);function W(e,i,t,n){if(0===e.length)return i;if(0===i.length)return e;const o=[];let s=0,r=0;while(s<e.length&&r<i.length){const d=e[s],a=i[r],l=t(d),h=t(a);l<h?(o.push(d),s++):l>h?(o.push(a),r++):(o.push(n(d,a)),s++,r++)}while(s<e.length)o.push(e[s]),s++;while(r<i.length)o.push(i[r]),r++;return o}function A(e,i){const t=new u.SL,n=e.createDecorationsCollection();return t.add((0,r.EH)(`Apply decorations from ${i.debugName}`,(e=>{const t=i.read(e);n.set(t)}))),t.add({dispose:()=>{n.clear()}}),t}function F(e,i){return e.appendChild(i),(0,u.OF)((()=>{e.removeChild(i)}))}class H extends u.JT{get width(){return this._width}get height(){return this._height}constructor(e,i){super(),this.elementSizeObserver=this._register(new P.I(e,i)),this._width=(0,r.uh)("width",this.elementSizeObserver.getWidth()),this._height=(0,r.uh)("height",this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange((e=>(0,r.PS)((e=>{this._width.set(this.elementSizeObserver.getWidth(),e),this._height.set(this.elementSizeObserver.getHeight(),e)})))))}observe(e){this.elementSizeObserver.observe(e)}setAutomaticLayout(e){e?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}}function k(e,i){let t=e.get(),n=t,o=t;const s=(0,r.uh)("animatedValue",t);let d=-1;const a=300;let l;function h(){const e=Date.now()-d;o=Math.floor(z(e,n,t-n,a)),e<a?l=requestAnimationFrame(h):o=t,s.set(o,void 0)}return i.add((0,r.nJ)("update value",{createEmptyChangeSummary:()=>({animate:!1}),handleChange:(i,t)=>(i.didChange(e)&&(t.animate=t.animate||i.change),!0)},((i,s)=>{void 0!==l&&(cancelAnimationFrame(l),l=void 0),n=o,t=e.read(i),d=Date.now()-(s.animate?0:a),h()}))),s}function z(e,i,t,n){return e===n?i+t:t*(1-Math.pow(2,-10*e/n))+i}class B extends u.JT{constructor(e,i,t){super(),this._register(new Z(e,t)),this._register(K(t,{height:i.actualHeight,top:i.actualTop}))}}class U{get afterLineNumber(){return this._afterLineNumber.get()}constructor(e,i){this._afterLineNumber=e,this.heightInPx=i,this.domNode=document.createElement("div"),this._actualTop=(0,r.uh)("actualTop",void 0),this._actualHeight=(0,r.uh)("actualHeight",void 0),this.actualTop=this._actualTop,this.actualHeight=this._actualHeight,this.showInHiddenAreas=!0,this.onChange=this._afterLineNumber,this.onDomNodeTop=e=>{this._actualTop.set(e,void 0)},this.onComputedHeight=e=>{this._actualHeight.set(e,void 0)}}}class Z{constructor(e,i){this._editor=e,this._domElement=i,this._overlayWidgetId="managedOverlayWidget-"+Z._counter++,this._overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null},this._editor.addOverlayWidget(this._overlayWidget)}dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}}function K(e,i){return(0,r.EH)("applyStyle",(t=>{for(let[n,o]of Object.entries(i))o&&"object"===typeof o&&"read"in o&&(o=o.read(t)),"number"===typeof o&&(o=`${o}px`),e.style[n]=o}))}function j(e,i){return q([e],i),e}function q(e,i){const t=globalThis.$hotReload_deprecateExports;if(!t)return;const n=(0,r.aq)("reload",(i=>{function n(t,n){return!![...Object.values(t)].some((i=>e.includes(i)))&&(i(void 0),!0)}return t.add(n),{dispose(){t.delete(n)}}}));n.read(i)}function Q(e,i,t){const n=new u.SL,o=[];return n.add((0,r.EH)("applyViewZones",(s=>{const d=i.read(s),a=new Map,l=new Map;t&&t(!0),e.changeViewZones((e=>{for(const i of o)e.removeZone(i);o.length=0;for(const i of d){const t=e.addZone(i);o.push(t),a.set(i,t)}})),t&&t(!1),n.add((0,r.nJ)("layoutZone on change",{createEmptyChangeSummary(){return[]},handleChange(e,i){const t=l.get(e.changedObservable);return void 0!==t&&i.push(t),!0}},((i,n)=>{for(const e of d)e.onChange&&(l.set(e.onChange,a.get(e)),e.onChange.read(i));t&&t(!0),e.changeViewZones((e=>{for(const i of n)e.layoutZone(i)})),t&&t(!1)})))}))),n.add({dispose(){t&&t(!0),e.changeViewZones((e=>{for(const i of o)e.removeZone(i)})),t&&t(!1)}}),n}Z._counter=0;var $=t(42748),G=t(8655),J=t(81524);class X extends u.JT{constructor(e,i,t){super(),this._editors=e,this._diffModel=i,this._options=t,this._decorations=(0,r.nK)("decorations",(e=>{var i;const t=null===(i=this._diffModel.read(e))||void 0===i?void 0:i.diff.read(e);if(!t)return null;const n=this._diffModel.read(e).syncedMovedTexts.read(e),o=this._options.renderIndicators.read(e),s=this._options.showEmptyDecorations.read(e),r=[],d=[];for(const a of t.mappings){const i=$.z.subtract(a.lineRangeMapping.originalRange,null===n||void 0===n?void 0:n.lineRangeMapping.original).map((e=>e.toInclusiveRange())).filter(m.$K);for(const e of i)r.push({range:e,options:o?E:N});const t=$.z.subtract(a.lineRangeMapping.modifiedRange,null===n||void 0===n?void 0:n.lineRangeMapping.modified).map((e=>e.toInclusiveRange())).filter(m.$K);for(const e of t)d.push({range:e,options:o?L:S});if(a.lineRangeMapping.modifiedRange.isEmpty||a.lineRangeMapping.originalRange.isEmpty){for(const e of i)r.push({range:e,options:T});for(const e of t)d.push({range:e,options:R})}else for(const e of a.lineRangeMapping.innerChanges||[])n&&(n.lineRangeMapping.original.intersect(new $.z(e.originalRange.startLineNumber,e.originalRange.endLineNumber))||n.lineRangeMapping.modified.intersect(new $.z(e.modifiedRange.startLineNumber,e.modifiedRange.endLineNumber)))||(a.lineRangeMapping.originalRange.contains(e.originalRange.startLineNumber)&&r.push({range:e.originalRange,options:e.originalRange.isEmpty()&&s?x:I}),a.lineRangeMapping.modifiedRange.contains(e.modifiedRange.startLineNumber)&&d.push({range:e.modifiedRange,options:e.modifiedRange.isEmpty()&&s?M:y}));a.lineRangeMapping.modifiedRange.isEmpty||!this._options.shouldRenderRevertArrows.read(e)||n||d.push({range:J.e.fromPositions(new G.L(a.lineRangeMapping.modifiedRange.startLineNumber,1)),options:O})}if(n)for(const a of n.changes){const e=a.originalRange.toInclusiveRange();e&&r.push({range:e,options:o?E:N});const i=a.modifiedRange.toInclusiveRange();i&&d.push({range:i,options:o?L:S});for(const t of a.innerChanges||[])r.push({range:t.originalRange,options:I}),d.push({range:t.modifiedRange,options:y})}for(const a of t.movedTexts)r.push({range:a.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal",blockPadding:[V.movedCodeBlockPadding,0,V.movedCodeBlockPadding,V.movedCodeBlockPadding]}}),d.push({range:a.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified",blockPadding:[4,0,4,4]}});return{originalDecorations:r,modifiedDecorations:d}})),this._register(A(this._editors.original,this._decorations.map((e=>(null===e||void 0===e?void 0:e.originalDecorations)||[])))),this._register(A(this._editors.modified,this._decorations.map((e=>(null===e||void 0===e?void 0:e.modifiedDecorations)||[]))))}}var Y=t(39981);class ee extends u.JT{constructor(e,i,t){super(),this._options=e,this._domNode=i,this._dimensions=t,this._sashRatio=(0,r.uh)("sashRatio",void 0),this.sashLeft=(0,r.nK)("sashLeft",(e=>{var i;const t=null!==(i=this._sashRatio.read(e))&&void 0!==i?i:this._options.splitViewDefaultRatio.read(e);return this._computeSashLeft(t,e)})),this._sash=this._register(new Y.g(this._domNode,{getVerticalSashTop:e=>0,getVerticalSashLeft:e=>this.sashLeft.get(),getVerticalSashHeight:e=>this._dimensions.height.get()},{orientation:0})),this._startSashPosition=void 0,this._register(this._sash.onDidStart((()=>{this._startSashPosition=this.sashLeft.get()}))),this._register(this._sash.onDidChange((e=>{const i=this._dimensions.width.get(),t=this._computeSashLeft((this._startSashPosition+(e.currentX-e.startX))/i,void 0);this._sashRatio.set(t/i,void 0)}))),this._register(this._sash.onDidEnd((()=>this._sash.layout()))),this._register(this._sash.onDidReset((()=>this._sashRatio.set(void 0,void 0)))),this._register((0,r.EH)("update sash layout",(e=>{const i=this._options.enableSplitViewResizing.read(e);this._sash.state=i?3:0,this.sashLeft.read(e),this._sash.layout()})))}setBoundarySashes(e){this._sash.orthogonalEndSash=e.bottom}_computeSashLeft(e,i){const t=this._dimensions.width.read(i),n=Math.floor(this._options.splitViewDefaultRatio.read(i)*t),o=this._options.enableSplitViewResizing.read(i)?Math.floor(e*t):n,s=100;return t<=2*s?n:o<s?s:o>t-s?t-s:o}}var ie=t(83247),te=t(57171),ne=t(36330),oe=t(38423),se=t(50619),re=t(74936),de=t(45282),ae=t(51211),le=t(64088),he=function(e,i,t,n){function o(e){return e instanceof t?e:new t((function(i){i(e)}))}return new(t||(t=Promise))((function(t,s){function r(e){try{a(n.next(e))}catch(i){s(i)}}function d(e){try{a(n["throw"](e))}catch(i){s(i)}}function a(e){e.done?t(e.value):o(e.value).then(r,d)}a((n=n.apply(e,i||[])).next())}))};class ce extends u.JT{constructor(e,i,t){super(),this.model=e,this._options=i,this._isDiffUpToDate=(0,r.uh)("isDiffUpToDate",!1),this.isDiffUpToDate=this._isDiffUpToDate,this._diff=(0,r.uh)("diff",void 0),this.diff=this._diff,this._unchangedRegions=(0,r.uh)("unchangedRegion",{regions:[],originalDecorationIds:[],modifiedDecorationIds:[]}),this.unchangedRegions=(0,r.nK)("unchangedRegions",(e=>this._options.collapseUnchangedRegions.read(e)?this._unchangedRegions.read(e).regions:((0,r.PS)((e=>{for(const i of this._unchangedRegions.get().regions)i.setState(0,0,e)})),[]))),this.syncedMovedTexts=(0,r.uh)("syncedMovedText",void 0);const n=(0,r.GN)("contentChangedSignal"),o=this._register(new te.pY((()=>n.trigger(void 0)),200)),s=(i,t)=>{const n=me.fromDiffs(i.changes,e.original.getLineCount(),e.modified.getLineCount()),o=this._unchangedRegions.get(),s=o.originalDecorationIds.map((i=>e.original.getDecorationRange(i))).filter((e=>!!e)).map((e=>$.z.fromRange(e))),r=o.modifiedDecorationIds.map((i=>e.modified.getDecorationRange(i))).filter((e=>!!e)).map((e=>$.z.fromRange(e))),d=e.original.deltaDecorations(o.originalDecorationIds,n.map((e=>({range:e.originalRange.toInclusiveRange(),options:{description:"unchanged"}})))),a=e.modified.deltaDecorations(o.modifiedDecorationIds,n.map((e=>({range:e.modifiedRange.toInclusiveRange(),options:{description:"unchanged"}}))));for(const e of n)for(let i=0;i<o.regions.length;i++)if(e.originalRange.intersectsStrict(s[i])&&e.modifiedRange.intersectsStrict(r[i])){e.setHiddenModifiedRange(o.regions[i].getHiddenModifiedRange(void 0),t);break}this._unchangedRegions.set({regions:n,originalDecorationIds:d,modifiedDecorationIds:a},t)};this._register(e.modified.onDidChangeContent((i=>{const t=this._diff.get();if(!t)return;const n=de.Q.fromModelContentChanges(i.changes),d=pe(this._lastDiff,n,e.original,e.modified);d&&(this._lastDiff=d,(0,r.PS)((e=>{this._diff.set(ge.fromDiffResult(this._lastDiff),e),s(d,e);const i=this.syncedMovedTexts.get();this.syncedMovedTexts.set(i?this._lastDiff.moves.find((e=>e.lineRangeMapping.modified.intersect(i.lineRangeMapping.modified))):void 0,e)}))),o.schedule()}))),this._register(e.original.onDidChangeContent((i=>{const t=this._diff.get();if(!t)return;const n=de.Q.fromModelContentChanges(i.changes),d=fe(this._lastDiff,n,e.original,e.modified);d&&(this._lastDiff=d,(0,r.PS)((e=>{this._diff.set(ge.fromDiffResult(this._lastDiff),e),s(d,e);const i=this.syncedMovedTexts.get();this.syncedMovedTexts.set(i?this._lastDiff.moves.find((e=>e.lineRangeMapping.modified.intersect(i.lineRangeMapping.modified))):void 0,e)}))),o.schedule()})));const a=(0,r.aq)("documentDiffProviderOptionChanged",t.onDidChange);this._register((0,d.b2)("compute diff",((i,d)=>he(this,void 0,void 0,(function*(){var l,h;o.cancel(),n.read(i),a.read(i),this._isDiffUpToDate.set(!1,void 0);let c=[];d.add(e.original.onDidChangeContent((e=>{const i=de.Q.fromModelContentChanges(e.changes);c=(0,ae.o)(c,i)})));let g=[];d.add(e.modified.onDidChangeContent((e=>{const i=de.Q.fromModelContentChanges(e.changes);g=(0,ae.o)(g,i)})));let u=yield t.computeDiff(e.original,e.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(i),maxComputationTimeMs:this._options.maxComputationTimeMs.read(i),computeMoves:this._options.showMoves.read(i)});u=null!==(l=fe(u,c,e.original,e.modified))&&void 0!==l?l:u,u=null!==(h=pe(u,g,e.original,e.modified))&&void 0!==h?h:u,(0,r.PS)((e=>{s(u,e),this._lastDiff=u;const i=ge.fromDiffResult(u);this._diff.set(i,e),this._isDiffUpToDate.set(!0,e);const t=this.syncedMovedTexts.get();this.syncedMovedTexts.set(t?this._lastDiff.moves.find((e=>e.lineRangeMapping.modified.intersect(t.lineRangeMapping.modified))):void 0,e)}))})))))}ensureModifiedLineIsVisible(e,i){var t;if(0===(null===(t=this.diff.get())||void 0===t?void 0:t.mappings.length))return;const n=this._unchangedRegions.get().regions;for(const o of n)if(o.getHiddenModifiedRange(void 0).contains(e))return void o.showAll(i)}ensureOriginalLineIsVisible(e,i){var t;if(0===(null===(t=this.diff.get())||void 0===t?void 0:t.mappings.length))return;const n=this._unchangedRegions.get().regions;for(const o of n)if(o.getHiddenOriginalRange(void 0).contains(e))return void o.showAll(i)}waitForDiff(){return he(this,void 0,void 0,(function*(){yield(0,r.F_)(this.isDiffUpToDate,(e=>e))}))}serializeState(){const e=this._unchangedRegions.get();return{collapsedRegions:e.regions.map((e=>({range:e.getHiddenModifiedRange(void 0).serialize()})))}}restoreSerializedState(e){const i=e.collapsedRegions.map((e=>$.z.deserialize(e.range))),t=this._unchangedRegions.get();(0,r.PS)((e=>{for(const n of t.regions)for(const t of i)if(n.modifiedRange.intersect(t)){n.setHiddenModifiedRange(t,e);break}}))}}class ge{static fromDiffResult(e){return new ge(e.changes.map((e=>new ue(e))),e.moves||[],e.identical,e.quitEarly)}constructor(e,i,t,n){this.mappings=e,this.movedTexts=i,this.identical=t,this.quitEarly=n}}class ue{constructor(e){this.lineRangeMapping=e}}class me{static fromDiffs(e,i,t){const n=se.f0.inverse(e,i,t),o=[],s=3,r=3;for(const d of n){let e=d.originalRange.startLineNumber,n=d.modifiedRange.startLineNumber,a=d.originalRange.length;const l=1===e&&1===n,h=e+a===i+1&&n+a===t+1;(l||h)&&a>r+s?(l&&!h&&(a-=r),h&&!l&&(e+=r,n+=r,a-=r),o.push(new me(e,n,a,0,0))):a>2*r+s&&(e+=r,n+=r,a-=2*r,o.push(new me(e,n,a,0,0)))}return o}get originalRange(){return $.z.ofLength(this.originalLineNumber,this.lineCount)}get modifiedRange(){return $.z.ofLength(this.modifiedLineNumber,this.lineCount)}constructor(e,i,t,n,o){this.originalLineNumber=e,this.modifiedLineNumber=i,this.lineCount=t,this._visibleLineCountTop=(0,r.uh)("visibleLineCountTop",0),this.visibleLineCountTop=this._visibleLineCountTop,this._visibleLineCountBottom=(0,r.uh)("visibleLineCountBottom",0),this.visibleLineCountBottom=this._visibleLineCountBottom,this._shouldHideControls=(0,r.nK)("isVisible",(e=>this.visibleLineCountTop.read(e)+this.visibleLineCountBottom.read(e)===this.lineCount&&!this.isDragged.read(e))),this.isDragged=(0,r.uh)("isDragged",!1),this._visibleLineCountTop.set(n,void 0),this._visibleLineCountBottom.set(o,void 0)}shouldHideControls(e){return this._shouldHideControls.read(e)}getHiddenOriginalRange(e){return $.z.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}getHiddenModifiedRange(e){return $.z.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}setHiddenModifiedRange(e,i){const t=e.startLineNumber-this.modifiedLineNumber,n=this.modifiedLineNumber+this.lineCount-e.endLineNumberExclusive;this.setState(t,n,i)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(e=10,i){const t=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+e,t),i)}showMoreBelow(e=10,i){const t=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+e,t),i)}showAll(e){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),e)}setState(e,i,t){e=Math.max(Math.min(e,this.lineCount),0),i=Math.max(Math.min(i,this.lineCount-e),0),this._visibleLineCountTop.set(e,t),this._visibleLineCountBottom.set(i,t)}}function fe(e,i,t,n){if(0===i.length)return e;const o=_e(e),s=pe(o,i,n,t);return s?_e(s):void 0}function _e(e){return{changes:e.changes.map((e=>e.flip())),moves:e.moves.map((e=>e.flip())),identical:e.identical,quitEarly:e.quitEarly}}function pe(e,i,t,n){if(0===i.length)return e;if(e.changes.some((e=>!e.innerChanges))||e.moves.length>0)return;const o=be(e.changes,i,t,n),s=e.moves.map((e=>{const o=ve(e.lineRangeMapping.modified,i);return o?new se.y0(new se.Qy(e.lineRangeMapping.original,o),be(e.changes,i,t,n)):void 0})).filter(m.$K);return{identical:!1,quitEarly:!1,changes:o,moves:s}}function ve(e,i){let t=e.startLineNumber,n=e.endLineNumberExclusive;for(let o=i.length-1;o>=0;o--){const e=i[o],s=(0,le.W9)(e.startOffset)+1,r=(0,le.W9)(e.endOffset)+1,d=(0,le.W9)(e.newLength),a=d-(r-s);if(r<t)t+=a,n+=a;else if(s>n);else{if(s<t&&n<r)return;s<t&&r<=n?(t=r+1,t+=a,n+=a):t<=s&&r<t?n=s:n+=a}}return new $.z(t,n)}function be(e,i,t,n){const o=e.flatMap((e=>e.innerChanges.map((e=>new de.Q((0,le.PZ)(e.originalRange.getStartPosition()),(0,le.PZ)(e.originalRange.getEndPosition()),(0,le.Uv)(e.modifiedRange).toLength()))))),s=(0,ae.o)(o,i);let r=le.xl,d=le.xl;const a=s.map((e=>{const i=(0,le.Ii)(d,(0,le.BE)(r,e.startOffset));return r=e.endOffset,d=(0,le.Ii)(i,e.newLength),new se.iy(J.e.fromPositions((0,le.bP)(e.startOffset),(0,le.bP)(e.endOffset)),J.e.fromPositions((0,le.bP)(i),(0,le.bP)(d)))})),l=(0,re.v)(a,t.getLinesContent(),n.getLinesContent());return l}var we=t(31434),Ce=t(26145),De=function(e,i,t,n){function o(e){return e instanceof t?e:new t((function(i){i(e)}))}return new(t||(t=Promise))((function(t,s){function r(e){try{a(n.next(e))}catch(i){s(i)}}function d(e){try{a(n["throw"](e))}catch(i){s(i)}}function a(e){e.done?t(e.value):o(e.value).then(r,d)}a((n=n.apply(e,i||[])).next())}))};class Le extends u.JT{get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}constructor(e,i,t,o,s,r,d,a,l){super(),this._getViewZoneId=e,this._marginDomNode=i,this._modifiedEditor=t,this._diff=o,this._editor=s,this._viewLineCounts=r,this._originalTextModel=d,this._contextMenuService=a,this._clipboardService=l,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=p.k.asClassName(f.l.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const h=this._modifiedEditor.getOption(65);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${h}px`,this._diffActions.style.lineHeight=`${h}px`,this._marginDomNode.appendChild(this._diffActions);let c=0;const g=t.getOption(125)&&!Ce.gn,u=(e,i)=>{var n;this._contextMenuService.showContextMenu({domForShadowRoot:g&&null!==(n=t.getDomNode())&&void 0!==n?n:void 0,getAnchor:()=>({x:e,y:i}),getActions:()=>{const e=[],i=o.modifiedRange.isEmpty;e.push(new we.aU("diff.clipboard.copyDeletedContent",i?o.originalRange.length>1?(0,b.NC)("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):(0,b.NC)("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):o.originalRange.length>1?(0,b.NC)("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):(0,b.NC)("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,(()=>De(this,void 0,void 0,(function*(){const e=this._originalTextModel.getValueInRange(o.originalRange.toExclusiveRange());yield this._clipboardService.writeText(e)}))))),o.originalRange.length>1&&e.push(new we.aU("diff.clipboard.copyDeletedLineContent",i?(0,b.NC)("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",o.originalRange.startLineNumber+c):(0,b.NC)("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",o.originalRange.startLineNumber+c),void 0,!0,(()=>De(this,void 0,void 0,(function*(){let e=this._originalTextModel.getLineContent(o.originalRange.startLineNumber+c);if(""===e){const i=this._originalTextModel.getEndOfLineSequence();e=0===i?"\n":"\r\n"}yield this._clipboardService.writeText(e)})))));const n=t.getOption(89);return n||e.push(new we.aU("diff.inline.revertChange",(0,b.NC)("diff.inline.revertChange.label","Revert this change"),void 0,!0,(()=>De(this,void 0,void 0,(function*(){this._editor.revert(this._diff)}))))),e},autoSelectFirstItem:!0})};this._register((0,n.mu)(this._diffActions,"mousedown",(e=>{const{top:i,height:t}=(0,n.i)(this._diffActions),o=Math.floor(h/3);e.preventDefault(),u(e.posx,i+t+o)}))),this._register(t.onMouseMove((e=>{8!==e.target.type&&5!==e.target.type||e.target.detail.viewZoneId!==this._getViewZoneId()?this.visibility=!1:(c=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,h),this.visibility=!0)}))),this._register(t.onMouseDown((e=>{if(e.event.rightButton&&(8===e.target.type||5===e.target.type)){const i=e.target.detail.viewZoneId;i===this._getViewZoneId()&&(e.event.preventDefault(),c=this._updateLightBulbPosition(this._marginDomNode,e.event.browserEvent.y,h),u(e.event.posx,e.event.posy+h))}})))}_updateLightBulbPosition(e,i,t){const{top:o}=(0,n.i)(e),s=i-o,r=Math.floor(s/t),d=r*t;if(this._diffActions.style.top=`${d}px`,this._viewLineCounts){let e=0;for(let i=0;i<this._viewLineCounts.length;i++)if(e+=this._viewLineCounts[i],r<e)return i}return r}}var Ee=t(2510),Se=t(29065),Ne=t(44651),ye=t(62629),Re=t(65298),Me=t(37563);const Ie=Ee.N;function Te(e,i,t,n){(0,ne.N)(n,i.fontInfo);const o=t.length>0,s=new Ne.HT(1e4);let r=0,d=0;const a=[];for(let g=0;g<e.lineTokens.length;g++){const n=g+1,l=e.lineTokens[g],h=e.lineBreakData[g],c=ye.Kp.filter(t,n,1,Number.MAX_SAFE_INTEGER);if(h){let t=0;for(const n of h.breakOffsets){const a=l.sliceAndInflate(t,n,0);r=Math.max(r,Ve(d,a,ye.Kp.extractWrapped(c,t,n),o,e.mightContainNonBasicASCII,e.mightContainRTL,i,s)),d++,t=n}a.push(h.breakOffsets.length)}else a.push(1),r=Math.max(r,Ve(d,l,c,o,e.mightContainNonBasicASCII,e.mightContainRTL,i,s)),d++}r+=i.scrollBeyondLastColumn;const l=s.build(),h=Ie?Ie.createHTML(l):l;n.innerHTML=h;const c=r*i.typicalHalfwidthCharacterWidth;return{heightInLines:d,minWidthInPx:c,viewLineCounts:a}}class xe{constructor(e,i,t,n){this.lineTokens=e,this.lineBreakData=i,this.mightContainNonBasicASCII=t,this.mightContainRTL=n}}class Oe{static fromEditor(e){var i;const t=e.getOptions(),n=t.get(49),o=t.get(142);return new Oe((null===(i=e.getModel())||void 0===i?void 0:i.getOptions().tabSize)||0,n,t.get(32),n.typicalHalfwidthCharacterWidth,t.get(102),t.get(65),o.decorationsWidth,t.get(115),t.get(97),t.get(92),t.get(50))}constructor(e,i,t,n,o,s,r,d,a,l,h){this.tabSize=e,this.fontInfo=i,this.disableMonospaceOptimizations=t,this.typicalHalfwidthCharacterWidth=n,this.scrollBeyondLastColumn=o,this.lineHeight=s,this.lineDecorationsWidth=r,this.stopRenderingLineAfter=d,this.renderWhitespace=a,this.renderControlCharacters=l,this.fontLigatures=h}}function Ve(e,i,t,n,o,s,r,d){d.appendString('<div class="view-line'),n||d.appendString(" char-delete"),d.appendString('" style="top:'),d.appendString(String(e*r.lineHeight)),d.appendString('px;width:1000000px;">');const a=i.getLineContent(),l=Me.wA.isBasicASCII(a,o),h=Me.wA.containsRTL(a,l,s),c=(0,Re.d1)(new Re.IJ(r.fontInfo.isMonospace&&!r.disableMonospaceOptimizations,r.fontInfo.canUseHalfwidthRightwardsArrow,a,!1,l,h,0,i,t,r.tabSize,0,r.fontInfo.spaceWidth,r.fontInfo.middotWidth,r.fontInfo.wsmiddotWidth,r.stopRenderingLineAfter,r.renderWhitespace,r.renderControlCharacters,r.fontLigatures!==Se.n0.OFF,null),d);return d.appendString("</div>"),c.characterMapping.getHorizontalOffset(c.characterMapping.length)}var Pe=t(73738),We=t(46096),Ae=function(e,i,t,n){var o,s=arguments.length,r=s<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(i,t,r):o(i,t))||r);return s>3&&r&&Object.defineProperty(i,t,r),r},Fe=function(e,i){return function(t,n){i(t,n,e)}};let He=class extends u.JT{constructor(e,i,t,o,s,a,l){super(),this._editors=e,this._diffModel=i,this._options=t,this._diffEditorWidget=o,this._canIgnoreViewZoneUpdateEvent=s,this._clipboardService=a,this._contextMenuService=l,this._originalTopPadding=(0,r.uh)("originalTopPadding",0),this._originalScrollOffset=(0,r.uh)("originalScrollOffset",0),this._originalScrollOffsetAnimated=k(this._originalScrollOffset,this._store),this._modifiedTopPadding=(0,r.uh)("modifiedTopPadding",0),this._modifiedScrollOffset=(0,r.uh)("modifiedScrollOffset",0),this._modifiedScrollOffsetAnimated=k(this._modifiedScrollOffset,this._store);let h=!1;const c=(0,r.uh)("state",0),g=this._register(new te.pY((()=>{c.set(c.get()+1,void 0)}),0));this._register(this._editors.original.onDidChangeViewZones((e=>{h||this._canIgnoreViewZoneUpdateEvent()||g.schedule()}))),this._register(this._editors.modified.onDidChangeViewZones((e=>{h||this._canIgnoreViewZoneUpdateEvent()||g.schedule()}))),this._register(this._editors.original.onDidChangeConfiguration((e=>{e.hasChanged(143)&&g.schedule()}))),this._register(this._editors.modified.onDidChangeConfiguration((e=>{e.hasChanged(143)&&g.schedule()})));const _=this._diffModel.map((e=>e?(0,r.rD)(e.model.original.onDidChangeTokens,(()=>2===e.model.original.tokenization.backgroundTokenizationState)):void 0)).map(((e,i)=>null===e||void 0===e?void 0:e.read(i))),v=new Set,b=new Set,w=(0,r.nK)("alignments",(e=>{const i=this._diffModel.read(e),t=null===i||void 0===i?void 0:i.diff.read(e);if(!i||!t)return null;c.read(e);const n=this._options.renderSideBySide.read(e),o=n;return ke(this._editors.original,this._editors.modified,t.mappings,v,b,o)})),C=(0,r.nK)("alignments",(e=>{var i;const t=null===(i=this._diffModel.read(e))||void 0===i?void 0:i.syncedMovedTexts.read(e);if(!t)return null;c.read(e);const n=t.changes.map((e=>new ue(e)));return ke(this._editors.original,this._editors.modified,n,v,b,!0)}));function L(){const e=document.createElement("div");return e.className="diagonal-fill",e}const E=this._register(new u.SL),S=(0,r.nK)("alignment viewzones",(e=>{var i,t,o,s,r,d,a,l;E.clear();const h=w.read(e)||[],c=[],g=[],u=this._modifiedTopPadding.read(e);u>0&&g.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:u,showInHiddenAreas:!0});const v=this._originalTopPadding.read(e);v>0&&c.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:v,showInHiddenAreas:!0});const b=this._options.renderSideBySide.read(e),S=b||null===(i=this._editors.modified._getViewModel())||void 0===i?void 0:i.createLineBreaksComputer();if(S)for(const V of h)if(V.diff)for(let P=V.originalRange.startLineNumber;P<V.originalRange.endLineNumberExclusive;P++)null===S||void 0===S||S.addRequest(this._editors.original.getModel().getLineContent(P),null,null);const N=null!==(t=null===S||void 0===S?void 0:S.finalize())&&void 0!==t?t:[];let y=0;const R=this._editors.modified.getOption(65),M=null===(o=this._diffModel.read(e))||void 0===o?void 0:o.syncedMovedTexts.read(e),T=null!==(r=null===(s=this._editors.original.getModel())||void 0===s?void 0:s.mightContainNonBasicASCII())&&void 0!==r&&r,x=null!==(a=null===(d=this._editors.original.getModel())||void 0===d?void 0:d.mightContainRTL())&&void 0!==a&&a,O=Oe.fromEditor(this._editors.modified);for(const W of h)if(W.diff&&!b){if(!W.originalRange.isEmpty){_.read(e);const F=document.createElement("div");F.classList.add("view-lines","line-delete","monaco-mouse-cursor-text");const H=new xe(W.originalRange.mapToLineArray((e=>this._editors.original.getModel().tokenization.getLineTokens(e))),W.originalRange.mapToLineArray((e=>N[y++])),T,x),k=[];for(const Z of W.diff.innerChanges||[])k.push(new Me.$t(Z.originalRange.delta(-(W.diff.originalRange.startLineNumber-1)),I.className,0));const z=Te(H,O,k,F),B=document.createElement("div");if(B.className="inline-deleted-margin-view-zone",(0,ne.N)(B,O.fontInfo),this._options.renderIndicators.read(e))for(let K=0;K<z.heightInLines;K++){const j=document.createElement("div");j.className=`delete-sign ${p.k.asClassName(D)}`,j.setAttribute("style",`position:absolute;top:${K*R}px;width:${O.lineDecorationsWidth}px;height:${R}px;right:0;`),B.appendChild(j)}let U;E.add(new Le((()=>(0,m.cW)(U)),B,this._editors.modified,W.diff,this._diffEditorWidget,z.viewLineCounts,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let q=0;q<z.viewLineCounts.length;q++){const Q=z.viewLineCounts[q];Q>1&&c.push({afterLineNumber:W.originalRange.startLineNumber+q,domNode:L(),heightInPx:(Q-1)*R,showInHiddenAreas:!0})}g.push({afterLineNumber:W.modifiedRange.startLineNumber-1,domNode:F,heightInPx:z.heightInLines*R,minWidthInPx:z.minWidthInPx,marginDomNode:B,setZoneId(e){U=e},showInHiddenAreas:!0})}const A=document.createElement("div");A.className="gutter-delete",c.push({afterLineNumber:W.originalRange.endLineNumberExclusive-1,domNode:L(),heightInPx:W.modifiedHeightInPx,marginDomNode:A,showInHiddenAreas:!0})}else{const $=W.modifiedHeightInPx-W.originalHeightInPx;if($>0){if(null===M||void 0===M?void 0:M.lineRangeMapping.original.contains(W.originalRange.endLineNumberExclusive-1))continue;c.push({afterLineNumber:W.originalRange.endLineNumberExclusive-1,domNode:L(),heightInPx:$,showInHiddenAreas:!0})}else{if(null===M||void 0===M?void 0:M.lineRangeMapping.modified.contains(W.modifiedRange.endLineNumberExclusive-1))continue;function G(){const e=document.createElement("div");return e.className="arrow-revert-change "+p.k.asClassName(f.l.arrowRight),(0,n.$)("div",{},e)}let J;W.diff&&W.diff.modifiedRange.isEmpty&&this._options.shouldRenderRevertArrows.read(e)&&(J=G()),g.push({afterLineNumber:W.modifiedRange.endLineNumberExclusive-1,domNode:L(),heightInPx:-$,marginDomNode:J,showInHiddenAreas:!0})}}for(const X of null!==(l=C.read(e))&&void 0!==l?l:[]){if(!(null===M||void 0===M?void 0:M.lineRangeMapping.original.intersect(X.originalRange))&&!(null===M||void 0===M?void 0:M.lineRangeMapping.modified.intersect(X.modifiedRange)))continue;const Y=X.modifiedHeightInPx-X.originalHeightInPx;Y>0?c.push({afterLineNumber:X.originalRange.endLineNumberExclusive-1,domNode:L(),heightInPx:Y,showInHiddenAreas:!0}):g.push({afterLineNumber:X.modifiedRange.endLineNumberExclusive-1,domNode:L(),heightInPx:-Y,showInHiddenAreas:!0})}return{orig:c,mod:g}}));this._register((0,d.b2)("alignment viewzones",(e=>{const i=oe.Z.capture(this._editors.modified),t=S.read(e);h=!0,this._editors.original.changeViewZones((e=>{for(const i of v)e.removeZone(i);v.clear();for(const i of t.orig){const t=e.addZone(i);i.setZoneId&&i.setZoneId(t),v.add(t)}})),this._editors.modified.changeViewZones((e=>{for(const i of b)e.removeZone(i);b.clear();for(const i of t.mod){const t=e.addZone(i);i.setZoneId&&i.setZoneId(t),b.add(t)}})),h=!1,i.restore(this._editors.modified)}))),this._register((0,u.OF)((()=>{this._editors.original.changeViewZones((e=>{for(const i of v)e.removeZone(i);v.clear()})),this._editors.modified.changeViewZones((e=>{for(const i of b)e.removeZone(i);b.clear()}))})));let N=!1;this._register(this._editors.original.onDidScrollChange((e=>{e.scrollLeftChanged&&!N&&(N=!0,this._editors.modified.setScrollLeft(e.scrollLeft),N=!1)}))),this._register(this._editors.modified.onDidScrollChange((e=>{e.scrollLeftChanged&&!N&&(N=!0,this._editors.original.setScrollLeft(e.scrollLeft),N=!1)}))),this._originalScrollTop=(0,r.rD)(this._editors.original.onDidScrollChange,(()=>this._editors.original.getScrollTop())),this._modifiedScrollTop=(0,r.rD)(this._editors.modified.onDidScrollChange,(()=>this._editors.modified.getScrollTop())),this._register((0,d.EH)("update scroll modified",(e=>{const i=this._originalScrollTop.read(e)-(this._originalScrollOffsetAnimated.get()-this._modifiedScrollOffsetAnimated.read(e))-(this._originalTopPadding.get()-this._modifiedTopPadding.read(e));i!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(i,1)}))),this._register((0,d.EH)("update scroll original",(e=>{const i=this._modifiedScrollTop.read(e)-(this._modifiedScrollOffsetAnimated.get()-this._originalScrollOffsetAnimated.read(e))-(this._modifiedTopPadding.get()-this._originalTopPadding.read(e));i!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(i,1)}))),this._register((0,d.EH)("update",(e=>{var i;const t=null===(i=this._diffModel.read(e))||void 0===i?void 0:i.syncedMovedTexts.read(e);let n=0;if(t){const e=this._editors.original.getTopForLineNumber(t.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.get(),i=this._editors.modified.getTopForLineNumber(t.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.get();n=i-e}n>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(n,void 0)):n<0?(this._modifiedTopPadding.set(-n,void 0),this._originalTopPadding.set(0,void 0)):setTimeout((()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)}),400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.get()-n,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.get()+n,void 0,!0)})))}};function ke(e,i,t,n,o,s){const r=new ie.H9(ze(e,n)),d=new ie.H9(ze(i,o)),a=e.getOption(65),l=i.getOption(65),h=[];let c=0,g=0;function u(e,i){while(1){let t=r.peek(),n=d.peek();if(t&&t.lineNumber>=e&&(t=void 0),n&&n.lineNumber>=i&&(n=void 0),!t&&!n)break;const o=t?t.lineNumber-c:Number.MAX_VALUE,s=n?n.lineNumber-g:Number.MAX_VALUE;o<s?(r.dequeue(),n={lineNumber:t.lineNumber-c+g,heightInPx:0}):o>s?(d.dequeue(),t={lineNumber:n.lineNumber-g+c,heightInPx:0}):(r.dequeue(),d.dequeue()),h.push({originalRange:$.z.ofLength(t.lineNumber,1),modifiedRange:$.z.ofLength(n.lineNumber,1),originalHeightInPx:a+t.heightInPx,modifiedHeightInPx:l+n.heightInPx,diff:void 0})}}for(const m of t){const f=m.lineRangeMapping;u(f.originalRange.startLineNumber,f.modifiedRange.startLineNumber);let _=!0,p=f.modifiedRange.startLineNumber,v=f.originalRange.startLineNumber;function b(e,i){var t,n,o,s;if(e<v||i<p)return;if(_)_=!1;else if(e===v||i===p)return;const c=new $.z(v,e),g=new $.z(p,i);if(c.isEmpty&&g.isEmpty)return;const u=null!==(n=null===(t=r.takeWhile((i=>i.lineNumber<e)))||void 0===t?void 0:t.reduce(((e,i)=>e+i.heightInPx),0))&&void 0!==n?n:0,f=null!==(s=null===(o=d.takeWhile((e=>e.lineNumber<i)))||void 0===o?void 0:o.reduce(((e,i)=>e+i.heightInPx),0))&&void 0!==s?s:0;h.push({originalRange:c,modifiedRange:g,originalHeightInPx:c.length*a+u,modifiedHeightInPx:g.length*l+f,diff:m.lineRangeMapping}),v=e,p=i}if(s)for(const w of f.innerChanges||[])w.originalRange.startColumn>1&&w.modifiedRange.startColumn>1&&b(w.originalRange.startLineNumber,w.modifiedRange.startLineNumber),w.originalRange.endColumn<e.getModel().getLineMaxColumn(w.originalRange.endLineNumber)&&b(w.originalRange.endLineNumber,w.modifiedRange.endLineNumber);b(f.originalRange.endLineNumberExclusive,f.modifiedRange.endLineNumberExclusive),c=f.originalRange.endLineNumberExclusive,g=f.modifiedRange.endLineNumberExclusive}return u(Number.MAX_VALUE,Number.MAX_VALUE),h}function ze(e,i){const t=[],n=[],o=-1!==e.getOption(143).wrappingColumn,s=e._getViewModel().coordinatesConverter,r=e.getOption(65);if(o)for(let a=1;a<=e.getModel().getLineCount();a++){const e=s.getModelLineViewLineCount(a);e>1&&n.push({lineNumber:a,heightInPx:r*(e-1)})}for(const a of e.getWhitespaces()){if(i.has(a.id))continue;const e=0===a.afterLineNumber?0:s.convertViewPositionToModelPosition(new G.L(a.afterLineNumber,1)).lineNumber;t.push({lineNumber:e,heightInPx:a.height})}const d=W(t,n,(e=>e.lineNumber),((e,i)=>({lineNumber:e.lineNumber,heightInPx:e.heightInPx+i.heightInPx})));return d}He=Ae([Fe(5,Pe.p),Fe(6,We.i)],He);var Be=t(25503),Ue=t(31745),Ze=t(25099),Ke=t(40118),je=t(74821),qe=function(e,i,t,n){var o,s=arguments.length,r=s<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(i,t,r):o(i,t))||r);return s>3&&r&&Object.defineProperty(i,t,r),r},Qe=function(e,i){return function(t,n){i(t,n,e)}};let $e=class e extends u.JT{constructor(i,t,o,s,a,l,h,c){super(),this._editors=i,this._rootElement=t,this._diffModel=o,this._rootWidth=s,this._rootHeight=a,this._modifiedEditorLayoutInfo=l,this._options=h,this._themeService=c;const g=(0,r.rD)(this._themeService.onDidColorThemeChange,(()=>this._themeService.getColorTheme())),u=(0,r.nK)("colors",(e=>{const i=g.read(e),t=i.getColor(Ke.P6Y)||(i.getColor(Ke.ypS)||Ke.CzK).transparent(2),n=i.getColor(Ke.F9q)||(i.getColor(Ke.P4M)||Ke.keg).transparent(2);return{insertColor:t,removeColor:n}})),m=(0,r.rD)(this._editors.modified.onDidScrollChange,(()=>this._editors.modified.getScrollTop())),f=(0,r.rD)(this._editors.modified.onDidScrollChange,(()=>this._editors.modified.getScrollHeight()));this._register((0,d.b2)("create diff editor overview ruler if enabled",((i,t)=>{if(!this._options.renderOverviewRuler.read(i))return;const o=(0,Be.X)(document.createElement("div"));o.setClassName("diffViewport"),o.setPosition("absolute");const s=(0,n.h)("div.diffOverview",{style:{position:"absolute",top:"0px",width:e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;t.add(F(s,o.domNode)),t.add((0,n.mu)(s,n.tw.POINTER_DOWN,(e=>{this._editors.modified.delegateVerticalScrollbarPointerDown(e)}))),t.add((0,n.nm)(s,n.tw.MOUSE_WHEEL,(e=>{this._editors.modified.delegateScrollFromMouseWheelEvent(e)}),{passive:!1})),t.add(F(this._rootElement,s)),t.add((0,d.b2)("recreate overview rules when model changes",((i,t)=>{const n=this._diffModel.read(i),d=this._editors.original.createOverviewRuler("original diffOverviewRuler");d&&(t.add(d),t.add(F(s,d.getDomNode())));const a=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(a&&(t.add(a),t.add(F(s,a.getDomNode()))),!d||!a)return;const l=(0,r.aq)("viewZoneChanged",this._editors.original.onDidChangeViewZones),h=(0,r.aq)("viewZoneChanged",this._editors.modified.onDidChangeViewZones),c=(0,r.aq)("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),g=(0,r.aq)("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);t.add((0,r.EH)("set overview ruler zones",(e=>{var i;l.read(e),h.read(e),c.read(e),g.read(e);const t=u.read(e),o=null===(i=null===n||void 0===n?void 0:n.diff.read(e))||void 0===i?void 0:i.mappings;function s(e,i,t){const n=t._getViewModel();return n?e.filter((e=>e.length>0)).map((e=>{const t=n.coordinatesConverter.convertModelPositionToViewPosition(new G.L(e.startLineNumber,1)),o=n.coordinatesConverter.convertModelPositionToViewPosition(new G.L(e.endLineNumberExclusive,1));return new Ze.EY(t.lineNumber,o.lineNumber,0,i.toString())})):[]}null===d||void 0===d||d.setZones(s((o||[]).map((e=>e.lineRangeMapping.originalRange)),t.removeColor,this._editors.original)),null===a||void 0===a||a.setZones(s((o||[]).map((e=>e.lineRangeMapping.modifiedRange)),t.insertColor,this._editors.modified))}))),t.add((0,r.EH)("layout overview ruler",(i=>{const t=this._rootHeight.read(i),n=this._rootWidth.read(i),r=this._modifiedEditorLayoutInfo.read(i);if(r){const n=e.ENTIRE_DIFF_OVERVIEW_WIDTH-2*e.ONE_OVERVIEW_WIDTH;d.setLayout({top:0,height:t,right:n+e.ONE_OVERVIEW_WIDTH,width:e.ONE_OVERVIEW_WIDTH}),a.setLayout({top:0,height:t,right:0,width:e.ONE_OVERVIEW_WIDTH});const s=m.read(i),l=f.read(i),h=this._editors.modified.getOption(101),c=new Ue.M(h.verticalHasArrows?h.arrowSize:0,h.verticalScrollbarSize,0,r.height,l,s);o.setTop(c.getSliderPosition()),o.setHeight(c.getSliderSize())}else o.setTop(0),o.setHeight(0);s.style.height=t+"px",s.style.left=n-e.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",o.setWidth(e.ENTIRE_DIFF_OVERVIEW_WIDTH)})))})))})))}};$e.ONE_OVERVIEW_WIDTH=15,$e.ENTIRE_DIFF_OVERVIEW_WIDTH=2*$e.ONE_OVERVIEW_WIDTH,$e=qe([Qe(7,je.XE)],$e);var Ge=t(60897);class Je extends u.JT{get isUpdatingViewZones(){return this._isUpdatingViewZones}constructor(e,i,t){super(),this._editors=e,this._diffModel=i,this._options=t,this._isUpdatingViewZones=!1,this._register(this._editors.original.onDidChangeCursorPosition((e=>{if(3===e.reason){const e=this._diffModel.get();(0,r.PS)((i=>{for(const t of this._editors.original.getSelections()||[])null===e||void 0===e||e.ensureOriginalLineIsVisible(t.getStartPosition().lineNumber,i),null===e||void 0===e||e.ensureOriginalLineIsVisible(t.getEndPosition().lineNumber,i)}))}}))),this._register(this._editors.modified.onDidChangeCursorPosition((e=>{if(3===e.reason){const e=this._diffModel.get();(0,r.PS)((i=>{for(const t of this._editors.modified.getSelections()||[])null===e||void 0===e||e.ensureModifiedLineIsVisible(t.getStartPosition().lineNumber,i),null===e||void 0===e||e.ensureModifiedLineIsVisible(t.getEndPosition().lineNumber,i)}))}})));const n=this._diffModel.map(((e,i)=>{var t,n;return 0===(null===(t=null===e||void 0===e?void 0:e.diff.read(i))||void 0===t?void 0:t.mappings.length)?[]:null!==(n=null===e||void 0===e?void 0:e.unchangedRegions.read(i))&&void 0!==n?n:[]})),o=(0,l.Be)("view zones",((e,i)=>{const t=[],o=[],s=this._options.renderSideBySide.read(e),r=n.read(e);for(const n of r)if(!n.shouldHideControls(e)){{const e=(0,l.nK)("hiddenOriginalRangeStart",(e=>n.getHiddenOriginalRange(e).startLineNumber-1)),o=new U(e,24);t.push(o),i.add(new Xe(this._editors.original,o,n,!s))}{const e=(0,l.nK)("hiddenModifiedRangeStart",(e=>n.getHiddenModifiedRange(e).startLineNumber-1)),t=new U(e,24);o.push(t),i.add(new Xe(this._editors.modified,t,n,!1))}}return{origViewZones:t,modViewZones:o}})),s={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},a={description:"Fold Unchanged",glyphMarginHoverMessage:new _.W5(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown((0,b.NC)("foldUnchanged","Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+p.k.asClassName(f.l.fold),zIndex:10001};this._register(A(this._editors.original,(0,l.nK)("decorations",(e=>{const i=n.read(e),t=i.map((e=>({range:e.originalRange.toInclusiveRange(),options:s})));for(const n of i)n.shouldHideControls(e)&&t.push({range:J.e.fromPositions(new G.L(n.originalLineNumber,1)),options:a});return t})))),this._register(A(this._editors.modified,(0,l.nK)("decorations",(e=>{const i=n.read(e),t=i.map((e=>({range:e.modifiedRange.toInclusiveRange(),options:s})));for(const n of i)n.shouldHideControls(e)&&t.push({range:$.z.ofLength(n.modifiedLineNumber,1).toInclusiveRange(),options:a});return t})))),this._register(Q(this._editors.original,o.map((e=>e.origViewZones)),(e=>this._isUpdatingViewZones=e))),this._register(Q(this._editors.modified,o.map((e=>e.modViewZones)),(e=>this._isUpdatingViewZones=e))),this._register((0,d.b2)("update folded unchanged regions",((e,i)=>{const t=n.read(e);this._editors.original.setHiddenAreas(t.map((i=>i.getHiddenOriginalRange(e).toInclusiveRange())).filter(m.$K)),this._editors.modified.setHiddenAreas(t.map((i=>i.getHiddenModifiedRange(e).toInclusiveRange())).filter(m.$K))}))),this._register(this._editors.modified.onMouseUp((e=>{var i;if(!e.event.rightButton&&e.target.position&&(null===(i=e.target.element)||void 0===i?void 0:i.className.includes("fold-unchanged"))){const i=e.target.position.lineNumber,t=this._diffModel.get();if(!t)return;const n=t.unchangedRegions.get().find((e=>e.modifiedRange.includes(i)));if(!n)return;n.setState(0,0,void 0),e.event.stopPropagation(),e.event.preventDefault()}}))),this._register(this._editors.original.onMouseUp((e=>{var i;if(!e.event.rightButton&&e.target.position&&(null===(i=e.target.element)||void 0===i?void 0:i.className.includes("fold-unchanged"))){const i=e.target.position.lineNumber,t=this._diffModel.get();if(!t)return;const n=t.unchangedRegions.get().find((e=>e.originalRange.includes(i)));if(!n)return;n.setState(0,0,void 0),e.event.stopPropagation(),e.event.preventDefault()}})))}}class Xe extends B{constructor(e,i,t,o){const s=(0,n.h)("div.diff-hidden-lines-widget");super(e,i,s.root),this._editor=e,this._unchangedRegion=t,this.hide=o,this._nodes=(0,n.h)("div.diff-hidden-lines",[(0,n.h)("div.top@top",{title:"Click or drag to show more above"}),(0,n.h)("div.center@content",{style:{display:"flex"}},[(0,n.h)("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},[(0,n.$)("a",{title:"Show all",role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...(0,Ge.T)("$(unfold)"))]),(0,n.h)("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),(0,n.h)("div.bottom@bottom",{title:"Click or drag to show more below",role:"button"})]),s.root.appendChild(this._nodes.root);const a=(0,r.rD)(this._editor.onDidLayoutChange,(()=>this._editor.getLayoutInfo()));this.hide?(0,n.mc)(this._nodes.first):this._register(K(this._nodes.first,{width:a.map((e=>e.contentLeft))}));const l=this._editor;this._register((0,n.nm)(this._nodes.top,"mousedown",(e=>{if(0!==e.button)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),e.preventDefault();const i=e.clientY;let t=!1;const o=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set(!0,void 0);const s=(0,n.nm)(window,"mousemove",(e=>{const n=e.clientY,s=n-i;t=t||Math.abs(s)>2;const r=Math.round(s/l.getOption(65)),d=Math.max(0,Math.min(o+r,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(d,void 0)})),r=(0,n.nm)(window,"mouseup",(e=>{t||this._unchangedRegion.showMoreAbove(20,void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(!1,void 0),s.dispose(),r.dispose()}))}))),this._register((0,n.nm)(this._nodes.bottom,"mousedown",(e=>{if(0!==e.button)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),e.preventDefault();const i=e.clientY;let t=!1;const o=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set(!0,void 0);const s=(0,n.nm)(window,"mousemove",(e=>{const n=e.clientY,s=n-i;t=t||Math.abs(s)>2;const r=Math.round(s/l.getOption(65)),d=Math.max(0,Math.min(o-r,this._unchangedRegion.getMaxVisibleLineCountBottom())),a=l.getTopForLineNumber(this._unchangedRegion.originalRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(d,void 0);const h=l.getTopForLineNumber(this._unchangedRegion.originalRange.endLineNumberExclusive);l.setScrollTop(l.getScrollTop()+(h-a))})),r=(0,n.nm)(window,"mouseup",(e=>{if(this._unchangedRegion.isDragged.set(!1,void 0),!t){const e=l.getTopForLineNumber(this._unchangedRegion.originalRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(20,void 0);const i=l.getTopForLineNumber(this._unchangedRegion.originalRange.endLineNumberExclusive);l.setScrollTop(l.getScrollTop()+(i-e))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),s.dispose(),r.dispose()}))}))),this._register((0,d.EH)("update labels",(e=>{const i=[];if(!this.hide){const o=t.getHiddenModifiedRange(e).length,s=`${o} Hidden Lines`;i.push((0,n.$)("span",{title:s},s))}(0,n.mc)(this._nodes.others,...i)})))}}var Ye=t(58707),ei=t(90290),ii=t(90694),ti=t(25065),ni=t(61156),oi=t(82915);class si extends u.JT{constructor(){super(...arguments),this._id=++si.idCounter,this._onDidDispose=this._register(new s.Q5),this.onDidDispose=this._onDidDispose.event}getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(e){return this._targetEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._targetEditor.getPosition()}setPosition(e,i="api"){this._targetEditor.setPosition(e,i)}revealLine(e,i=0){this._targetEditor.revealLine(e,i)}revealLineInCenter(e,i=0){this._targetEditor.revealLineInCenter(e,i)}revealLineInCenterIfOutsideViewport(e,i=0){this._targetEditor.revealLineInCenterIfOutsideViewport(e,i)}revealLineNearTop(e,i=0){this._targetEditor.revealLineNearTop(e,i)}revealPosition(e,i=0){this._targetEditor.revealPosition(e,i)}revealPositionInCenter(e,i=0){this._targetEditor.revealPositionInCenter(e,i)}revealPositionInCenterIfOutsideViewport(e,i=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(e,i)}revealPositionNearTop(e,i=0){this._targetEditor.revealPositionNearTop(e,i)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(e,i="api"){this._targetEditor.setSelection(e,i)}setSelections(e,i="api"){this._targetEditor.setSelections(e,i)}revealLines(e,i,t=0){this._targetEditor.revealLines(e,i,t)}revealLinesInCenter(e,i,t=0){this._targetEditor.revealLinesInCenter(e,i,t)}revealLinesInCenterIfOutsideViewport(e,i,t=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(e,i,t)}revealLinesNearTop(e,i,t=0){this._targetEditor.revealLinesNearTop(e,i,t)}revealRange(e,i=0,t=!1,n=!0){this._targetEditor.revealRange(e,i,t,n)}revealRangeInCenter(e,i=0){this._targetEditor.revealRangeInCenter(e,i)}revealRangeInCenterIfOutsideViewport(e,i=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(e,i)}revealRangeNearTop(e,i=0){this._targetEditor.revealRangeNearTop(e,i)}revealRangeNearTopIfOutsideViewport(e,i=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(e,i)}revealRangeAtTop(e,i=0){this._targetEditor.revealRangeAtTop(e,i)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(e,i,t){this._targetEditor.trigger(e,i,t)}createDecorationsCollection(e){return this._targetEditor.createDecorationsCollection(e)}changeDecorations(e){return this._targetEditor.changeDecorations(e)}}si.idCounter=0;var ri=t(703),di=function(e,i,t,n){var o,s=arguments.length,r=s<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(i,t,r):o(i,t))||r);return s>3&&r&&Object.defineProperty(i,t,r),r},ai=function(e,i){return function(t,n){i(t,n,e)}};let li=class extends u.JT{constructor(e,i,t,n,o,r,a){super(),this.originalEditorElement=e,this.modifiedEditorElement=i,this._options=t,this._createInnerEditor=o,this._instantiationService=r,this._keybindingService=a,this._onDidContentSizeChange=this._register(new s.Q5),this.original=this._createLeftHandSideEditor(t.editorOptions.get(),n.originalEditor||{}),this.modified=this._createRightHandSideEditor(t.editorOptions.get(),n.modifiedEditor||{}),this._register((0,d.nJ)("update editor options",{createEmptyChangeSummary:()=>({}),handleChange:(e,i)=>(e.didChange(t.editorOptions)&&Object.assign(i,e.change.changedOptions),!0)},((e,i)=>{t.editorOptions.read(e),this.modified.updateOptions(this._adjustOptionsForRightHandSide(e,i)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(e,i))})))}_createLeftHandSideEditor(e,i){const t=this._adjustOptionsForLeftHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,t,i);return n.setContextValue("isInDiffLeftEditor",!0),n}_createRightHandSideEditor(e,i){const t=this._adjustOptionsForRightHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,t,i);return n.setContextValue("isInDiffRightEditor",!0),n}_constructInnerEditor(e,i,t,n){const o=this._createInnerEditor(e,i,t,n);return this._register(o.onDidContentSizeChange((e=>{const i=this.original.getContentWidth()+this.modified.getContentWidth()+$e.ENTIRE_DIFF_OVERVIEW_WIDTH,t=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:t,contentWidth:i,contentHeightChanged:e.contentHeightChanged,contentWidthChanged:e.contentWidthChanged})}))),o}_adjustOptionsForLeftHandSide(e,i){const t=this._adjustOptionsForSubEditor(i);return this._options.renderSideBySide.get()?t.wordWrapOverride1=this._options.diffWordWrap.get():(t.wordWrapOverride1="off",t.wordWrapOverride2="off",t.stickyScroll={enabled:!1}),i.originalAriaLabel&&(t.ariaLabel=i.originalAriaLabel),t.ariaLabel=this._updateAriaLabel(t.ariaLabel),t.readOnly=!this._options.originalEditable.get(),t.dropIntoEditor={enabled:!t.readOnly},t.extraEditorClassName="original-in-monaco-diff-editor",t}_adjustOptionsForRightHandSide(e,i){const t=this._adjustOptionsForSubEditor(i);return i.modifiedAriaLabel&&(t.ariaLabel=i.modifiedAriaLabel),t.ariaLabel=this._updateAriaLabel(t.ariaLabel),t.wordWrapOverride1=this._options.diffWordWrap.get(),t.revealHorizontalRightPadding=Se.BH.revealHorizontalRightPadding.defaultValue+$e.ENTIRE_DIFF_OVERVIEW_WIDTH,t.scrollbar.verticalHasArrows=!1,t.extraEditorClassName="modified-in-monaco-diff-editor",t}_adjustOptionsForSubEditor(e){const i=Object.assign(Object.assign({},e),{dimension:{height:0,width:0}});return i.inDiffEditor=!0,i.automaticLayout=!1,i.scrollbar=Object.assign({},i.scrollbar||{}),i.scrollbar.vertical="visible",i.folding=!1,i.codeLens=this._options.diffCodeLens.get(),i.fixedOverflowWidgets=!0,i.minimap=Object.assign({},i.minimap||{}),i.minimap.enabled=!1,this._options.collapseUnchangedRegions.get()?i.stickyScroll={enabled:!1}:i.stickyScroll=this._options.editorOptions.get().stickyScroll,i}_updateAriaLabel(e){var i;e||(e="");const t=(0,b.NC)("diff-aria-navigation-tip"," use {0} to open the accessibility help.",null===(i=this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp"))||void 0===i?void 0:i.getAriaLabel());return this._options.accessibilityVerbose.get()?e+t:e?e.replaceAll(t,""):""}};li=di([ai(5,ni.TG),ai(6,ri.d)],li);class hi{get editorOptions(){return this._options}constructor(e){this.renderOverviewRuler=(0,r.nK)("renderOverviewRuler",(e=>this._options.read(e).renderOverviewRuler)),this.renderSideBySide=(0,r.nK)("renderSideBySide",(e=>this._options.read(e).renderSideBySide)),this.readOnly=(0,r.nK)("readOnly",(e=>this._options.read(e).readOnly)),this.shouldRenderRevertArrows=(0,r.nK)("shouldRenderRevertArrows",(e=>!!this._options.read(e).renderMarginRevertIcon&&(!!this.renderSideBySide.read(e)&&!this.readOnly.read(e)))),this.renderIndicators=(0,r.nK)("renderIndicators",(e=>this._options.read(e).renderIndicators)),this.enableSplitViewResizing=(0,r.nK)("enableSplitViewResizing",(e=>this._options.read(e).enableSplitViewResizing)),this.collapseUnchangedRegions=(0,r.nK)("hideUnchangedRegions",(e=>this._options.read(e).experimental.collapseUnchangedRegions)),this.splitViewDefaultRatio=(0,r.nK)("splitViewDefaultRatio",(e=>this._options.read(e).splitViewDefaultRatio)),this.ignoreTrimWhitespace=(0,r.nK)("ignoreTrimWhitespace",(e=>this._options.read(e).ignoreTrimWhitespace)),this.maxComputationTimeMs=(0,r.nK)("maxComputationTime",(e=>this._options.read(e).maxComputationTime)),this.showMoves=(0,r.nK)("showMoves",(e=>{const i=this._options.read(e);return i.experimental.showMoves&&i.renderSideBySide})),this.isInEmbeddedEditor=(0,r.nK)("isInEmbeddedEditor",(e=>this._options.read(e).isInEmbeddedEditor)),this.diffWordWrap=(0,r.nK)("diffWordWrap",(e=>this._options.read(e).diffWordWrap)),this.originalEditable=(0,r.nK)("originalEditable",(e=>this._options.read(e).originalEditable)),this.diffCodeLens=(0,r.nK)("diffCodeLens",(e=>this._options.read(e).diffCodeLens)),this.accessibilityVerbose=(0,r.nK)("accessibilityVerbose",(e=>this._options.read(e).accessibilityVerbose)),this.diffAlgorithm=(0,r.nK)("diffAlgorithm",(e=>this._options.read(e).diffAlgorithm)),this.showEmptyDecorations=(0,r.nK)("showEmptyDecorations",(e=>this._options.read(e).experimental.showEmptyDecorations)),this.onlyShowAccessibleDiffViewer=(0,r.nK)("onlyShowAccessibleDiffViewer",(e=>this._options.read(e).onlyShowAccessibleDiffViewer));const i=Object.assign(Object.assign({},e),gi(e,ci));this._options=(0,r.uh)("options",i)}updateOptions(e){const i=gi(e,this._options.get()),t=Object.assign(Object.assign(Object.assign({},this._options.get()),e),i);this._options.set(t,void 0,{changedOptions:e})}}const ci={enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{collapseUnchangedRegions:!1,showMoves:!1,showEmptyDecorations:!0},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1};function gi(e,i){var t,n,o;return{enableSplitViewResizing:(0,Se.O7)(e.enableSplitViewResizing,i.enableSplitViewResizing),splitViewDefaultRatio:(0,Se.L_)(e.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:(0,Se.O7)(e.renderSideBySide,i.renderSideBySide),renderMarginRevertIcon:(0,Se.O7)(e.renderMarginRevertIcon,i.renderMarginRevertIcon),maxComputationTime:(0,Se.Zc)(e.maxComputationTime,i.maxComputationTime,0,1073741824),maxFileSize:(0,Se.Zc)(e.maxFileSize,i.maxFileSize,0,1073741824),ignoreTrimWhitespace:(0,Se.O7)(e.ignoreTrimWhitespace,i.ignoreTrimWhitespace),renderIndicators:(0,Se.O7)(e.renderIndicators,i.renderIndicators),originalEditable:(0,Se.O7)(e.originalEditable,i.originalEditable),diffCodeLens:(0,Se.O7)(e.diffCodeLens,i.diffCodeLens),renderOverviewRuler:(0,Se.O7)(e.renderOverviewRuler,i.renderOverviewRuler),diffWordWrap:(0,Se.NY)(e.diffWordWrap,i.diffWordWrap,["off","on","inherit"]),diffAlgorithm:(0,Se.NY)(e.diffAlgorithm,i.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:(0,Se.O7)(e.accessibilityVerbose,i.accessibilityVerbose),experimental:{collapseUnchangedRegions:(0,Se.O7)(null===(t=e.experimental)||void 0===t?void 0:t.collapseUnchangedRegions,i.experimental.collapseUnchangedRegions),showMoves:(0,Se.O7)(null===(n=e.experimental)||void 0===n?void 0:n.showMoves,i.experimental.showMoves),showEmptyDecorations:(0,Se.O7)(null===(o=e.experimental)||void 0===o?void 0:o.showEmptyDecorations,i.experimental.showEmptyDecorations)},isInEmbeddedEditor:(0,Se.O7)(e.isInEmbeddedEditor,i.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:(0,Se.O7)(e.onlyShowAccessibleDiffViewer,i.onlyShowAccessibleDiffViewer)}}var ui=t(81223),mi=t(33300),fi=t(79827),_i=t(22441),pi=t(4796),vi=t(36374),bi=function(e,i,t,n){var o,s=arguments.length,r=s<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(i,t,r):o(i,t))||r);return s>3&&r&&Object.defineProperty(i,t,r),r},wi=function(e,i){return function(t,n){i(t,n,e)}},Ci=function(e,i,t,n){function o(e){return e instanceof t?e:new t((function(i){i(e)}))}return new(t||(t=Promise))((function(t,s){function r(e){try{a(n.next(e))}catch(i){s(i)}}function d(e){try{a(n["throw"](e))}catch(i){s(i)}}function a(e){e.done?t(e.value):o(e.value).then(r,d)}a((n=n.apply(e,i||[])).next())}))};const Di=(0,w.q5)("diff-review-insert",f.l.add,(0,b.NC)("accessibleDiffViewerInsertIcon","Icon for 'Insert' in accessible diff viewer.")),Li=(0,w.q5)("diff-review-remove",f.l.remove,(0,b.NC)("accessibleDiffViewerRemoveIcon","Icon for 'Remove' in accessible diff viewer.")),Ei=(0,w.q5)("diff-review-close",f.l.close,(0,b.NC)("accessibleDiffViewerCloseIcon","Icon for 'Close' in accessible diff viewer."));let Si=class extends u.JT{constructor(e,i,t,n,o,s,d,a,h){super(),this._parentNode=e,this._visible=i,this._setVisible=t,this._canClose=n,this._width=o,this._height=s,this._diffs=d,this._editors=a,this._instantiationService=h,this.model=(0,l.Be)("model",((e,i)=>{const t=this._visible.read(e);if(this._parentNode.style.visibility=t?"visible":"hidden",!t)return null;const n=i.add(this._instantiationService.createInstance(Ni,this._diffs,this._editors,this._setVisible,this._canClose)),o=i.add(this._instantiationService.createInstance(Pi,this._parentNode,n,this._width,this._height,this._editors));return{model:n,view:o}})),this._register((0,r.$g)(this.model,!0))}next(){(0,r.PS)((e=>{const i=this._visible.get();this._setVisible(!0,e),i&&this.model.get().model.nextGroup(e)}))}prev(){(0,r.PS)((e=>{this._setVisible(!0,e),this.model.get().model.previousGroup(e)}))}close(){(0,r.PS)((e=>{this._setVisible(!1,e)}))}};Si=bi([wi(8,ni.TG)],Si);let Ni=class extends u.JT{constructor(e,i,t,n,o){super(),this._diffs=e,this._editors=i,this._setVisible=t,this.canClose=n,this._audioCueService=o,this._groups=(0,r.uh)("groups",[]),this._currentGroupIdx=(0,r.uh)("currentGroupIdx",0),this._currentElementIdx=(0,r.uh)("currentElementIdx",0),this.groups=this._groups,this.currentGroup=this._currentGroupIdx.map(((e,i)=>this._groups.read(i)[e])),this.currentGroupIndex=this._currentGroupIdx,this.currentElement=this._currentElementIdx.map(((e,i)=>{var t;return null===(t=this.currentGroup.read(i))||void 0===t?void 0:t.lines[e]})),this._register((0,r.EH)("update groups",(e=>{const i=this._diffs.read(e);if(!i)return void this._groups.set([],void 0);const t=Ri(i,this._editors.original.getModel().getLineCount(),this._editors.modified.getModel().getLineCount());(0,r.PS)((e=>{const i=this._editors.modified.getPosition();if(i){const n=t.findIndex((e=>(null===i||void 0===i?void 0:i.lineNumber)<e.range.modified.endLineNumberExclusive));-1!==n&&this._currentGroupIdx.set(n,e)}this._groups.set(t,e)}))}))),this._register((0,r.EH)("play audio-cue for diff",(e=>{const i=this.currentElement.read(e);(null===i||void 0===i?void 0:i.type)===Mi.Deleted?this._audioCueService.playAudioCue(vi.y$.diffLineDeleted):(null===i||void 0===i?void 0:i.type)===Mi.Added&&this._audioCueService.playAudioCue(vi.y$.diffLineInserted)}))),this._register((0,r.EH)("select lines in editor",(e=>{var i;const t=this.currentElement.read(e);if(t&&t.type!==Mi.Header){const e=null!==(i=t.modifiedLineNumber)&&void 0!==i?i:t.diff.modifiedRange.startLineNumber;this._editors.modified.setSelection(J.e.fromPositions(new G.L(e,1)))}})))}_goToGroupDelta(e,i){const t=this.groups.get();!t||t.length<=1||(0,a.c8)(i,(i=>{this._currentGroupIdx.set((this._currentGroupIdx.get()+t.length+e)%t.length,i),this._currentElementIdx.set(0,i)}))}nextGroup(e){this._goToGroupDelta(1,e)}previousGroup(e){this._goToGroupDelta(-1,e)}_goToLineDelta(e){const i=this.currentGroup.get();!i||i.lines.length<=1||(0,r.PS)((t=>{this._currentElementIdx.set((this._currentElementIdx.get()+i.lines.length+e)%i.lines.length,t)}))}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(e){const i=this.currentGroup.get();if(!i)return;const t=i.lines.indexOf(e);-1!==t&&(0,r.PS)((e=>{this._currentElementIdx.set(t,e)}))}revealCurrentElementInEditor(){this._setVisible(!1,void 0);const e=this.currentElement.get();e&&(e.type===Mi.Deleted?(this._editors.original.setSelection(J.e.fromPositions(new G.L(e.originalLineNumber,1))),this._editors.original.revealLine(e.originalLineNumber),this._editors.original.focus()):(e.type!==Mi.Header&&(this._editors.modified.setSelection(J.e.fromPositions(new G.L(e.modifiedLineNumber,1))),this._editors.modified.revealLine(e.modifiedLineNumber)),this._editors.modified.focus()))}close(){this._setVisible(!1,void 0),this._editors.modified.focus()}};Ni=bi([wi(4,vi.e7)],Ni);const yi=3;function Ri(e,i,t){const n=[];for(const o of Ai(e,((e,i)=>i.modifiedRange.startLineNumber-e.modifiedRange.endLineNumberExclusive<2*yi))){const e=[];e.push(new Ti);const s=new $.z(Math.max(1,o[0].originalRange.startLineNumber-yi),Math.min(o[o.length-1].originalRange.endLineNumberExclusive+yi,i+1)),r=new $.z(Math.max(1,o[0].modifiedRange.startLineNumber-yi),Math.min(o[o.length-1].modifiedRange.endLineNumberExclusive+yi,t+1));Wi(o,((i,t)=>{const n=new $.z(i?i.originalRange.endLineNumberExclusive:s.startLineNumber,t?t.originalRange.startLineNumber:s.endLineNumberExclusive),o=new $.z(i?i.modifiedRange.endLineNumberExclusive:r.startLineNumber,t?t.modifiedRange.startLineNumber:r.endLineNumberExclusive);n.forEach((i=>{e.push(new Vi(i,o.startLineNumber+(i-n.startLineNumber)))})),t&&(t.originalRange.forEach((i=>{e.push(new xi(t,i))})),t.modifiedRange.forEach((i=>{e.push(new Oi(t,i))})))}));const d=o[0].modifiedRange.join(o[o.length-1].modifiedRange),a=o[0].originalRange.join(o[o.length-1].originalRange);n.push(new Ii(new se.Qy(d,a),e))}return n}var Mi;(function(e){e[e["Header"]=0]="Header",e[e["Unchanged"]=1]="Unchanged",e[e["Deleted"]=2]="Deleted",e[e["Added"]=3]="Added"})(Mi||(Mi={}));class Ii{constructor(e,i){this.range=e,this.lines=i}}class Ti{constructor(){this.type=Mi.Header}}class xi{constructor(e,i){this.diff=e,this.originalLineNumber=i,this.type=Mi.Deleted,this.modifiedLineNumber=void 0}}class Oi{constructor(e,i){this.diff=e,this.modifiedLineNumber=i,this.type=Mi.Added,this.originalLineNumber=void 0}}class Vi{constructor(e,i){this.originalLineNumber=e,this.modifiedLineNumber=i,this.type=Mi.Unchanged}}let Pi=class extends u.JT{constructor(e,i,t,o,s,a){super(),this._element=e,this._model=i,this._width=t,this._height=o,this._editors=s,this._languageService=a,this.domNode=this._element,this.domNode.className="diff-review monaco-editor-background";const l=document.createElement("div");l.className="diff-review-actions",this._actionBar=this._register(new ui.o(l)),this._register((0,r.EH)("update actions",(e=>{this._actionBar.clear(),this._model.canClose.read(e)&&this._actionBar.push(new we.aU("diffreview.close",(0,b.NC)("label.close","Close"),"close-diff-review "+p.k.asClassName(Ei),!0,(()=>Ci(this,void 0,void 0,(function*(){return i.close()})))),{label:!1,icon:!0})}))),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new mi.s$(this._content,{})),(0,n.mc)(this.domNode,this._scrollbar.getDomNode(),l),this._register((0,u.OF)((()=>{(0,n.mc)(this.domNode)}))),this._register(K(this.domNode,{width:this._width,height:this._height})),this._register(K(this._content,{width:this._width,height:this._height})),this._register((0,d.b2)("render",((e,i)=>{this._model.currentGroup.read(e),this._render(i)}))),this._register((0,n.mu)(this.domNode,"keydown",(e=>{(e.equals(18)||e.equals(2066)||e.equals(530))&&(e.preventDefault(),this._model.goToNextLine()),(e.equals(16)||e.equals(2064)||e.equals(528))&&(e.preventDefault(),this._model.goToPreviousLine()),(e.equals(9)||e.equals(2057)||e.equals(521)||e.equals(1033))&&(e.preventDefault(),this._model.close()),(e.equals(10)||e.equals(3))&&(e.preventDefault(),this._model.revealCurrentElementInEditor())})))}_render(e){const i=this._editors.original.getOptions(),t=this._editors.modified.getOptions(),o=document.createElement("div");o.className="diff-review-table",o.setAttribute("role","list"),o.setAttribute("aria-label",(0,b.NC)("ariaLabel","Accessible Diff Viewer. Use arrow up and down to navigate.")),(0,ne.N)(o,t.get(49)),(0,n.mc)(this._content,o);const s=this._editors.original.getModel(),d=this._editors.modified.getModel();if(!s||!d)return;const a=s.getOptions(),l=d.getOptions(),h=t.get(65),c=this._model.currentGroup.get();for(const g of(null===c||void 0===c?void 0:c.lines)||[]){if(!c)break;let u;if(g.type===Mi.Header){const e=document.createElement("div");e.className="diff-review-row",e.setAttribute("role","listitem");const i=c.range,t=this._model.currentGroupIndex.get(),n=this._model.groups.get().length,o=e=>0===e?(0,b.NC)("no_lines_changed","no lines changed"):1===e?(0,b.NC)("one_line_changed","1 line changed"):(0,b.NC)("more_lines_changed","{0} lines changed",e),s=o(i.original.length),r=o(i.modified.length);e.setAttribute("aria-label",(0,b.NC)({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",t+1,n,i.original.startLineNumber,s,i.modified.startLineNumber,r));const d=document.createElement("div");d.className="diff-review-cell diff-review-summary",d.appendChild(document.createTextNode(`${t+1}/${n}: @@ -${i.original.startLineNumber},${i.original.length} +${i.modified.startLineNumber},${i.modified.length} @@`)),e.appendChild(d),u=e}else u=this._createRow(g,h,this._width.get(),i,s,a,t,d,l);o.appendChild(u);const m=(0,r.nK)("isSelected",(e=>this._model.currentElement.read(e)===g));e.add((0,r.EH)("update tab index",(e=>{const i=m.read(e);u.tabIndex=i?0:-1,i&&u.focus()}))),e.add((0,n.nm)(u,"focus",(()=>{this._model.goToLine(g)})))}this._scrollbar.scanDomNode()}_createRow(e,i,t,n,o,s,r,d,a){const l=n.get(142),h=l.glyphMarginWidth+l.lineNumbersWidth,c=r.get(142),g=10+c.glyphMarginWidth+c.lineNumbersWidth;let u="diff-review-row",m="";const f="diff-review-spacer";let _=null;switch(e.type){case Mi.Added:u="diff-review-row line-insert",m=" char-insert",_=Di;break;case Mi.Deleted:u="diff-review-row line-delete",m=" char-delete",_=Li;break}const v=document.createElement("div");v.style.minWidth=t+"px",v.className=u,v.setAttribute("role","listitem"),v.ariaLevel="";const w=document.createElement("div");w.className="diff-review-cell",w.style.height=`${i}px`,v.appendChild(w);const C=document.createElement("span");C.style.width=h+"px",C.style.minWidth=h+"px",C.className="diff-review-line-number"+m,void 0!==e.originalLineNumber?C.appendChild(document.createTextNode(String(e.originalLineNumber))):C.innerText="",w.appendChild(C);const D=document.createElement("span");D.style.width=g+"px",D.style.minWidth=g+"px",D.style.paddingRight="10px",D.className="diff-review-line-number"+m,void 0!==e.modifiedLineNumber?D.appendChild(document.createTextNode(String(e.modifiedLineNumber))):D.innerText="",w.appendChild(D);const L=document.createElement("span");if(L.className=f,_){const e=document.createElement("span");e.className=p.k.asClassName(_),e.innerText="",L.appendChild(e)}else L.innerText="";let E;if(w.appendChild(L),void 0!==e.modifiedLineNumber){let i=this._getLineHtml(d,r,a.tabSize,e.modifiedLineNumber,this._languageService.languageIdCodec);fi.j._ttPolicy&&(i=fi.j._ttPolicy.createHTML(i)),w.insertAdjacentHTML("beforeend",i),E=d.getLineContent(e.modifiedLineNumber)}else{let i=this._getLineHtml(o,n,s.tabSize,e.originalLineNumber,this._languageService.languageIdCodec);fi.j._ttPolicy&&(i=fi.j._ttPolicy.createHTML(i)),w.insertAdjacentHTML("beforeend",i),E=o.getLineContent(e.originalLineNumber)}0===E.length&&(E=(0,b.NC)("blankLine","blank"));let S="";switch(e.type){case Mi.Unchanged:S=e.originalLineNumber===e.modifiedLineNumber?(0,b.NC)({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",E,e.originalLineNumber):(0,b.NC)("equalLine","{0} original line {1} modified line {2}",E,e.originalLineNumber,e.modifiedLineNumber);break;case Mi.Added:S=(0,b.NC)("insertLine","+ {0} modified line {1}",E,e.modifiedLineNumber);break;case Mi.Deleted:S=(0,b.NC)("deleteLine","- {0} original line {1}",E,e.originalLineNumber);break}return v.setAttribute("aria-label",S),v}_getLineHtml(e,i,t,n,o){const s=e.getLineContent(n),r=i.get(49),d=pi.A.createEmpty(s,o),a=Me.wA.isBasicASCII(s,e.mightContainNonBasicASCII()),l=Me.wA.containsRTL(s,a,e.mightContainRTL()),h=(0,Re.tF)(new Re.IJ(r.isMonospace&&!i.get(32),r.canUseHalfwidthRightwardsArrow,s,!1,a,l,0,d,[],t,0,r.spaceWidth,r.middotWidth,r.wsmiddotWidth,i.get(115),i.get(97),i.get(92),i.get(50)!==Se.n0.OFF,null));return h.html}};function Wi(e,i){let t;for(const n of e)i(t,n),t=n;i(t,void 0)}function*Ai(e,i){let t,n;for(const o of e)void 0!==n&&i(n,o)?t.push(o):(t&&(yield t),t=[o]),n=o;t&&(yield t)}Pi=bi([wi(5,_i.O)],Pi);(0,Ke.P6G)("diffEditor.move.border",{dark:"#8b8b8b9c",light:"#8b8b8b9c",hcDark:"#8b8b8b9c",hcLight:"#8b8b8b9c"},(0,b.NC)("diffEditor.move.border","The border color for text that got moved in the diff editor."));var Fi=function(e,i,t,n){var o,s=arguments.length,r=s<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(i,t,r):o(i,t))||r);return s>3&&r&&Object.defineProperty(i,t,r),r},Hi=function(e,i){return function(t,n){i(t,n,e)}};let ki=class extends si{constructor(e,i,t,o,h,c,g){var u;super(),this._domElement=e,this._parentContextKeyService=o,this._parentInstantiationService=h,this._audioCueService=g,this.elements=(0,n.h)("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[(0,n.h)("div.noModificationsOverlay@overlay",{style:{position:"absolute",height:"100%",visibility:"hidden"}},[(0,n.$)("span",{},"No Changes")]),(0,n.h)("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),(0,n.h)("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),(0,n.h)("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]),this._diffModel=this._register((0,a.DN)("diffModel",void 0)),this.onDidChangeModel=s.ju.fromObservableLight(this._diffModel),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement)),this._instantiationService=this._parentInstantiationService.createChild(new oi.y([ti.i6,this._contextKeyService])),this._boundarySashes=(0,r.uh)("boundarySashes",void 0),this._accessibleDiffViewerShouldBeVisible=(0,r.uh)("accessibleDiffViewerShouldBeVisible",!1),this._accessibleDiffViewerVisible=(0,r.nK)("accessibleDiffViewerVisible",(e=>!!this._options.onlyShowAccessibleDiffViewer.read(e)||this._accessibleDiffViewerShouldBeVisible.read(e))),this._layoutInfo=(0,r.nK)("modifiedEditorLayoutInfo",(e=>{var i;const t=this._rootSizeObserver.width.read(e),n=this._rootSizeObserver.height.read(e),o=null===(i=this._sash.read(e))||void 0===i?void 0:i.sashLeft.read(e),s=null!==o&&void 0!==o?o:Math.max(5,this._editors.original.getLayoutInfo().decorationsLeft),r=t-s-(this._options.renderOverviewRuler.read(e)?$e.ENTIRE_DIFF_OVERVIEW_WIDTH:0);return this.elements.original.style.width=s+"px",this.elements.original.style.left="0px",this.elements.modified.style.width=r+"px",this.elements.modified.style.left=s+"px",this._editors.original.layout({width:s,height:n}),this._editors.modified.layout({width:r,height:n}),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}})),this._diffValue=this._diffModel.map(((e,i)=>null===e||void 0===e?void 0:e.diff.read(i))),this.onDidUpdateDiff=s.ju.fromObservableLight(this._diffValue),c.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._contextKeyService.createKey("diffEditorVersion",2),this._options=new hi(i),this._contextKeyService.createKey(ii.u.isEmbeddedDiffEditor.key,!1);const m=ii.u.isEmbeddedDiffEditor.bindTo(this._contextKeyService);this._register((0,r.EH)("update isEmbeddedDiffEditorKey",(e=>{m.set(this._options.isInEmbeddedEditor.read(e))})));const f=ii.u.accessibleDiffViewerVisible.bindTo(this._contextKeyService);this._register((0,r.EH)("update accessibleDiffViewerVisible context key",(e=>{f.set(this._accessibleDiffViewerVisible.read(e))}))),this._domElement.appendChild(this.elements.root),this._rootSizeObserver=this._register(new H(this.elements.root,i.dimension)),this._rootSizeObserver.setAutomaticLayout(null!==(u=i.automaticLayout)&&void 0!==u&&u),this._editors=this._register(this._instantiationService.createInstance(li,this.elements.original,this.elements.modified,this._options,t,((e,i,t,n)=>this._createInnerEditor(e,i,t,n)))),this._sash=(0,l.Be)("sash",((e,i)=>{const t=this._options.renderSideBySide.read(e);if(this.elements.root.classList.toggle("side-by-side",t),!t)return;const n=i.add(new ee(this._options,this.elements.root,{height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map(((e,i)=>e-(this._options.renderOverviewRuler.read(i)?$e.ENTIRE_DIFF_OVERVIEW_WIDTH:0)))}));return i.add((0,r.EH)("setBoundarySashes",(e=>{const i=this._boundarySashes.read(e);i&&n.setBoundarySashes(i)}))),n})),this._register((0,r.$g)(this._sash,!0)),this._register((0,d.b2)("UnchangedRangesFeature",((e,i)=>{this.unchangedRangesFeature=i.add(new(j(Je,e))(this._editors,this._diffModel,this._options))}))),this._register((0,d.b2)("DiffEditorDecorations",((e,i)=>{i.add(new(j(X,e))(this._editors,this._diffModel,this._options))}))),this._register((0,d.b2)("ViewZoneManager",((e,i)=>{i.add(this._instantiationService.createInstance(j(He,e),this._editors,this._diffModel,this._options,this,(()=>this.unchangedRangesFeature.isUpdatingViewZones)))}))),this._register((0,d.b2)("OverviewRulerPart",((e,i)=>{i.add(this._instantiationService.createInstance(j($e,e),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map((e=>e.modifiedEditor)),this._options))}))),this._register((0,d.b2)("_accessibleDiffViewer",((e,i)=>{this._accessibleDiffViewer=i.add(this._register(this._instantiationService.createInstance(j(Si,e),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,((e,i)=>this._accessibleDiffViewerShouldBeVisible.set(e,i)),this._options.onlyShowAccessibleDiffViewer.map((e=>!e)),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map(((e,i)=>{var t;return null===(t=null===e||void 0===e?void 0:e.diff.read(i))||void 0===t?void 0:t.mappings.map((e=>e.lineRangeMapping))})),this._editors)))})));const _=this._accessibleDiffViewerVisible.map((e=>e?"hidden":"visible"));this._register(K(this.elements.modified,{visibility:_})),this._register(K(this.elements.original,{visibility:_})),this._createDiffEditorContributions(),c.addDiffEditor(this),this._register((0,r.$g)(this._layoutInfo,!0)),this._register(new V(this.elements.root,this._diffModel,this._layoutInfo.map((e=>e.originalEditor)),this._layoutInfo.map((e=>e.modifiedEditor)),this._editors)),this._register(K(this.elements.overlay,{width:this._layoutInfo.map(((e,i)=>e.originalEditor.width+(this._options.renderSideBySide.read(i)?0:e.modifiedEditor.width))),visibility:(0,r.nK)("visibility",(e=>{var i,t;return this._options.collapseUnchangedRegions.read(e)&&0===(null===(t=null===(i=this._diffModel.read(e))||void 0===i?void 0:i.diff.read(e))||void 0===t?void 0:t.mappings.length)?"visible":"hidden"}))})),this._register(this._editors.original.onDidChangeCursorPosition((e=>{const i=this._diffModel.get();if(!i)return;const t=i.diff.get().movedTexts.find((i=>i.lineRangeMapping.original.contains(e.position.lineNumber)));i.syncedMovedTexts.set(t,void 0)}))),this._register(this._editors.modified.onDidChangeCursorPosition((e=>{const i=this._diffModel.get();if(!i)return;const t=i.diff.get().movedTexts.find((i=>i.lineRangeMapping.modified.contains(e.position.lineNumber)));i.syncedMovedTexts.set(t,void 0)}))),this._register(this._editors.modified.onMouseDown((e=>{var i,t;if(!e.event.rightButton&&e.target.position&&(null===(i=e.target.element)||void 0===i?void 0:i.className.includes("arrow-revert-change"))){const i=e.target.position.lineNumber,n=e.target,o=this._diffModel.get();if(!o)return;const s=null===(t=o.diff.get())||void 0===t?void 0:t.mappings;if(!s)return;const r=s.find((e=>(null===n||void 0===n?void 0:n.detail.afterLineNumber)===e.lineRangeMapping.modifiedRange.startLineNumber-1||e.lineRangeMapping.modifiedRange.startLineNumber===i));if(!r)return;this.revert(r.lineRangeMapping),e.event.stopPropagation()}}))),this._register(s.ju.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,(e=>{var i,t;if(3===(null===e||void 0===e?void 0:e.reason)){const n=null===(t=null===(i=this._diffModel.get())||void 0===i?void 0:i.diff.get())||void 0===t?void 0:t.mappings.find((i=>i.lineRangeMapping.modifiedRange.contains(e.position.lineNumber)));(null===n||void 0===n?void 0:n.lineRangeMapping.modifiedRange.isEmpty)?this._audioCueService.playAudioCue(vi.y$.diffLineDeleted):(null===n||void 0===n?void 0:n.lineRangeMapping.originalRange.isEmpty)?this._audioCueService.playAudioCue(vi.y$.diffLineInserted):n&&this._audioCueService.playAudioCue(vi.y$.diffLineModified)}})))}_createInnerEditor(e,i,t,n){const o=e.createInstance(g.Gm,i,t,n);return o}_createDiffEditorContributions(){const e=h.Uc.getDiffEditorContributions();for(const t of e)try{this._register(this._instantiationService.createInstance(t.ctor,this))}catch(i){(0,o.dL)(i)}}get _targetEditor(){return this._editors.modified}getEditorType(){return ei.g.IDiffEditor}layout(e){this._rootSizeObserver.observe(e)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){var e;const i=this._editors.original.saveViewState(),t=this._editors.modified.saveViewState();return{original:i,modified:t,modelState:null===(e=this._diffModel.get())||void 0===e?void 0:e.serializeState()}}restoreViewState(e){var i;if(e&&e.original&&e.modified){const t=e;this._editors.original.restoreViewState(t.original),this._editors.modified.restoreViewState(t.modified),t.modelState&&(null===(i=this._diffModel.get())||void 0===i||i.restoreSerializedState(t.modelState))}}createViewModel(e){return new ce(e,this._options,this._instantiationService.createInstance(Ye.Q,{diffAlgorithm:this._options.diffAlgorithm.get()}))}getModel(){var e,i;return null!==(i=null===(e=this._diffModel.get())||void 0===e?void 0:e.model)&&void 0!==i?i:null}setModel(e){!e&&this._diffModel.get()&&this._accessibleDiffViewer.close();const i=e?"model"in e?e:this.createViewModel(e):void 0;this._editors.original.setModel(i?i.model.original:null),this._editors.modified.setModel(i?i.model.modified:null),(0,a.PS)((e=>{this._diffModel.set(i,e)}))}updateOptions(e){this._options.updateOptions(e)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}getLineChanges(){var e;const i=null===(e=this._diffModel.get())||void 0===e?void 0:e.diff.get();return i?zi(i):null}revert(e){var i;const t=null===(i=this._diffModel.get())||void 0===i?void 0:i.model;if(!t)return;const n=e.innerChanges?e.innerChanges.map((e=>({range:e.modifiedRange,text:t.original.getValueInRange(e.originalRange)}))):[{range:e.modifiedRange.toExclusiveRange(),text:t.original.getValueInRange(e.originalRange.toExclusiveRange())}];this._editors.modified.executeEdits("diffEditor",n)}accessibleDiffViewerNext(){this._accessibleDiffViewer.next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.prev()}};function zi(e){return e.mappings.map((e=>{const i=e.lineRangeMapping;let t,n,o,s,r=i.innerChanges;return i.originalRange.isEmpty?(t=i.originalRange.startLineNumber-1,n=0,r=void 0):(t=i.originalRange.startLineNumber,n=i.originalRange.endLineNumberExclusive-1),i.modifiedRange.isEmpty?(o=i.modifiedRange.startLineNumber-1,s=0,r=void 0):(o=i.modifiedRange.startLineNumber,s=i.modifiedRange.endLineNumberExclusive-1),{originalStartLineNumber:t,originalEndLineNumber:n,modifiedStartLineNumber:o,modifiedEndLineNumber:s,charChanges:null===r||void 0===r?void 0:r.map((e=>({originalStartLineNumber:e.originalRange.startLineNumber,originalStartColumn:e.originalRange.startColumn,originalEndLineNumber:e.originalRange.endLineNumber,originalEndColumn:e.originalRange.endColumn,modifiedStartLineNumber:e.modifiedRange.startLineNumber,modifiedStartColumn:e.modifiedRange.startColumn,modifiedEndLineNumber:e.modifiedRange.endLineNumber,modifiedEndColumn:e.modifiedRange.endColumn})))}}))}ki=Fi([Hi(3,ti.i6),Hi(4,ni.TG),Hi(5,c.$),Hi(6,vi.e7)],ki)},28183:(e,i,t)=>{t.d(i,{F:()=>m});var n=t(19427),o=t(21813),s=t(52644),r=t(39554),d=t(81524),a=t(36374),l=t(22035),h=t(9547),c=function(e,i,t,n){var o,s=arguments.length,r=s<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(i,t,r):o(i,t))||r);return s>3&&r&&Object.defineProperty(i,t,r),r},g=function(e,i){return function(t,n){i(t,n,e)}};const u={followsCaret:!0,ignoreCharChanges:!0,alwaysRevealFirst:!0,findResultLoop:!0};let m=class extends s.JT{constructor(e,i={},t,n,s){super(),this._audioCueService=t,this._codeEditorService=n,this._accessibilityService=s,this._onDidUpdate=this._register(new o.Q5),this._editor=e,this._options=r.jB(i,u,!1),this.disposed=!1,this.nextIdx=-1,this.ranges=[],this.ignoreSelectionChange=!1,this.revealFirst=Boolean(this._options.alwaysRevealFirst),this._register(this._editor.onDidUpdateDiff((()=>this._onDiffUpdated()))),this._options.followsCaret&&this._register(this._editor.getModifiedEditor().onDidChangeCursorPosition((e=>{this.ignoreSelectionChange||(this._updateAccessibilityState(e.position.lineNumber),this.nextIdx=-1)}))),this._init()}_init(){this._editor.getLineChanges()}_onDiffUpdated(){this._init(),this._compute(this._editor.getLineChanges()),this.revealFirst&&null!==this._editor.getLineChanges()&&(this.revealFirst=!1,this.nextIdx=-1,this.next(1))}_compute(e){this.ranges=[],e&&e.forEach((e=>{!this._options.ignoreCharChanges&&e.charChanges?e.charChanges.forEach((e=>{this.ranges.push({rhs:!0,range:new d.e(e.modifiedStartLineNumber,e.modifiedStartColumn,e.modifiedEndLineNumber,e.modifiedEndColumn)})})):0===e.modifiedEndLineNumber?this.ranges.push({rhs:!0,range:new d.e(e.modifiedStartLineNumber,1,e.modifiedStartLineNumber+1,1)}):this.ranges.push({rhs:!0,range:new d.e(e.modifiedStartLineNumber,1,e.modifiedEndLineNumber+1,1)})})),this.ranges.sort(((e,i)=>d.e.compareRangesUsingStarts(e.range,i.range))),this._onDidUpdate.fire(this)}_initIdx(e){let i=!1;const t=this._editor.getPosition();if(t){for(let n=0,o=this.ranges.length;n<o&&!i;n++){const o=this.ranges[n].range;t.isBeforeOrEqual(o.getStartPosition())&&(this.nextIdx=n+(e?0:-1),i=!0)}i||(this.nextIdx=e?0:this.ranges.length-1),this.nextIdx<0&&(this.nextIdx=this.ranges.length-1)}else this.nextIdx=0}_move(e,i){if(n.ok(!this.disposed,"Illegal State - diff navigator has been disposed"),!this.canNavigate())return;-1===this.nextIdx?this._initIdx(e):e?(this.nextIdx+=1,this.nextIdx>=this.ranges.length&&(this.nextIdx=0)):(this.nextIdx-=1,this.nextIdx<0&&(this.nextIdx=this.ranges.length-1));const t=this.ranges[this.nextIdx];this.ignoreSelectionChange=!0;try{const e=t.range.getStartPosition();this._editor.setPosition(e),this._editor.revealRangeInCenter(t.range,i),this._updateAccessibilityState(e.lineNumber,!0)}finally{this.ignoreSelectionChange=!1}}_updateAccessibilityState(e,i){var t;const n=null===(t=this._editor.getModel())||void 0===t?void 0:t.modified;if(!n)return;const o=n.getLineDecorations(e).find((e=>"line-insert"===e.options.className));if(o)this._audioCueService.playAudioCue(a.y$.diffLineModified,!0);else{if(!i)return;this._audioCueService.playAudioCue(a.y$.diffLineDeleted,!0)}const s=this._codeEditorService.getActiveCodeEditor();i&&s&&o&&this._accessibilityService.isScreenReaderOptimized()&&(s.setSelection({startLineNumber:e,startColumn:0,endLineNumber:e,endColumn:Number.MAX_VALUE}),s.writeScreenReaderContent("diff-navigation"))}canNavigate(){return this.ranges&&this.ranges.length>0}next(e=0){this.canNavigateNext()&&this._move(!0,e)}previous(e=0){this.canNavigatePrevious()&&this._move(!1,e)}canNavigateNext(){return this.canNavigateLoop()||this.nextIdx<this.ranges.length-1}canNavigatePrevious(){return this.canNavigateLoop()||0!==this.nextIdx}canNavigateLoop(){return Boolean(this._options.findResultLoop)}dispose(){super.dispose(),this.ranges=[],this.disposed=!0}};m=c([g(2,a.e7),g(3,l.$),g(4,h.F)],m)},79827:(e,i,t)=>{t.d(i,{j:()=>x});var n=t(76526),o=t(25503),s=t(36323),r=t(81223),d=t(33300),a=t(31434),l=t(11164),h=t(52644),c=t(35285),g=t(36330),u=t(29065),m=t(8655),f=t(22441),_=t(4796),p=t(65298),v=t(37563),b=t(76601),w=t(36374),C=t(99007),D=t(8443),L=function(e,i,t,n){var o,s=arguments.length,r=s<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(i,t,r):o(i,t))||r);return s>3&&r&&Object.defineProperty(i,t,r),r},E=function(e,i){return function(t,n){i(t,n,e)}},S=function(e,i,t,n){function o(e){return e instanceof t?e:new t((function(i){i(e)}))}return new(t||(t=Promise))((function(t,s){function r(e){try{a(n.next(e))}catch(i){s(i)}}function d(e){try{a(n["throw"](e))}catch(i){s(i)}}function a(e){e.done?t(e.value):o(e.value).then(r,d)}a((n=n.apply(e,i||[])).next())}))};const N=3;class y{constructor(e,i,t,n){this.originalLineStart=e,this.originalLineEnd=i,this.modifiedLineStart=t,this.modifiedLineEnd=n}getType(){return 0===this.originalLineStart?1:0===this.modifiedLineStart?2:0}}class R{constructor(e){this.entries=e}}const M=(0,D.q5)("diff-review-insert",l.l.add,b.NC("diffReviewInsertIcon","Icon for 'Insert' in diff review.")),I=(0,D.q5)("diff-review-remove",l.l.remove,b.NC("diffReviewRemoveIcon","Icon for 'Remove' in diff review.")),T=(0,D.q5)("diff-review-close",l.l.close,b.NC("diffReviewCloseIcon","Icon for 'Close' in diff review."));let x=class e extends h.JT{constructor(e,i,t,s){super(),this._languageService=i,this._audioCueService=t,this._configurationService=s,this._width=0,this._diffEditor=e,this._isVisible=!1,this.shadow=(0,o.X)(document.createElement("div")),this.shadow.setClassName("diff-review-shadow"),this.actionBarContainer=(0,o.X)(document.createElement("div")),this.actionBarContainer.setClassName("diff-review-actions"),this._actionBar=this._register(new r.o(this.actionBarContainer.domNode)),this._actionBar.push(new a.aU("diffreview.close",b.NC("label.close","Close"),"close-diff-review "+c.k.asClassName(T),!0,(()=>S(this,void 0,void 0,(function*(){return this.hide()})))),{label:!1,icon:!0}),this.domNode=(0,o.X)(document.createElement("div")),this.domNode.setClassName("diff-review monaco-editor-background"),this._content=(0,o.X)(document.createElement("div")),this._content.setClassName("diff-review-content"),this._content.setAttribute("role","code"),this.scrollbar=this._register(new d.s$(this._content.domNode,{})),this.domNode.domNode.appendChild(this.scrollbar.getDomNode()),this._register(e.onDidUpdateDiff((()=>{this._isVisible&&(this._diffs=this._compute(),this._render())}))),this._register(e.getModifiedEditor().onDidChangeCursorPosition((()=>{this._isVisible&&this._render()}))),this._register(n.mu(this.domNode.domNode,"click",(e=>{e.preventDefault();const i=n.Fx(e.target,"diff-review-row");i&&this._goToRow(i)}))),this._register(n.mu(this.domNode.domNode,"keydown",(e=>{(e.equals(18)||e.equals(2066)||e.equals(530))&&(e.preventDefault(),this._goToRow(this._getNextRow(),"next")),(e.equals(16)||e.equals(2064)||e.equals(528))&&(e.preventDefault(),this._goToRow(this._getPrevRow(),"previous")),(e.equals(9)||e.equals(2057)||e.equals(521)||e.equals(1033)||e.equals(10)||e.equals(3))&&(e.preventDefault(),this.accept())}))),this._register(this._configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("accessibility.verbosity.diffEditor")&&this._diffEditor.updateOptions({accessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.diffEditor")})}))),this._diffs=[],this._currentDiff=null}prev(){let e=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let i=-1;for(let e=0,t=this._diffs.length;e<t;e++)if(this._diffs[e]===this._currentDiff){i=e;break}e=this._diffs.length+i-1}else e=this._findDiffIndex(this._diffEditor.getPosition());if(0===this._diffs.length)return;e%=this._diffs.length;const i=this._diffs[e].entries;this._diffEditor.setPosition(new m.L(i[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:i[0].modifiedLineStart,endColumn:1073741824,endLineNumber:i[i.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getPrevRow(),"previous")}next(){let e=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){let i=-1;for(let e=0,t=this._diffs.length;e<t;e++)if(this._diffs[e]===this._currentDiff){i=e;break}e=i+1}else e=this._findDiffIndex(this._diffEditor.getPosition());if(0===this._diffs.length)return;e%=this._diffs.length;const i=this._diffs[e].entries;this._diffEditor.setPosition(new m.L(i[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:i[0].modifiedLineStart,endColumn:1073741824,endLineNumber:i[i.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getNextRow(),"next")}accept(){let e=-1;const i=this._getCurrentFocusedRow();if(i){const t=parseInt(i.getAttribute("data-line"),10);isNaN(t)||(e=t)}this.hide(),-1!==e&&(this._diffEditor.setPosition(new m.L(e,1)),this._diffEditor.revealPosition(new m.L(e,1),1))}hide(){this._isVisible=!1,this._diffEditor.updateOptions({readOnly:!1}),this._diffEditor.focus(),this._diffEditor.doLayout(),this._render()}_getPrevRow(){const e=this._getCurrentFocusedRow();return e?e.previousElementSibling?e.previousElementSibling:e:this._getFirstRow()}_getNextRow(){const e=this._getCurrentFocusedRow();return e?e.nextElementSibling?e.nextElementSibling:e:this._getFirstRow()}_getFirstRow(){return this.domNode.domNode.querySelector(".diff-review-row")}_getCurrentFocusedRow(){const e=document.activeElement;return e&&/diff-review-row/.test(e.className)?e:null}_goToRow(e,i){const t=this._getCurrentFocusedRow();e.tabIndex=0,e.focus(),t&&t!==e&&(t.tabIndex=-1);const n=i?"next"===i?null===t||void 0===t?void 0:t.nextElementSibling:null===t||void 0===t?void 0:t.previousElementSibling:t;(null===n||void 0===n?void 0:n.classList.contains("line-insert"))?this._audioCueService.playAudioCue(w.y$.diffLineInserted,!0):(null===n||void 0===n?void 0:n.classList.contains("line-delete"))&&this._audioCueService.playAudioCue(w.y$.diffLineDeleted,!0),this.scrollbar.scanDomNode()}isVisible(){return this._isVisible}layout(e,i,t){this._width=i,this.shadow.setTop(e-6),this.shadow.setWidth(i),this.shadow.setHeight(this._isVisible?6:0),this.domNode.setTop(e),this.domNode.setWidth(i),this.domNode.setHeight(t),this._content.setHeight(t),this._content.setWidth(i),this._isVisible?(this.actionBarContainer.setAttribute("aria-hidden","false"),this.actionBarContainer.setDisplay("block")):(this.actionBarContainer.setAttribute("aria-hidden","true"),this.actionBarContainer.setDisplay("none"))}_compute(){const i=this._diffEditor.getLineChanges();if(!i||0===i.length)return[];const t=this._diffEditor.getOriginalEditor().getModel(),n=this._diffEditor.getModifiedEditor().getModel();return t&&n?e._mergeAdjacent(i,t.getLineCount(),n.getLineCount()):[]}static _mergeAdjacent(e,i,t){if(!e||0===e.length)return[];const n=[];let o=0;for(let a=0,l=e.length;a<l;a++){const s=e[a],r=s.originalStartLineNumber,d=s.originalEndLineNumber,h=s.modifiedStartLineNumber,c=s.modifiedEndLineNumber,g=[];let u=0;{const i=0===d?r:r-1,t=0===c?h:h-1;let n=1,o=1;if(a>0){const i=e[a-1];n=0===i.originalEndLineNumber?i.originalStartLineNumber+1:i.originalEndLineNumber+1,o=0===i.modifiedEndLineNumber?i.modifiedStartLineNumber+1:i.modifiedEndLineNumber+1}let s=i-N+1,l=t-N+1;if(s<n){const e=n-s;s+=e,l+=e}if(l<o){const e=o-l;s+=e,l+=e}g[u++]=new y(s,i,l,t)}0!==d&&(g[u++]=new y(r,d,0,0)),0!==c&&(g[u++]=new y(0,0,h,c));{const n=0===d?r+1:d+1,o=0===c?h+1:c+1;let s=i,m=t;if(a+1<l){const i=e[a+1];s=0===i.originalEndLineNumber?i.originalStartLineNumber:i.originalStartLineNumber-1,m=0===i.modifiedEndLineNumber?i.modifiedStartLineNumber:i.modifiedStartLineNumber-1}let f=n+N-1,_=o+N-1;if(f>s){const e=s-f;f+=e,_+=e}if(_>m){const e=m-_;f+=e,_+=e}g[u++]=new y(n,f,o,_)}n[o++]=new R(g)}let s=n[0].entries;const r=[];let d=0;for(let a=1,l=n.length;a<l;a++){const e=n[a].entries,i=s[s.length-1],t=e[0];0===i.getType()&&0===t.getType()&&t.originalLineStart<=i.originalLineEnd?(s[s.length-1]=new y(i.originalLineStart,t.originalLineEnd,i.modifiedLineStart,t.modifiedLineEnd),s=s.concat(e.slice(1))):(r[d++]=new R(s),s=e)}return r[d++]=new R(s),r}_findDiffIndex(e){const i=e.lineNumber;for(let t=0,n=this._diffs.length;t<n;t++){const e=this._diffs[t].entries,n=e[e.length-1].modifiedLineEnd;if(i<=n)return t}return 0}_render(){const i=this._diffEditor.getOriginalEditor().getOptions(),t=this._diffEditor.getModifiedEditor().getOptions(),o=this._diffEditor.getOriginalEditor().getModel(),s=this._diffEditor.getModifiedEditor().getModel(),r=o.getOptions(),d=s.getOptions();if(!this._isVisible||!o||!s)return n.PO(this._content.domNode),this._currentDiff=null,void this.scrollbar.scanDomNode();this._diffEditor.updateOptions({readOnly:!0});const a=this._findDiffIndex(this._diffEditor.getPosition());if(this._diffs[a]===this._currentDiff)return;this._currentDiff=this._diffs[a];const l=this._diffs[a].entries,h=document.createElement("div");h.className="diff-review-table",h.setAttribute("role","list"),h.setAttribute("aria-label",'Difference review. Use "Stage | Unstage | Revert Selected Ranges" commands'),(0,g.N)(h,t.get(49));let c=0,u=0,m=0,f=0;for(let e=0,n=l.length;e<n;e++){const i=l[e],t=i.originalLineStart,n=i.originalLineEnd,o=i.modifiedLineStart,s=i.modifiedLineEnd;0!==t&&(0===c||t<c)&&(c=t),0!==n&&(0===u||n>u)&&(u=n),0!==o&&(0===m||o<m)&&(m=o),0!==s&&(0===f||s>f)&&(f=s)}const _=document.createElement("div");_.className="diff-review-row";const p=document.createElement("div");p.className="diff-review-cell diff-review-summary";const v=u-c+1,w=f-m+1;p.appendChild(document.createTextNode(`${a+1}/${this._diffs.length}: @@ -${c},${v} +${m},${w} @@`)),_.setAttribute("data-line",String(m));const C=e=>0===e?b.NC("no_lines_changed","no lines changed"):1===e?b.NC("one_line_changed","1 line changed"):b.NC("more_lines_changed","{0} lines changed",e),D=C(v),L=C(w);_.setAttribute("aria-label",b.NC({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",a+1,this._diffs.length,c,D,m,L)),_.appendChild(p),_.setAttribute("role","listitem"),h.appendChild(_);const E=t.get(65);let S=m;for(let n=0,g=l.length;n<g;n++){const a=l[n];e._renderSection(h,a,S,E,this._width,i,o,r,t,s,d,this._languageService.languageIdCodec),0!==a.modifiedLineStart&&(S=a.modifiedLineEnd)}n.PO(this._content.domNode),this._content.domNode.appendChild(h),this.scrollbar.scanDomNode()}static _renderSection(i,t,n,o,s,r,d,a,l,h,g,u){const m=t.getType();let f="diff-review-row",_="";const p="diff-review-spacer";let v=null;switch(m){case 1:f="diff-review-row line-insert",_=" char-insert",v=M;break;case 2:f="diff-review-row line-delete",_=" char-delete",v=I;break}const w=t.originalLineStart,C=t.originalLineEnd,D=t.modifiedLineStart,L=t.modifiedLineEnd,E=Math.max(L-D,C-w),S=r.get(142),N=S.glyphMarginWidth+S.lineNumbersWidth,y=l.get(142),R=10+y.glyphMarginWidth+y.lineNumbersWidth;for(let M=0;M<=E;M++){const t=0===w?0:w+M,C=0===D?0:D+M,L=document.createElement("div");L.style.minWidth=s+"px",L.className=f,L.setAttribute("role","listitem"),0!==C&&(n=C),L.setAttribute("data-line",String(n));const E=document.createElement("div");E.className="diff-review-cell",E.style.height=`${o}px`,L.appendChild(E);const S=document.createElement("span");S.style.width=N+"px",S.style.minWidth=N+"px",S.className="diff-review-line-number"+_,0!==t?S.appendChild(document.createTextNode(String(t))):S.innerText="",E.appendChild(S);const y=document.createElement("span");y.style.width=R+"px",y.style.minWidth=R+"px",y.style.paddingRight="10px",y.className="diff-review-line-number"+_,0!==C?y.appendChild(document.createTextNode(String(C))):y.innerText="",E.appendChild(y);const I=document.createElement("span");if(I.className=p,v){const e=document.createElement("span");e.className=c.k.asClassName(v),e.innerText="",I.appendChild(e)}else I.innerText="";let T;if(E.appendChild(I),0!==C){let i=this._renderLine(h,l,g.tabSize,C,u);e._ttPolicy&&(i=e._ttPolicy.createHTML(i)),E.insertAdjacentHTML("beforeend",i),T=h.getLineContent(C)}else{let i=this._renderLine(d,r,a.tabSize,t,u);e._ttPolicy&&(i=e._ttPolicy.createHTML(i)),E.insertAdjacentHTML("beforeend",i),T=d.getLineContent(t)}0===T.length&&(T=b.NC("blankLine","blank"));let x="";switch(m){case 0:x=t===C?b.NC({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",T,t):b.NC("equalLine","{0} original line {1} modified line {2}",T,t,C);break;case 1:x=b.NC("insertLine","+ {0} modified line {1}",T,C);break;case 2:x=b.NC("deleteLine","- {0} original line {1}",T,t);break}L.setAttribute("aria-label",x),i.appendChild(L)}}static _renderLine(e,i,t,n,o){const s=e.getLineContent(n),r=i.get(49),d=_.A.createEmpty(s,o),a=v.wA.isBasicASCII(s,e.mightContainNonBasicASCII()),l=v.wA.containsRTL(s,a,e.mightContainRTL()),h=(0,p.tF)(new p.IJ(r.isMonospace&&!i.get(32),r.canUseHalfwidthRightwardsArrow,s,!1,a,l,0,d,[],t,0,r.spaceWidth,r.middotWidth,r.wsmiddotWidth,i.get(115),i.get(97),i.get(92),i.get(50)!==u.n0.OFF,null));return h.html}};x._ttPolicy=(0,s.Z)("diffReview",{createHTML:e=>e}),x=L([E(1,f.O),E(2,w.e7),E(3,C.Ui)],x)},4524:(e,i,t)=>{t.d(i,{H:()=>_});var n=t(39554),o=t(22035),s=t(58548),r=t(37943),d=t(25065),a=t(61156),l=t(96592),h=t(74821),c=t(9547),g=t(28010),u=t(47892),m=function(e,i,t,n){var o,s=arguments.length,r=s<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(i,t,r):o(i,t))||r);return s>3&&r&&Object.defineProperty(i,t,r),r},f=function(e,i){return function(t,n){i(t,n,e)}};let _=class extends s.Gm{constructor(e,i,t,n,o,s,r,d,a,l,h,c,g){super(e,Object.assign(Object.assign({},n.getRawOptions()),{overflowWidgetsDomNode:n.getOverflowWidgetsDomNode()}),t,o,s,r,d,a,l,h,c,g),this._parentEditor=n,this._overwriteOptions=i,super.updateOptions(this._overwriteOptions),this._register(n.onDidChangeConfiguration((e=>this._onParentConfigurationChanged(e))))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){n.jB(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};_=m([f(4,a.TG),f(5,o.$),f(6,r.H),f(7,d.i6),f(8,h.XE),f(9,l.lT),f(10,c.F),f(11,g.c_),f(12,u.p)],_)},58707:(e,i,t)=>{t.d(i,{Q:()=>g});var n=t(21813),o=t(91715),s=t(42748),r=t(50619),d=t(97497),a=t(7495),l=function(e,i,t,n){var o,s=arguments.length,r=s<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(r=(s<3?o(r):s>3?o(i,t,r):o(i,t))||r);return s>3&&r&&Object.defineProperty(i,t,r),r},h=function(e,i){return function(t,n){i(t,n,e)}},c=function(e,i,t,n){function o(e){return e instanceof t?e:new t((function(i){i(e)}))}return new(t||(t=Promise))((function(t,s){function r(e){try{a(n.next(e))}catch(i){s(i)}}function d(e){try{a(n["throw"](e))}catch(i){s(i)}}function a(e){e.done?t(e.value):o(e.value).then(r,d)}a((n=n.apply(e,i||[])).next())}))};let g=class e{constructor(e,i,t){this.editorWorkerService=i,this.telemetryService=t,this.onDidChangeEventEmitter=new n.Q5,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(e)}dispose(){var e;null===(e=this.diffAlgorithmOnDidChangeSubscription)||void 0===e||e.dispose()}computeDiff(i,t,n){var d;return c(this,void 0,void 0,(function*(){if("string"!==typeof this.diffAlgorithm)return this.diffAlgorithm.computeDiff(i,t,n);if(1===i.getLineCount()&&1===i.getLineMaxColumn(1))return{changes:[new r.f0(new s.z(1,2),new s.z(1,t.getLineCount()+1),[new r.iy(i.getFullModelRange(),t.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};const a=JSON.stringify([i.uri.toString(),t.uri.toString()]),l=JSON.stringify([i.id,t.id,i.getAlternativeVersionId(),t.getAlternativeVersionId(),JSON.stringify(n)]),h=e.diffCache.get(a);if(h&&h.context===l)return h.result;const c=o.G.create(),g=yield this.editorWorkerService.computeDiff(i.uri,t.uri,n,this.diffAlgorithm),u=c.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:u,timedOut:null===(d=null===g||void 0===g?void 0:g.quitEarly)||void 0===d||d}),!g)throw new Error("no diff result available");return e.diffCache.size>10&&e.diffCache.delete(e.diffCache.keys().next().value),e.diffCache.set(a,{result:g,context:l}),g}))}setOptions(e){var i;let t=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&(null===(i=this.diffAlgorithmOnDidChangeSubscription)||void 0===i||i.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,"string"!==typeof e.diffAlgorithm&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange((()=>this.onDidChangeEventEmitter.fire()))),t=!0),t&&this.onDidChangeEventEmitter.fire()}};g.diffCache=new Map,g=l([h(1,d.p),h(2,a.b)],g)}}]);